["```py\nInstall.packages(\"MDPtoolbox\") \nlibrary(MDPtoolbox) \n\n```", "```py\nup<- matrix(c(1      ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n               0.7   ,     0.2   ,     0     ,     0     ,     0     ,     0.1   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n               0     ,     0     ,     0.8   ,     0.05  ,     0     ,     0   ,     0.15  ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n               0     ,     0     ,     0.7   ,     0.3   ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n               0.1   ,     0     ,     0     ,     0     ,     0.7   ,     0.1   ,     0     ,     0     ,     0.1   ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n               0     ,     0.05  ,     0     ,     0     ,     0.7   ,     0.15   ,     0.1   ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n               0     ,     0     ,     0.05  ,     0     ,     0     ,     0.7   ,     0.15  ,     0.05  ,     0     ,     0     ,     0.05  ,     0     ,   0     ,     0     ,     0     ,     0     , \n               0     ,     0     ,     0     ,     0     ,     0     ,     0   ,     0.7   ,     0.2   ,     0     ,     0     ,     0     ,     0.1   ,   0     ,     0     ,     0     ,     0     , \n               0     ,     0     ,     0     ,     0     ,     0.05  ,     0   ,     0     ,     0     ,     0.85  ,     0.05  ,     0     ,     0     ,   0.05  ,     0     ,     0     ,     0     , \n               0     ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0.7   ,     0.2   ,     0.05  ,     0     ,   0     ,     0.05  ,     0     ,     0     , \n               0     ,     0     ,     0     ,     0     ,     0     ,     0   ,     0.05  ,     0     ,     0     ,     0.7   ,     0.2   ,     0     ,   0     ,     0     ,     0.05  ,     0     , \n               0     ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0.05  ,     0     ,     0     ,     0     ,     0.9   ,   0     ,     0     ,     0     ,     0.05  , \n               0     ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0.1   ,     0     ,     0     ,     0     ,   0.9   ,     0     ,     0     ,     0     , \n               0     ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0.1   ,     0     ,     0     ,   0.7   ,     0.2   ,     0     ,     0     , \n               0     ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0.05  ,     0     ,   0     ,     0.8   ,     0.15  ,     0     , \n               0     ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0.8   ,     0.2   ), \nnrow=16, ncol=16, byrow=TRUE) \nleft<- matrix(c(1    ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0.05      ,     0.9   ,     0     ,     0     ,     0     ,   0.05  ,     0     ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0.9   ,     0.05  ,     0     ,     0   ,     0.05  ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0.05  ,     0.9   ,     0     ,     0   ,     0     ,     0.05  ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0.8 ,     0     ,     0     ,     0     ,     0.1   ,     0.05   ,     0     ,     0     ,     0.05  ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0.8   ,     0     ,     0     ,     0.05  ,     0.1   ,     0.05  ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0.8   ,     0     ,     0     ,     0.05   ,     0.1   ,     0.05  ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0.1   ,     0.8   ,     0     ,     0     ,     0     ,     0.1   ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0.8   ,     0   ,     0     ,     0     ,     0.1   ,     0.05  ,     0     ,     0     ,   0.05  ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0.8   ,     0     ,     0     ,     0.05  ,     0.1   ,     0.05  ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0.8   ,     0     ,     0     ,     0.1   ,     0.1   ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0.8   ,     0     ,     0     ,     0     ,     0.2   ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0.8   ,     0     ,     0     ,     0     ,   0.2   ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0.8   ,     0     ,     0     ,   0.05  ,     0.1   ,     0.05  ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0.8   ,     0     ,   0     ,     0.05  ,     0.1   ,     0.05  , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0.8   ,   0     ,     0     ,     0.05  ,     0.15), \nnrow=16, ncol=16, byrow=TRUE) \ndown<- matrix(c(0.1  ,     0.8   ,     0     ,     0     ,     0.1   ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0.05      ,     0.9   ,     0     ,     0     ,     0     ,   0.05  ,     0     ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0.1   ,     0.8   ,     0     ,     0   ,     0.1   ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0.1   ,     0.9   ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0.05      ,     0     ,     0     ,     0     ,     0.15  ,   0.8   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0.2   ,     0.8   ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0.2   ,     0.8   ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0.1   ,     0.9   ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0.05  ,     0   ,     0     ,     0     ,     0.1   ,     0.8   ,     0     ,     0     ,   0.05  ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0.2   ,     0.8   ,     0     ,   0     ,     0     ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0.05  ,     0.8   ,     0     ,   0     ,     0     ,     0.05  ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0.05  ,     0     ,     0     ,     0     ,     0.9   ,   0     ,     0     ,     0     ,     0.05  , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0.2   ,     0.8   ,     0     ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0.05  ,     0.15  ,     0.8   ,     0     , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0.2   ,     0.8   , \n                 0   ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     1), \nnrow=16, ncol=16, byrow=TRUE) \nright<- matrix(c(0.2 ,     0.1   ,     0     ,     0     ,     0.7   ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                  0.1      ,     0.1   ,     0     ,     0     ,     0     ,   0.8   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     , \n                  0  ,     0     ,     0.2   ,     0     ,     0     ,     0   ,     0.8   ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                  0  ,     0     ,     0.1   ,     0.9   ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                  0  ,     0     ,     0     ,     0     ,     0.2   ,     0.1   ,     0     ,     0     ,     0.7   ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                  0  ,     0     ,     0     ,     0     ,     0     ,     0.9   ,     0.1   ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     0     , \n                  0  ,     0     ,     0     ,     0     ,     0     ,     0.05   ,     0.1   ,     0     ,     0     ,     0     ,     0.85  ,     0     ,   0     ,     0     ,     0     ,     0     , \n                  0  ,     0     ,     0     ,     0     ,     0     ,     0   ,     0.1   ,     0.2   ,     0     ,     0     ,     0     ,     0.7   ,   0     ,     0     ,     0     ,     0     , \n                  0  ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0.2   ,     0     ,     0     ,     0     ,   0.8   ,     0     ,     0     ,     0     , \n                  0  ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0.1   ,     0     ,     0     ,   0     ,     0.9   ,     0     ,     0     , \n                  0  ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0.1   ,     0     ,   0     ,     0     ,     0.9   ,     0     , \n                  0  ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0.2   ,   0     ,     0     ,     0     ,     0.8   , \n                  0  ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   1     ,     0     ,     0     ,     0     , \n                  0  ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     1     ,     0     ,     0     , \n                  0  ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     1     ,     0     , \n                  0  ,     0     ,     0     ,     0     ,     0     ,     0   ,     0     ,     0     ,     0     ,     0     ,     0     ,     0     ,   0     ,     0     ,     0     ,     1), \nnrow=16, ncol=16, byrow=TRUE) \n\n```", "```py\nTPMs <- list(up=up, left=left, \ndown=down, right=right) \n\n```", "```py\nRewards<- matrix(c(-1, -1, -1, -1, \n              -1, -1, -1, -1, \n              -1, -1, -1, -1, \n              -1, -1, -1, -1, \n              -1, -1, -1, -1, \n              -1, -1, -1, -1,\n              -1, -1, -1, -1, \n              -1, -1, -1, -1, \n              -1, -1, -1, -1, \n              -1, -1, -1, -1, \n              -1, -1, -1, -1, \n              -1, -1, -1, -1, \n              -1, -1, -1, -1, \n              -1, -1, -1, -1, \n              100, 100, 100, 100, \n              -1, -1, -1, -1), \nnrow=16, ncol=4, byrow=TRUE) \n\n```", "```py\nmdp_check(TPMs, Rewards) \n\n```", "```py\nmdp_policy<- mdp_policy_iteration(P=TPMs, R=Rewards, discount=0.9) \n\n```", "```py\nmdp_policy$policy \nnames(TPMs)[mdp_policy$policy] \n\n```", "```py\nmdp_policy$V \nnames(mdp_policy$V) <- paste0(\"S\",1:16) \nbarplot(mdp_policy$V,col=\"blue\",xlab=\"states\",ylab=\"Optimal value\",main=\"Value function of the optimal Policy\",width=0.5) \n\n```", "```py\nstates <- c(\"s1\", \"s2\", \"s3\", \"s4\", \"s5\", \"s6\", \"s7\", \"s8\", \"s9\", \"s10\", \"s11\", \"s12\", \"s13\", \"s14\", \"s15\", \"s16\") \n\n```", "```py\nactions<- c(\"up\", \"left\", \"down\", \"right\") \n\n```", "```py\ntransitionStateAction<- function(state, action) { \n  # The default state is the existing state in case of constrained action \nnext_state<- state \nif (state == \"s1\"&& action == \"down\") next_state<- \"s2\" \nif (state == \"s1\"&& action == \"right\") next_state<- \"s5\" \nif (state == \"s2\"&& action == \"up\") next_state<- \"s1\" \nif (state == \"s2\"&& action == \"right\") next_state<- \"s6\" \nif (state == \"s3\"&& action == \"right\") next_state<- \"s7\" \nif (state == \"s3\"&& action == \"down\") next_state<- \"s4\" \nif (state == \"s4\"&& action == \"up\") next_state<- \"s3\" \nif (state == \"s5\"&& action == \"right\") next_state<- \"s9\" \nif (state == \"s5\"&& action == \"down\") next_state<- \"s6\" \nif (state == \"s5\"&& action == \"left\") next_state<- \"s1\" \nif (state == \"s6\"&& action == \"up\") next_state<- \"s5\" \nif (state == \"s6\"&& action == \"down\") next_state<- \"s7\" \nif (state == \"s6\"&& action == \"left\") next_state<- \"s2\" \nif (state == \"s7\"&& action == \"up\") next_state<- \"s6\" \nif (state == \"s7\"&& action == \"right\") next_state<- \"s11\" \nif (state == \"s7\"&& action == \"down\") next_state<- \"s8\" \nif (state == \"s7\"&& action == \"left\") next_state<- \"s3\" \nif (state == \"s8\"&& action == \"up\") next_state<- \"s7\" \nif (state == \"s8\"&& action == \"right\") next_state<- \"s12\" \nif (state == \"s9\"&& action == \"right\") next_state<- \"s13\" \nif (state == \"s9\"&& action == \"down\") next_state<- \"s10\" \nif (state == \"s9\"&& action == \"left\") next_state<- \"s5\" \nif (state == \"s10\"&& action == \"up\") next_state<- \"s9\" \nif (state == \"s10\"&& action == \"right\") next_state<- \"s14\" \nif (state == \"s10\"&& action == \"down\") next_state<- \"s11\" \nif (state == \"s11\"&& action == \"up\") next_state<- \"s10\" \nif (state == \"s11\"&& action == \"right\") next_state<- \"s15\" \nif (state == \"s11\"&& action == \"left\") next_state<- \"s7\" \nif (state == \"s12\"&& action == \"right\") next_state<- \"s16\" \nif (state == \"s12\"&& action == \"left\") next_state<- \"s8\" \nif (state == \"s13\"&& action == \"down\") next_state<- \"s14\" \nif (state == \"s13\"&& action == \"left\") next_state<- \"s9\" \nif (state == \"s14\"&& action == \"up\") next_state<- \"s13\" \nif (state == \"s14\"&& action == \"down\") next_state<- \"s15\" \nif (state == \"s14\"&& action == \"left\") next_state<- \"s10\" \nif (state == \"s15\"&& action == \"up\") next_state<- \"s14\" \nif (state == \"s15\"&& action == \"down\") next_state<- \"s16\" \nif (state == \"s15\"&& action == \"left\") next_state<- \"s11\" \nif (state == \"s16\"&& action == \"up\") next_state<- \"s15\" \nif (state == \"s16\"&& action == \"left\") next_state<- \"s12\" \n  # Calculate reward \nif (next_state == \"s15\") { \nreward<- 100 \n  } else { \nreward<- -1 \n  } \n\nreturn(list(state=next_state, reward=reward)) \n} \n\n```", "```py\nQlearning<- function(n, initState, termState, \nepsilon, learning_rate) { \n  # Initialize a Q-matrix of size #states x #actions with zeroes \nQ_mat<- matrix(0, nrow=length(states), ncol=length(actions), \ndimnames=list(states, actions)) \n  # Run n iterations of Q-learning \nfor (i in 1:n) { \nQ_mat<- updateIteration(initState, termState, epsilon, learning_rate, Q_mat) \n  } \nreturn(Q_mat) \n} \n   updateIteration<- function(initState, termState, epsilon, learning_rate, Q_mat) { \nstate<- initState # set cursor to initial state \nwhile (state != termState) { \n    # Select the next action greedily or randomnly \nif (runif(1) >= epsilon) { \naction<- sample(actions, 1) # Select randomnly \n    } else { \naction<- which.max(Q_mat[state, ]) # Select best action \n    } \n    # Extract the next state and its reward \nresponse<- transitionStateAction(state, action) \n    # Update the corresponding value in Q-matrix (learning) \nQ_mat[state, action] <- Q_mat[state, action] + learning_rate * \n      (response$reward + max(Q_mat[response$state, ]) - Q_mat[state, action]) \nstate<- response$state # update with next state \n  } \nreturn(Q_mat) \n} \n\n```", "```py\nepsilon<- 0.1 \nlearning_rate<- 0.9 \n\n```", "```py\nQ_mat<- Qlearning(500, \"s1\", \"s15\", epsilon, learning_rate) \nQ_mat \n\n```", "```py\nactions[max.col(Q_mat)] \n\n```"]