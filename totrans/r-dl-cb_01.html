<html><head></head><body>
        <section id="K0RQ1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Getting Started</h1>
                
            
            <article>
                
<p class="calibre2"><span>In this chapter, we will cover the following topics:</span></p>
<ul class="calibre12">
<li class="calibre13">Installing R with an IDE</li>
<li class="calibre13">Installing a Jupyter Notebook application</li>
<li class="calibre13">Starting with the basics of machine learning in R</li>
<li class="calibre13">Setting up deep learning tools/packages in R</li>
<li class="calibre13">Installing MXNet in R</li>
<li class="calibre13">Installing TensorFlow in R</li>
<li class="calibre13">Installing H2O in R</li>
<li class="calibre13">Installing all three packages at once using Docker</li>
</ul>


            </article>

            
        </section>
    

        <section id="KVCC1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Introduction</h1>
                
            
            <article>
                
<p class="calibre2">This chapter will get you started with deep learning and help you set up your systems to develop deep learning models. The chapter is more focused on giving the audience a heads-up on what is expected from the book and the prerequisites required to go through the book. The current book is intended for students or professionals who want to quickly build a background in the applications of deep learning. The book will be more practical and application-focused using R as a tool to build deep learning models.</p>
<div class="packt_infobox">For a detailed theory on deep learning, refer to <em class="calibre21">Deep Learning</em> by <em class="calibre21">Goodfellow et al. 2016.</em> For a machine learning background refer <span class="calibre22"><em class="calibre21">Python Machine Learning</em> by S. Raschka, 2015.</span></div>
<p class="calibre2">We will use the R programming language to demonstrate applications of deep learning. You are expected to have the following prerequisites throughout the book:</p>
<ul class="calibre12">
<li class="calibre13">Basic R programming knowledge</li>
<li class="calibre13">Basic understanding of Linux; we will use the Ubuntu (16.04) operating system</li>
<li class="calibre13">Basic understanding of machine learning concepts</li>
<li class="calibre13">For Windows or macOS, a basic understanding of Docker</li>
</ul>


            </article>

            
        </section>
    

        <section id="LTSU1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Installing R with an IDE</h1>
                
            
            <article>
                
<p class="calibre2">Before we begin, let's install an IDE for R. For R the most popular IDEs are Rstudio and Jupyter. Rstudio is dedicated to R whereas Jupyter provide multi-language support including R. Jupyter also provides an interactive environment and allow you to combine code, text, and graphics into a single notebook.</p>


            </article>

            
        </section>
    

        <section id="MSDG1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Getting ready</h1>
                
            
            <article>
                
<p class="calibre2">R supports multiple operating systems such as Windows, macOS X, and Linux. The installation files for R can be downloaded from any one of the mirror sites at <strong class="calibre1">Comprehensive R Archive Network</strong> (<strong class="calibre1">CRAN</strong>) at <a href="https://cran.r-project.org/" class="calibre4">https://cran.r-project.org/</a>. The CRAN is also a major repository for packages in R. The programming language R is available under both 32-bit and 64-bit architectures.</p>


            </article>

            
        </section>
    

        <section id="NQU21-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">How to do it...</h1>
                
            
            <article>
                
<ol class="calibre15">
<li value="1" class="calibre13">Of r-base-dev is also highly recommended as it has many inbuilt functions. It also enables the <kbd class="calibre10">install.packages()</kbd> command, which is used to compile and install new R packages directly from the CRAN using the <strong class="calibre1">R console</strong>. The default <strong class="calibre1">R console</strong> looks as follows:</li>
</ol>
<div class="cdpaligncenter"><img class="image-border" src="../images/00076.jpeg"/></div>
<div class="packt_figref">Default R console</div>
<ol start="2" class="calibre15">
<li value="2" class="calibre13">For programming purposes, an <strong class="calibre1">Integrated Development Environment</strong> (<strong class="calibre1">IDE</strong>) is recommended as it helps enhance productivity. One of the most popular open source IDEs for R is Rstudio. Rstudio also provides you with an Rstudio server, which facilitates a web-based environment to program in R. The interface for the Rstudio IDE is shown in the following screenshot:</li>
</ol>
<div class="cdpaligncenter"><img class="image-border1" src="../images/00077.jpeg"/></div>
<div class="packt_figref">Rstudio Integrated Development Environment for R</div>


            </article>

            
        </section>
    

        <section id="OPEK1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Installing a Jupyter Notebook application</h1>
                
            
            <article>
                
<p class="calibre2">Another famous editor these days is the Jupyter Notebook app. This app produces notebook documents that integrate documentation, code, and analysis together. It supports many computational kernels including R. It is a server, client-side, web-based application that can be accessed using a browser.</p>


            </article>

            
        </section>
    

        <section id="PNV61-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">How to do it...</h1>
                
            
            <article>
                
<p class="calibre2">Jupyter Notebook can be installed using the following steps:</p>
<ol class="calibre15">
<li value="1" class="calibre13">Jupyter Notebook can be installed using <kbd class="calibre10">pip</kbd>:</li>
</ol>
<pre class="calibre23">
pip3 install --upgrade pip<br class="title-page-tagline"/>pip3 install jupyter
</pre>
<ol start="2" class="calibre15">
<li value="2" class="calibre13">If you have installed Anaconda, then the default computational kernel installed is Python. To install an R computation kernel in Jupyter within the same environment, type the following command in a terminal:</li>
</ol>
<pre class="calibre23">
conda install -c r r-essentials
</pre>
<ol start="3" class="calibre15">
<li value="3" class="calibre13">To install the R computational kernel in a new environment named <kbd class="calibre10">new-env</kbd> within conda, type as follows:</li>
</ol>
<pre class="calibre23">
conda create -n new-env -c r r-essentials
</pre>
<ol start="4" class="calibre15">
<li value="4" class="calibre13">Another way to include the R computational kernel in Jupyter Notebook uses the <kbd class="calibre10">IRkernel</kbd> package. To install through this process, start the R IDE. The first step is to install dependencies required for the <kbd class="calibre10">IRkernal</kbd> installation:</li>
</ol>
<pre class="calibre23">
chooseCRANmirror(ind=55) # choose mirror for installation<br class="title-page-tagline"/>install.packages(c('repr', 'IRdisplay', 'crayon', 'pbdZMQ',<br class="title-page-tagline"/>'devtools'), dependencies=TRUE)
</pre>
<ol start="5" class="calibre15">
<li value="5" class="calibre13">Once all the dependencies are installed from CRAN, install the <kbd class="calibre10">IRkernal</kbd> package from GitHub:</li>
</ol>
<pre class="calibre23">
library(devtools)<br class="title-page-tagline"/>library(methods)<br class="title-page-tagline"/>options(repos=c(CRAN='https://cran.rstudio.com'))<br class="title-page-tagline"/>devtools::install_github('IRkernel/IRkernel')
</pre>
<ol start="6" class="calibre15">
<li value="6" class="calibre13">Once all the requirements are satisfied, the R computation kernel can be set up in Jupyter Notebook using the following script:</li>
</ol>
<pre class="calibre23">
library(IRkernel)<br class="title-page-tagline"/>IRkernel::installspec(name = 'ir32', displayname = 'R 3.2')
</pre>
<ol start="7" class="calibre15">
<li value="7" class="calibre13">Jupyter Notebook can be started by opening a shell/terminal. Run the following command to start the Jupyter Notebook interface in the browser, as shown in the screenshot following this code:</li>
</ol>
<pre class="calibre23">
jupyter notebook
</pre>
<div class="cdpaligncenter"><img class="image-border2" src="../images/00079.jpeg"/></div>
<div class="packt_figref">Jupyter Notebook with the R computation engine</div>


            </article>

            
        </section>
    

        <section id="QMFO1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">There's more...</h1>
                
            
            <article>
                
<p class="calibre2">R, as with most of the packages utilized in this book, is supported by most operating systems. However, you can make use of Docker or VirtualBox to set up a working environment similar to the one used in this book.</p>
<p class="calibre2">For Docker installation and setup information, refer to <a href="https://docs.docker.com/" class="calibre4">https://docs.docker.com/</a> and select the Docker image appropriate to your operating system. Similarly, VirtualBox binaries can be downloaded and installed at <a href="https://www.virtualbox.org/wiki/Downloads" class="calibre4">https://www.virtualbox.org/wiki/Downloads</a>.</p>


            </article>

            
        </section>
    

        <section id="RL0A1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Starting with the basics of machine learning in R</h1>
                
            
            <article>
                
<p class="calibre2">Deep learning is a subcategory of machine learning inspired by the structure and functioning of a human brain. In recent times, deep learning has gained a lot of traction primarily because of higher computational power, bigger datasets, and better algorithms with (artificial) intelligent learning abilities and more inquisitiveness for data-driven insights. Before we get into the details of deep learning, let's understand some basic concepts of machine learning that form the basis for most analytical solutions.</p>
<p class="calibre2">Machine learning is an arena of developing algorithms with the ability to mine natural patterns from the data such that better decisions are made using predictive insights. These insights are pertinent across a horizon of real-world applications, from medical diagnosis (using computational biology) to real-time stock trading (using computational finance), from weather forecasting to natural language processing, from predictive maintenance (in automation and manufacturing) to prescriptive recommendations (in e-commerce and e-retail), and so on.</p>
<p class="calibre2">The following figure elucidates two primary techniques of machine learning; namely, supervised learning and unsupervised learning:</p>
<div class="cdpaligncenter"><img class="image-border3" src="../images/00137.jpeg"/></div>
<div class="packt_figref">Classification of different techniques in machine learning</div>
<p class="calibre2"><strong class="calibre1">Supervised learning</strong>: Supervised learning is a form of evidence-based learning. The evidence is the known outcome for a given input and is in turn used to train the predictive model. Models are further classified into regression and classification, based on the outcome data type. In the former, the outcome is continuous, and in the latter the outcome is discrete. Stock trading and weather forecasting are some widely used applications of regression models, and span detection, speech recognition, and image classification are some widely used applications of classification models.</p>
<p class="calibre2">Some algorithms for regression are linear regression, <strong class="calibre1">Generalized Linear Models</strong> (<strong class="calibre1">GLM</strong>), <strong class="calibre1">Support Vector Regression</strong> (<strong class="calibre1">SVR</strong>), neural networks, decision trees, and so on; in classification, we have logistic regression, <strong class="calibre1">Support Vector Machines</strong> (<strong class="calibre1">SVM</strong>), <strong class="calibre1">Linear discriminant analysis</strong> (<strong class="calibre1">LDA</strong>), Naive Bayes, nearest neighbors, and so on.</p>
<p class="calibre2"><strong class="calibre1">Semi-supervised learning</strong>: Semi-supervised learning is a class of supervised learning using unsupervised techniques. This technique is very useful in scenarios where the cost of labeling an entire dataset is highly impractical against the cost of acquiring and analyzing unlabeled data.</p>
<p class="calibre2"><strong class="calibre1">Unsupervised learning</strong>: As the name suggests, learning from data with no outcome (or supervision) is called unsupervised learning. It is a form of inferential learning based on hidden patterns and intrinsic groups in the given data. Its applications include market pattern recognition, genetic clustering, and so on.</p>
<p class="calibre2">Some widely used clustering algorithms are <em class="calibre9">k</em>-means, hierarchical, <em class="calibre9">k</em>-medoids, Fuzzy C-means, hidden markov, neural networks, and many more.</p>


            </article>

            
        </section>
    

        <section id="SJGS1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">How to do it...</h1>
                
            
            <article>
                
<p class="calibre2">Let's take a look at linear regression in supervised learning:</p>
<ol class="calibre15">
<li value="1" class="calibre13">Let's begin with a simple example of linear regression where we need to determine the relationship between men's height (in cms) and weight (in kgs). The following sample data represents the height and weight of 10 random men:</li>
</ol>
<pre class="calibre23">
data &lt;- data.frame("height" = c(131, 154, 120, 166, 108, 115,<br class="title-page-tagline"/>158, 144, 131, 112), <br class="title-page-tagline"/>"weight" = c(54, 70, 47, 79, 36, 48, 65,<br class="title-page-tagline"/>63, 54, 40))
</pre>
<ol start="2" class="calibre15">
<li value="2" class="calibre13">Now, generate a linear regression model as follows:</li>
</ol>
<pre class="calibre23">
lm_model &lt;- lm(weight ~ height, data)
</pre>
<ol start="3" class="calibre15">
<li value="3" class="calibre13">The following plot shows the relationship between men's height and weight along with the fitted line:</li>
</ol>
<pre class="calibre23">
plot(data, col = "red", main = "Relationship between height and<br class="title-page-tagline"/>weight",cex = 1.7, pch = 1, xlab = "Height in cms", ylab = "Weight<br class="title-page-tagline"/>in kgs")<br class="title-page-tagline"/>abline(lm(weight ~ height, data))
</pre>
<div class="cdpaligncenter"><img class="image-border4" src="../images/00091.jpeg"/></div>
<div class="packt_figref">Linear relationship between weight and height</div>
<ol start="4" class="calibre15">
<li value="4" class="calibre13">In semi-supervised models, the learning is primarily initiated using labeled data (a smaller quantity in general) and then augmented using unlabeled data (a larger quantity in general).</li>
</ol>
<p class="calibre2">Let's perform K-means clustering (unsupervised learning) on a widely used dataset, iris.</p>
<ol class="calibre15">
<li value="1" class="calibre13">This dataset consists of three different species of iris (<strong class="calibre1">Setosa</strong>, <strong class="calibre1">Versicolor</strong>, and <strong class="calibre1">Virginica</strong>) along with their distinct features such as sepal length, sepal width, petal length, and petal width:</li>
</ol>
<pre class="calibre23">
data(iris)<br class="title-page-tagline"/>head(iris)<br class="title-page-tagline"/><strong class="calibre1">Sepal.Length Sepal.Width Petal.Length Petal.Width Species</strong><br class="title-page-tagline"/><strong class="calibre1">1 5.1 3.5 1.4 0.2 setosa</strong><br class="title-page-tagline"/><strong class="calibre1">2 4.9 3.0 1.4 0.2 setosa</strong><br class="title-page-tagline"/><strong class="calibre1">3 4.7 3.2 1.3 0.2 setosa</strong><br class="title-page-tagline"/><strong class="calibre1">4 4.6 3.1 1.5 0.2 setosa</strong><br class="title-page-tagline"/><strong class="calibre1">5 5.0 3.6 1.4 0.2 setosa</strong><br class="title-page-tagline"/><strong class="calibre1">6 5.4 3.9 1.7 0.4 setosa</strong>
</pre>
<ol start="2" class="calibre15">
<li value="2" class="calibre13">The following plots show the variation of features across irises. Petal features show a distinct variation as against sepal features:</li>
</ol>
<pre class="calibre23">
library(ggplot2)<br class="title-page-tagline"/>library(gridExtra)<br class="title-page-tagline"/>plot1 &lt;- ggplot(iris, aes(Sepal.Length, Sepal.Width, color =<br class="title-page-tagline"/>Species)) <br class="title-page-tagline"/>  geom_point(size = 2) <br class="title-page-tagline"/>  ggtitle("Variation by Sepal features")<br class="title-page-tagline"/>plot2 &lt;- ggplot(iris, aes(Petal.Length, Petal.Width, color =<br class="title-page-tagline"/>  Species)) <br class="title-page-tagline"/>   geom_point(size = 2) <br class="title-page-tagline"/>   ggtitle("Variation by Petal features")<br class="title-page-tagline"/>grid.arrange(plot1, plot2, ncol=2)
</pre>
<div class="packt_figref"><img class="image-border5" src="../images/00080.jpeg"/></div>
<div class="packt_figref">Variation of sepal and petal features by length and width</div>
<ol start="3" class="calibre15">
<li value="3" class="calibre13">As petal features show a good variation across irises, let's perform K-means clustering using the petal length and petal width:</li>
</ol>
<pre class="calibre23">
set.seed(1234567)<br class="title-page-tagline"/>iris.cluster &lt;- kmeans(iris[, c("Petal.Length","Petal.Width")],<br class="title-page-tagline"/> 3, nstart = 10)<br class="title-page-tagline"/>iris.cluster$cluster &lt;- as.factor(iris.cluster$cluster)
</pre>
<ol start="4" class="calibre15">
<li value="4" class="calibre13">The following code snippet shows a cross-tab between clusters and species (irises). We can see that cluster 1 is primarily attributed with setosa, cluster 2 with versicolor, and cluster 3 with virginica:</li>
</ol>
<pre class="calibre23">
&gt; table(cluster=iris.cluster$cluster,species= iris$Species)<br class="title-page-tagline"/><strong class="calibre1">species</strong><br class="title-page-tagline"/><strong class="calibre1">cluster setosa versicolor virginica</strong><br class="title-page-tagline"/><strong class="calibre1">1 50 0 0</strong><br class="title-page-tagline"/><strong class="calibre1">2 0 48 4</strong><br class="title-page-tagline"/><strong class="calibre1">3 0 2 46</strong><br class="title-page-tagline"/>        <br class="title-page-tagline"/>ggplot(iris, aes(Petal.Length, Petal.Width, color =<br class="title-page-tagline"/>iris.cluster$cluster)) + geom_point() + ggtitle("Variation by<br class="title-page-tagline"/>Clusters")
</pre>
<ol start="5" class="calibre15">
<li value="5" class="calibre13">The following plot shows the distribution of clusters:</li>
</ol>
<div class="cdpaligncenter"><img class="image-border6" src="../images/00081.jpeg"/></div>
<div class="packt_figref">Variation of irises across three clusters</div>


            </article>

            
        </section>
    

        <section id="TI1E1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">How it works...</h1>
                
            
            <article>
                
<p class="calibre2">Model evaluation is a key step in any machine learning process. It is different for supervised and unsupervised models. In supervised models, predictions play a major role; whereas in unsupervised models, homogeneity within clusters and heterogeneity across clusters play a major role.</p>
<p class="calibre2">Some widely used model evaluation parameters for regression models (including cross validation) are as follows:</p>
<ul class="calibre12">
<li class="calibre13">Coefficient of determination</li>
<li class="calibre13">Root mean squared error</li>
<li class="calibre13">Mean absolute error</li>
<li class="calibre13">Akaike or Bayesian information criterion</li>
</ul>
<p class="calibre2">Some widely used model evaluation parameters for classification models (including cross validation) are as follows:</p>
<ul class="calibre12">
<li class="calibre13">Confusion matrix (accuracy, precision, recall, and F1-score)</li>
<li class="calibre13">Gain or lift charts</li>
<li class="calibre13">Area under ROC (receiver operating characteristic) curve</li>
<li class="calibre13">Concordant and discordant ratio</li>
</ul>
<p class="calibre2">Some of the widely used evaluation parameters of unsupervised models (clustering) are as follows:</p>
<ul class="calibre12">
<li class="calibre13">Contingency tables</li>
<li class="calibre13">Sum of squared errors between clustering objects and cluster centers or centroids</li>
<li class="calibre13">Silhouette value</li>
<li class="calibre13">Rand index</li>
<li class="calibre13">Matching index</li>
<li class="calibre13">Pairwise and adjusted pairwise precision and recall (primarily used in NLP)</li>
</ul>
<p class="calibre2">Bias and variance are two key error components of any supervised model; their trade-off plays a vital role in model tuning and selection. Bias is due to incorrect assumptions made by a predictive model while learning outcomes, whereas variance is due to model rigidity toward the training dataset. In other words, higher bias leads to underfitting and higher variance leads to overfitting of models.</p>
<p class="calibre2">In bias, the assumptions are on target functional forms. Hence, this is dominant in parametric models such as linear regression, logistic regression, and linear discriminant analysis as their outcomes are a functional form of input variables.</p>
<p class="calibre2">Variance, on the other hand, shows how susceptible models are to change in datasets. Generally, target functional forms control variance. Hence, this is dominant in non-parametric models such as decision trees, support vector machines, and K-nearest neighbors as their outcomes are not directly a functional form of input variables. In other words, the hyperparameters of non-parametric models can lead to overfitting of predictive models.</p>


            </article>

            
        </section>
    

        <section id="UGI01-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Setting up deep learning tools/packages in R</h1>
                
            
            <article>
                
<p class="calibre2">The major deep learning packages are developed in C/C++ for efficiency purposes and wrappers are developed in R to efficiently develop, extend, and execute deep learning models.</p>
<p class="calibre2">A lot of open source deep learning libraries are available. The prominent libraries in this area are as follows:</p>
<ul class="calibre12">
<li class="calibre13">Theano</li>
<li class="calibre13">TensorFlow</li>
<li class="calibre13">Torch</li>
<li class="calibre13">Caffe</li>
</ul>
<p class="calibre2">There are other prominent packages available on the market such as H2O, CNTK (Microsoft Cognitive Toolkit), darch, Mocha, and ConvNetJS. There are a lot of wrappers that are developed around these packages to support the easy development of deep learning models, such as Keras and Lasagne in Python and MXNet, both supporting multiple languages.</p>


            </article>

            
        </section>
    

        <section id="VF2I1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">How to do it...</h1>
                
            
            <article>
                
<ol class="calibre15">
<li value="1" class="calibre13">This chapter will cover the MXNet and TensorFlow packages (developed in C++ and CUDA for a highly optimized performance in GPU).</li>
<li value="2" class="calibre13">Additionally, the <kbd class="calibre10">h2o</kbd> package will be used to develop some deep learning models. The <kbd class="calibre10">h2o</kbd> package in R is implemented as a REST API, which connects to the H2O server (it runs as <strong class="calibre1">Java Virtual Machines</strong> (<strong class="calibre1">JVM</strong>)). We will provide quick setup instructions for these packages in the following sections</li>
</ol>


            </article>

            
        </section>
    

        <section id="10DJ41-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Installing MXNet in R</h1>
                
            
            <article>
                
<p class="calibre2">This section will cover the installation of MXNet in R.</p>


            </article>

            
        </section>
    

        <section id="11C3M1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Getting ready</h1>
                
            
            <article>
                
<p class="calibre2">The MXNet package is a lightweight deep learning architecture supporting multiple programming languages such as R, Python, and Julia. From a programming perspective, it is a combination of symbolic and imperative programming with support for CPU and GPU.</p>
<p class="calibre2">The CPU-based MXNet in R can be installed using the prebuilt binary package or the source code where the libraries need to be built. In Windows/mac, prebuilt binary packages can be download and installed directly from the R console. MXNet requires the R version to be 3.2.0 and higher. The installation requires the <kbd class="calibre10">drat</kbd> package from CRAN. The <kbd class="calibre10">drat</kbd> package helps maintain R repositories and can be installed using the <kbd class="calibre10">install.packages()</kbd> command.</p>
<p class="calibre2">To i<span>nstall MXNet on</span> Linux (13.10 or later), the <span>following are some dependencies:</span></p>
<ul class="calibre12">
<li class="calibre13">Git (to get the code from GitHub)</li>
<li class="calibre13">libatlas-base-dev (to perform linear algebraic operations)</li>
<li class="calibre13">libopencv-dev (to perform computer vision operations)</li>
</ul>
<p class="calibre2">To install MXNet with a GPU processor, the f<span>ollowing are some dependencies:</span></p>
<ul class="calibre12">
<li class="calibre13">Microsoft Visual Studio 2013</li>
<li class="calibre13">The NVIDIA CUDA Toolkit</li>
<li class="calibre13">The MXNet package</li>
<li class="calibre13">cuDNN (to provide a deep neural network library)</li>
</ul>
<p class="calibre2"><span>Another quick way to install <kbd class="calibre10">mxnet</kbd> with all the dependencies is to use the prebuilt Docker image from the <kbd class="calibre10">chstone</kbd> repository.</span> The <kbd class="calibre10">chstone</kbd>/<kbd class="calibre10">mxnet-gpu</kbd> Docker image will be installed using the following tools:</p>
<ul class="calibre12">
<li class="calibre13">MXNet for R and Python</li>
<li class="calibre13">Ubuntu 16.04</li>
<li class="calibre13">CUDA (Optional for GPU)</li>
<li class="calibre13">cuDNN (Optional for GPU)</li>
</ul>


            </article>

            
        </section>
    

        <section id="12AK81-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">How to do it...</h1>
                
            
            <article>
                
<ol class="calibre15">
<li value="1" class="calibre13">The following R command installs MXNet using prebuilt binary packages, and is hassle-free. The <kbd class="calibre10">drat</kbd> package is then used to add the <kbd class="calibre10">dlmc</kbd> repository from git followed by the <kbd class="calibre10">mxnet</kbd> installation:</li>
</ol>
<pre class="calibre23">
install.packages("drat", repos="https://cran.rstudio.com")<br class="title-page-tagline"/>drat:::addRepo("dmlc")<br class="title-page-tagline"/>install.packages("mxnet")
</pre>
<p class="calibre24">2. The following code helps install MXNet in Ubuntu (V16.04). The first two lines are used to install dependencies and the remaining lines are used to install MXNet, subject to the satisfaction of all the dependencies:</p>
<pre class="calibre23">
sudo apt-get update<br class="title-page-tagline"/>sudo apt-get install -y build-essential git libatlas-base-dev<br class="title-page-tagline"/>libopencv-dev<br class="title-page-tagline"/>git clone https://github.com/dmlc/mxnet.git ~/mxnet --recursive<br class="title-page-tagline"/>cd ~/mxnet<br class="title-page-tagline"/>cp make/config.mk .<br class="title-page-tagline"/>echo "USE_BLAS=openblas" &gt;&gt;config.mk<br class="title-page-tagline"/>make -j$(nproc)
</pre>
<p class="calibre24">3. If MXNet is to be built for GPU, the following <kbd class="calibre10">config</kbd> needs to be updated before the <kbd class="calibre10">make</kbd> command:</p>
<pre class="calibre23">
echo "USE_CUDA=1" &gt;&gt;config.mk<br class="title-page-tagline"/>echo "USE_CUDA_PATH=/usr/local/cuda" &gt;&gt;config.mk<br class="title-page-tagline"/>echo "USE_CUDNN=1" &gt;&gt;config.mk
</pre>
<div class="packt_tip">A detailed installation of MXNet for other operating systems can be found at <a href="http://mxnet.io/get_started/setup.html4" class="calibre25">http://mxnet.io/get_started/setup.html</a>.</div>
<p class="calibre24">4. The following command is used to install MXNet (GPU-based) using Docker with all the dependencies:</p>
<pre class="calibre23">
docker pull chstone/mxnet-gpu
</pre>


            </article>

            
        </section>
    

        <section id="1394Q1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Installing TensorFlow in R</h1>
                
            
            <article>
                
<p class="calibre2">This section will cover another very popular open source machine learning package, TensorFlow, which is very effective in building deep learning models.</p>


            </article>

            
        </section>
    

        <section id="147LC1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Getting ready</h1>
                
            
            <article>
                
<p class="calibre2">TensorFlow is another open source library developed by the <span>Google Brain Team t</span>o build numerical computation models using data flow graphs. The core of TensorFlow was developed in C++ with the wrapper in Python. The <kbd class="calibre10">tensorflow</kbd> package in R gives you access to the TensorFlow API composed of Python modules to execute computation models. TensorFlow supports both CPU- and GPU-based computations.</p>
<p class="calibre2">The <kbd class="calibre10">tensorflow</kbd> package in R calls the Python tensorflow API for execution, which is essential to install the <kbd class="calibre10">tensorflow</kbd> package in both R and Python to make R work. The following are the dependencies for <kbd class="calibre10">tensorflow</kbd>:</p>
<ul class="calibre12">
<li class="calibre13">Python 2.7 / 3.x</li>
<li class="calibre13">R (&gt;3.2)</li>
<li class="calibre13">devtools package in R for installing TensorFlow from GitHub</li>
<li class="calibre13">TensorFlow in Python</li>
<li class="calibre13">pip</li>
</ul>


            </article>

            
        </section>
    

        <section id="1565U1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">How to do it...</h1>
                
            
            <article>
                
<ol class="calibre15">
<li value="1" class="calibre13">Once all the mentioned dependencies are installed, <kbd class="calibre10">tensorflow</kbd> can be installed from <kbd class="calibre10">devtools</kbd> directly using the <kbd class="calibre10">install_github</kbd> command as follows:</li>
</ol>
<pre class="calibre23">
devtools::install_github("rstudio/tensorflow")
</pre>
<ol start="2" class="calibre15">
<li value="2" class="calibre13">Before loading <kbd class="calibre10">tensorflow</kbd> in R, you need to set up the path for Python as the system environment variable. This can be done directly from the R environment, as shown in the following command:</li>
</ol>
<pre class="calibre23">
Sys.setenv(TENSORFLOW_PYTHON="/usr/bin/python")<br class="title-page-tagline"/>library(tensorflow)
</pre>
<p class="calibre2">If the Python <kbd class="calibre10">tensorflow</kbd> module is not installed, R will give the following error:</p>
<div class="cdpaligncenter"><img class="image-border7" src="../images/00104.jpeg"/></div>
<div class="figurecaptionpackt"><span>Error raised by R if tensorflow in Python is not installed</span></div>
<div class="figurecaptionpackt1">
<p class="figurecaptionpackt2"><kbd class="calibre26">tensorflow</kbd> in Python can be installed using <kbd class="calibre26">pip</kbd>:</p>
<pre class="calibre20">
pip install tensorflow # Python 2.7 with no GPU support<br class="title-page-tagline"/>pip3 install tensorflow # Python 3.x with no GPU support<br class="title-page-tagline"/>pip install tensorflow-gpu # Python 2.7 with GPU support<br class="title-page-tagline"/>pip3 install tensorflow-gpu # Python 3.x with GPU support
</pre></div>


            </article>

            
        </section>
    

        <section id="164MG1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">How it works...</h1>
                
            
            <article>
                
<p class="calibre2">TensorFlow follows directed graph philosophy to set up computational models where mathematical operations are represented as nodes with each node supporting multiple input and output while the edges represent the communication of data between nodes. There are also edges known as <strong class="calibre1">control dependencies</strong> in TensorFlow that do not represent the data flow; rather the provide information related to control dependence such as node for the control dependence must finish processing before the destination node of control dependence starts executing.</p>
<p class="calibre2">An example TensorFlow graph for logistic regression scoring is shown in the following diagram:</p>
<div class="cdpaligncenter"><img class="image-border8" src="../images/00083.jpeg"/></div>
<div class="packt_figref">TensorFlow graph for logistic regression</div>
<p class="calibre2">The preceding figure illustrates the TensorFlow graph to score logistic regression with optimized weights:</p>
<div class="cdpaligncenter1"><img src="../images/00084.jpeg" class="calibre27"/></div>
<p class="calibre2">The <em class="calibre9">MatMul</em> node performs matrix multiplication between input feature matrix <em class="calibre9">X</em> and optimized weight Î². The constant <em class="calibre9">C</em> is then added to the output from the <em class="calibre9">MatMul</em> node. The output from <em class="calibre9">Add</em> is then transformed using the <em class="calibre9">Sigmoid</em> function to output <em class="calibre9">Pr(y=1|X)</em>.</p>


            </article>

            
        </section>
    

        <section id="173721-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">See also</h1>
                
            
            <article>
                
<p class="calibre2">Get started with TensorFlow in R using resources at <a href="https://rstudio.github.io/tensorflow/" class="calibre4">https://rstudio.github.io/tensorflow/</a>.</p>


            </article>

            
        </section>
    

        <section id="181NK1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Installing H2O in R</h1>
                
            
            <article>
                
<p class="calibre2">H2O is another very popular open source library to build machine learning models. It is produced by H2O.ai and supports multiple languages including R and Python. The H2O package is a multipurpose machine learning library developed for a distributed environment to run algorithms on big data.</p>


            </article>

            
        </section>
    

        <section id="190861-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Getting ready</h1>
                
            
            <article>
                
<p class="calibre2">To set up H2O, the following systems are required:</p>
<ul class="calibre12">
<li class="calibre13">64-bit Java Runtime Environment (version 1.6 or later)</li>
<li class="calibre13">Minimum 2 GB RAM</li>
</ul>
<p class="calibre2">H2O from R can be called using the <kbd class="calibre10">h2o</kbd> package. The <kbd class="calibre10">h2o</kbd> package has the following dependencies:</p>
<ul class="calibre12">
<li class="calibre13">RCurl</li>
<li class="calibre13">rjson</li>
<li class="calibre13">statmod</li>
<li class="calibre13">survival</li>
<li class="calibre13">stats</li>
<li class="calibre13">tools</li>
<li class="calibre13">utils</li>
<li class="calibre13">methods</li>
</ul>
<p class="calibre2">For machines that do not have curl-config installed, the RCurl dependency installation will fail in R and curl-config needs to be installed outside R.</p>


            </article>

            
        </section>
    

        <section id="19UOO1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">How to do it...</h1>
                
            
            <article>
                
<ol class="calibre15">
<li value="1" class="calibre13">H2O can be installed directly from CRAN with the dependency parameter TRUE to install all CRAN-related <kbd class="calibre10">h2o</kbd> dependencies. This command will install all the R dependencies required for the <kbd class="calibre10">h2o</kbd> package:</li>
</ol>
<pre class="calibre23">
install.packages("h2o", dependencies = T)
</pre>
<ol start="2" class="calibre15">
<li value="2" class="calibre13">The following command is used to call the <kbd class="calibre10">h2o</kbd> package in the current R environment. The first-time execution of the <kbd class="calibre10">h2o</kbd> package will automatically download the JAR file before launching H2O, as shown in the following figure:</li>
</ol>
<pre class="calibre23">
library(h2o) <br class="title-page-tagline"/>localH2O = h2o.init()
</pre>
<div class="cdpaligncenter"><img class="image-border9" src="../images/00085.jpeg"/></div>
<div class="figurecaptionpackt">Starting H<span>2</span>O cluster</div>
<ol start="3" class="calibre15">
<li class="calibre13" value="3">The H2O cluster can be accessed using <strong class="calibre1">cluster</strong> <strong class="calibre1">ip</strong> and <strong class="calibre1">port information</strong>. The current H2O cluster is running on localhost at port <kbd class="calibre10">54321</kbd>, as shown in the following screenshot:</li>
</ol>
<div class="packt_figref"><img class="image-border10" src="../images/00004.jpeg"/></div>
<div class="figurecaptionpackt">H2O cluster running in the browser</div>
<div class="packt_infobox">Models in H2O can be developed interactively using a browser or scripting from R. H2O modeling is like creating a Jupyter Notebook but you create a flow with different operations such as importing data, splitting data, setting up a model, and scoring.</div>


            </article>

            
        </section>
    

        <section id="1AT9A1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">How it works...</h1>
                
            
            <article>
                
<p class="calibre2">Let's build a logistic regression interactively using the H2O browser.</p>
<ol class="calibre15">
<li value="1" class="calibre13">Start a new flow, as shown in the following screenshot:</li>
</ol>
<div class="cdpaligncenter"><img class="image-border11" src="../images/00065.jpeg"/></div>
<div class="packt_figref">Creating a new flow in H2O</div>
<ol start="2" class="calibre15">
<li value="2" class="calibre13">Import a dataset using the Data menu, as shown in the following screenshot:</li>
</ol>
<div class="cdpaligncenter"><img class="image-border12" src="../images/00151.jpeg"/></div>
<div class="figurecaptionpackt">Importing files to the H2O environment</div>
<ol start="3" class="calibre15">
<li value="3" class="calibre13">The imported file in H2O can be parsed into the hex format (the native file format for H2O) using the <strong class="calibre1">Parse these files</strong> action, which will appear once the file is imported to the H2O environment:</li>
</ol>
<div class="cdpaligncenter"><img class="image-border13" src="../images/00086.jpeg"/></div>
<div class="figurecaptionpackt">Parsing the file to the hex format</div>
<ol start="4" class="calibre15">
<li value="4" class="calibre13">The parsed data frame in H2O can be split into training and validation using the <em class="calibre9"><span>Data</span> |</em> <span>Split Frame</span> action, as shown in the following screenshot:</li>
</ol>
<div class="cdpaligncenter"><img class="image-border14" src="../images/00125.jpeg"/></div>
<div class="figurecaptionpackt">Splitting the dataset into training and validation</div>
<ol start="5" class="calibre15">
<li value="5" class="calibre13"><span>Select the model from the <span>Model</span> menu and set up the model-related parameters. An example for a glm model is seen in the following screenshot:</span></li>
</ol>
<div class="packt_figref"><span><img class="image-border15" src="../images/00087.jpeg"/></span></div>
<div class="packt_figref"><span><span>Building a model in H2O</span></span></div>
<ol start="6" class="calibre15">
<li value="6" class="calibre13">The <span>Score</span> <em class="calibre9">|</em> <span>predict</span> action can be used to score another hex data frame in H2O:</li>
</ol>
<div class="cdpaligncenter"><img class="image-border16" src="../images/00089.jpeg"/></div>
<div class="figurecaptionpackt">Scoring in H2O</div>


            </article>

            
        </section>
    

        <section id="1BRPS1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">There's more...</h1>
                
            
            <article>
                
<p class="calibre2">For more complicated scenarios that involve a lot of preprocessing, H2O can be called from R directly. This book will focus more on building models using H2O from R directly. If H2O is set up at a different location instead of localhost, then it can be connected within R by defining the correct <kbd class="calibre10">ip</kbd> and <kbd class="calibre10">port</kbd> at which the cluster is running:</p>
<pre class="calibre20">
localH2O = h2o.init(ip = "localhost", port = 54321, nthreads = -1) 
</pre>
<p class="calibre2">Another critical parameter is the number of threads to be used to build the model; by default, <em class="calibre9">n</em> threads are set to -2, which means that two cores will be used. The value of -1 for <em class="calibre9">n</em> threads will make use of all available cores.</p>
<div class="packt_infobox"><a href="http://docs.h2o.ai/h2o/latest-stable/index.html#gettingstarted" class="calibre25">http://docs.h2o.ai/h2o/latest-stable/index.html#gettingstarted</a> is very good using H2O in interactive mode.</div>


            </article>

            
        </section>
    

        <section id="1CQAE1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Installing all three packages at once using Docker</h1>
                
            
            <article>
                
<p class="calibre2">Docker is a software-contained platform that is used to host multiple software or apps side by side in isolated containers to get better computing density. Unlike virtual machines, containers are built only using libraries and the settings required by any software but do not bundle the entire operating system, thus making it lightweight and efficient.</p>


            </article>

            
        </section>
    

        <section id="1DOR01-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Getting ready</h1>
                
            
            <article>
                
<p class="calibre2">Setting up all three packages could be quite cumbersome depending on the operating system utilized. The following dockerfile code can be used to set up an environment with <kbd class="calibre10">tensorflow</kbd>, <kbd class="calibre10">mxnet</kbd> with GPU, and <kbd class="calibre10">h2o</kbd> installed with all the dependencies:</p>
<pre class="calibre20">
FROM chstone/mxnet-gpu:latest<br class="title-page-tagline"/>MAINTAINER PKS Prakash &lt;prakash5801&gt;<br class="title-page-tagline"/><br class="title-page-tagline"/><br class="title-page-tagline"/># Install dependencies<br class="title-page-tagline"/>RUN apt-get update &amp;&amp; apt-get install -y<br class="title-page-tagline"/> python2.7 <br class="title-page-tagline"/> python-pip <br class="title-page-tagline"/> python-dev <br class="title-page-tagline"/> ipython <br class="title-page-tagline"/> ipython-notebook <br class="title-page-tagline"/> python-pip <br class="title-page-tagline"/> default-jre<br class="title-page-tagline"/><br class="title-page-tagline"/><br class="title-page-tagline"/># Install pip and Jupyter notebook<br class="title-page-tagline"/>RUN pip install --upgrade pip &amp;&amp; <br class="title-page-tagline"/> pip install jupyter<br class="title-page-tagline"/><br class="title-page-tagline"/># Add R to Jupyter kernel <br class="title-page-tagline"/>RUN Rscript -e "install.packages(c('repr', 'IRdisplay', 'crayon', 'pbdZMQ'), dependencies=TRUE, repos='https://cran.rstudio.com')" &amp;&amp; <br class="title-page-tagline"/> Rscript -e "library(devtools); library(methods); options(repos=c(CRAN='https://cran.rstudio.com')); devtools::install_github('IRkernel/IRkernel')" &amp;&amp; <br class="title-page-tagline"/> Rscript -e "library(IRkernel); IRkernel::installspec(name = 'ir32', displayname = 'R 3.2')" <br class="title-page-tagline"/><br class="title-page-tagline"/># Install H2O<br class="title-page-tagline"/>RUN Rscript -e "install.packages('h2o', dependencies=TRUE, repos='http://cran.rstudio.com')"<br class="title-page-tagline"/><br class="title-page-tagline"/># Install tensorflow fixing the proxy port<br class="title-page-tagline"/>RUN pip install tensorflow-gpu<br class="title-page-tagline"/>RUN Rscript -e "library(devtools); devtools::install_github('rstudio/tensorflow')"
</pre>
<p class="calibre2">The current image is created on top of the <kbd class="calibre10">chstone/mxnet-gpu</kbd> Docker image.</p>
<div class="packt_infobox">The chstone/mxnet-gpu is a docker hub repository at <a href="https://hub.docker.com/r/chstone/mxnet-gpu/" class="calibre25">https://hub.docker.com/r/chstone/mxnet-gpu/</a>.</div>


            </article>

            
        </section>
    

        <section id="1ENBI1-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">How to do it...</h1>
                
            
            <article>
                
<p class="calibre2">Docker will all dependencies can be installed using following steps:</p>
<ol class="calibre15">
<li value="1" class="calibre13">Save the preceding code to a location with a name, say, <kbd class="calibre10">Dockerfile</kbd>.</li>
<li value="2" class="calibre13">Using the command line, go to the file location and use the following command and it is also shown in the screenshot after the command:</li>
</ol>
<pre class="calibre23">
docker run -t "TagName:FILENAME"
</pre>
<div class="cdpaligncenter"><img class="image-border17" src="../images/00149.jpeg"/></div>
<div class="figurecaptionpackt">Building the docker image</div>
<ol start="3" class="calibre15">
<li value="3" class="calibre13"><span>Access the image using the</span> <kbd class="calibre10">docker images</kbd> <span>command</span> as follows:</li>
</ol>
<div class="cdpaligncenter"><img class="image-border18" src="../images/00090.jpeg"/></div>
<div class="figurecaptionpackt">View docker images</div>
<ol start="4" class="calibre15">
<li value="4" class="calibre13"><span>Docker images can be executed using the following command:</span></li>
</ol>
<pre class="calibre23">
docker run -it -p 8888:8888 -p 54321:54321 &lt;&lt;IMAGE ID&gt;&gt;
</pre>
<div class="cdpaligncenter"><img class="image-border19" src="../images/00001.jpeg"/></div>
<div class="figurecaptionpackt">Running a Docker image</div>
<p class="calibre2">Here, the option <em class="calibre9">-i</em> is for interactive mode and <em class="calibre9">-t</em> is to allocate --<em class="calibre9">tty</em>. The option <em class="calibre9">-p</em> is used to forward the port. As we will be running Jupyter on port <kbd class="calibre10">8888</kbd> and H2O on <kbd class="calibre10">54321</kbd>, we have forwarded both ports to accessible from the local browser.</p>


            </article>

            
        </section>
    

        <section id="1FLS41-a0a93989f17f4d6cb68b8cfd331bc5ab">

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">There's more...</h1>
                
            
            <article>
                
<p class="calibre2">More options for Docker can be checked out using <kbd class="calibre10">docker run --help</kbd>.</p>


            </article>

            
        </section>
    </body></html>