<html><head></head><body>
  <div id="_idContainer269">
   <h1 class="chapter-number" id="_idParaDest-75">
    <a id="_idTextAnchor078">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     4
    </span>
   </h1>
   <h1 id="_idParaDest-76">
    <a id="_idTextAnchor079">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Deep Learning Models for Graphs
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     In recent years, the field of machine learning has witnessed a paradigm shift with the emergence of
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.4.1">
      graph neural networks
     </span>
    </strong>
    <span class="koboSpan" id="kobo.5.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.6.1">
      GNNs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.7.1">
     ) as powerful tools for addressing prediction tasks on
    </span>
    <a id="_idIndexMarker269">
    </a>
    <span class="koboSpan" id="kobo.8.1">
     graph-structured data.
    </span>
    <span class="koboSpan" id="kobo.8.2">
     Here, we'll delve into the transformative potential of GNNs, highlighting their role as optimizable transformations capable of handling diverse graph attributes, such as nodes, edges, and global context while preserving crucial graph symmetries, particularly
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.9.1">
      permutation invariances.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.10.1">
     The foundation of GNNs lies in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.11.1">
      message-passing neural network
     </span>
    </strong>
    <span class="koboSpan" id="kobo.12.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.13.1">
      MPNN
     </span>
    </strong>
    <span class="koboSpan" id="kobo.14.1">
     ) framework.
    </span>
    <span class="koboSpan" id="kobo.14.2">
     Through this
    </span>
    <a id="_idIndexMarker270">
    </a>
    <span class="koboSpan" id="kobo.15.1">
     framework, GNNs leverage a sophisticated mechanism for information exchange and aggregation across graph structures, enabling the model to capture intricate relationships and dependencies within
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.16.1">
      the data.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.17.1">
     One distinctive feature of GNNs is their adherence to a
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.18.1">
      graph-in, graph-out
     </span>
    </em>
    <span class="koboSpan" id="kobo.19.1">
     architecture.
    </span>
    <span class="koboSpan" id="kobo.19.2">
     This means that the model accepts a graph as input, equipped with information embedded in its nodes, edges, and global context.
    </span>
    <span class="koboSpan" id="kobo.19.3">
     This inherent structure aligns with many real-world problems where data exhibits complex relationships and dependencies best represented
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.20.1">
      as graphs.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.21.1">
     GNNs excel in their ability to perform a progressive embedding transformation on the input graph without altering its connectivity.
    </span>
    <span class="koboSpan" id="kobo.21.2">
     This progressive transformation ensures that the model refines its understanding of the underlying patterns and structures within the data, contributing to enhanced
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.22.1">
      predictive capabilities.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.23.1">
     We'll cover the following topics in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.24.1">
      this chapter:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.25.1">
      Message passing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.26.1">
       in graphs
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.27.1">
       Decoding GNNs
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.28.1">
       Graph convolutional
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.29.1">
        networks
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.30.1">
       (
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.31.1">
        GCNs
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.32.1">
       )
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.33.1">
       Graph Sample and
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.34.1">
        Aggregation
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.35.1">
       (
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.36.1">
        GraphSAGE
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.37.1">
       )
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.38.1">
       Graph attention
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.39.1">
        networks
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.40.1">
       (
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.41.1">
        GATs
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.42.1">
       )
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-77">
    <a id="_idTextAnchor080">
    </a>
    <span class="koboSpan" id="kobo.43.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.44.1">
     This chapter requires a basic understanding of graphs and representation learning as covered in previous chapters.
    </span>
    <span class="koboSpan" id="kobo.44.2">
     The code present in the chapter and on GitHub can be used directly on Google Colab with an additional installation of the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.45.1">
      PyTorch Geometric
     </span>
    </strong>
    <span class="koboSpan" id="kobo.46.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.47.1">
      PyG
     </span>
    </strong>
    <span class="koboSpan" id="kobo.48.1">
     ) package.
    </span>
    <span class="koboSpan" id="kobo.48.2">
     The code examples for the book are available in its GitHub
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.49.1">
      repository:
     </span>
    </span>
    <a href="https://github.com/PacktPublishing/Applied-Deep-Learning-on-Graphs">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.50.1">
       https://github.com/PacktPublishing/Applied-Deep-Learning-on-Graphs
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.51.1">
      .
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-78">
    <a id="_idTextAnchor081">
    </a>
    <span class="koboSpan" id="kobo.52.1">
     Message passing in graphs
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.53.1">
     Unlike traditional neural networks, GNNs need to account for the inherent structure of the graph, allowing nodes to exchange information and update their representations based on their local neighborhoods.
    </span>
    <span class="koboSpan" id="kobo.53.2">
     This core mechanism is achieved through
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.54.1">
      message passing
     </span>
    </strong>
    <span class="koboSpan" id="kobo.55.1">
     , a process
    </span>
    <a id="_idIndexMarker271">
    </a>
    <span class="koboSpan" id="kobo.56.1">
     of iteratively passing messages between nodes and aggregating information from
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.57.1">
      their neighbors.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.58.1">
     GNNs operate on graph-structured data and use a message-passing mechanism to update node representations based on information from neighboring nodes.
    </span>
    <span class="koboSpan" id="kobo.58.2">
     Let’s delve into the mathematical explanation of message passing
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.59.1">
      in GNNs.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.60.1">
     Consider an undirected graph
    </span>
    <span class="koboSpan" id="kobo.61.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;mml:mo&gt;,&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;E&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/116.png" style="vertical-align:-0.167em;height:0.864em;width:4.098em"/>
    </span>
    <span class="koboSpan" id="kobo.62.1">
     , where
    </span>
    <span class="koboSpan" id="kobo.63.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/1.png" style="vertical-align:-0.010em;height:0.658em;width:0.674em"/>
    </span>
    <span class="koboSpan" id="kobo.64.1">
     is the set of nodes and
    </span>
    <span class="koboSpan" id="kobo.65.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;E&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/118.png" style="vertical-align:-0.000em;height:0.648em;width:0.786em"/>
    </span>
    <span class="koboSpan" id="kobo.66.1">
     is the set of edges.
    </span>
    <span class="koboSpan" id="kobo.66.2">
     Each node
    </span>
    <span class="koboSpan" id="kobo.67.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/89.png" style="vertical-align:-0.012em;height:0.460em;width:0.446em"/>
    </span>
    <span class="koboSpan" id="kobo.68.1">
     in
    </span>
    <span class="koboSpan" id="kobo.69.1">
     <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/120.png" style="vertical-align:-0.010em;height:0.658em;width:0.911em"/>
    </span>
    <span class="koboSpan" id="kobo.70.1">
     has an associated feature vector
    </span>
    <span class="koboSpan" id="kobo.71.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;x&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/121.png" style="vertical-align:-0.340em;height:0.788em;width:0.710em"/>
    </span>
    <span class="koboSpan" id="kobo.72.1">
     .
    </span>
    <span class="koboSpan" id="kobo.72.2">
     The goal of a GNN is to learn a representation
    </span>
    <span class="koboSpan" id="kobo.73.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/122.png" style="vertical-align:-0.340em;height:1.051em;width:0.711em"/>
    </span>
    <span class="koboSpan" id="kobo.74.1">
     for each node
    </span>
    <span class="koboSpan" id="kobo.75.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/89.png" style="vertical-align:-0.012em;height:0.460em;width:0.446em"/>
    </span>
    <span class="koboSpan" id="kobo.76.1">
     that captures information from
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.77.1">
      its neighborhood.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.78.1">
     The basic message-passing operation in a GNN can be broken down into a series
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.79.1">
      of steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.80.1">
       Aggregation
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.81.1">
        of messages
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.82.1">
       :
      </span>
     </span>
     <ol>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.83.1">
        For each node
       </span>
       <span class="koboSpan" id="kobo.84.1">
        <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/89.png" style="vertical-align:-0.012em;height:0.460em;width:0.446em"/>
       </span>
       <span class="koboSpan" id="kobo.85.1">
        , gather information
       </span>
       <a id="_idIndexMarker272">
       </a>
       <span class="koboSpan" id="kobo.86.1">
        from
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.87.1">
         its neighbors.
        </span>
       </span>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.88.1">
        Let
       </span>
       <span class="koboSpan" id="kobo.89.1">
        <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/125.png" style="vertical-align:-0.134em;height:0.782em;width:1.843em"/>
       </span>
       <span class="koboSpan" id="kobo.90.1">
        represent the set of neighbors of
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.91.1">
         node
        </span>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.92.1">
         <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/89.png" style="vertical-align:-0.012em;height:0.460em;width:0.446em"/>
        </span>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.93.1">
         .
        </span>
       </span>
      </li>
     </ol>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.94.1">
       The aggregated message
      </span>
      <span class="koboSpan" id="kobo.95.1">
       <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;m&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/127.png" style="vertical-align:-0.340em;height:0.788em;width:0.964em"/>
      </span>
      <span class="koboSpan" id="kobo.96.1">
       for node
      </span>
      <span class="koboSpan" id="kobo.97.1">
       <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/128.png" style="vertical-align:-0.012em;height:0.460em;width:0.424em"/>
      </span>
      <span class="koboSpan" id="kobo.98.1">
       is computed by aggregating information from
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.99.1">
        its neighbors:
       </span>
      </span>
     </p>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.100.1">
     <img alt="&lt;mml:math   display=&quot;block&quot;&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;m&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;g&lt;/mml:mi&gt;&lt;mml:mi&gt;g&lt;/mml:mi&gt;&lt;mml:mi&gt;r&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt;g&lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;t&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mfenced open=&quot;{&quot; close=&quot;}&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mo&gt;:&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;ϵ&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/129.png" style="vertical-align:-0.440em;height:1.251em;width:13.061em"/>
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.101.1">
     The aggregation
    </span>
    <a id="_idIndexMarker273">
    </a>
    <span class="koboSpan" id="kobo.102.1">
     function can vary (e.g., sum, mean, or
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.103.1">
      attention-weighted sum).
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.104.1">
        UPDATE function
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.105.1">
       :
      </span>
     </span>
     <ol>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.106.1">
        Update the node representation
       </span>
       <span class="koboSpan" id="kobo.107.1">
        <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/122.png" style="vertical-align:-0.340em;height:1.051em;width:0.711em"/>
       </span>
       <span class="koboSpan" id="kobo.108.1">
        based on the aggregated message
       </span>
       <span class="koboSpan" id="kobo.109.1">
        <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;m&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/131.png" style="vertical-align:-0.340em;height:0.788em;width:1.024em"/>
       </span>
       <span class="koboSpan" id="kobo.110.1">
        and the current node
       </span>
       <a id="_idIndexMarker274">
       </a>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.111.1">
         representation
        </span>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.112.1">
         <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/122.png" style="vertical-align:-0.340em;height:1.051em;width:0.711em"/>
        </span>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.113.1">
         .
        </span>
       </span>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.114.1">
        The
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.115.1">
         UPDATE
        </span>
       </strong>
       <span class="koboSpan" id="kobo.116.1">
        function
       </span>
       <span class="koboSpan" id="kobo.117.1">
        <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/133.png" style="vertical-align:-0.254em;height:0.965em;width:3.018em"/>
       </span>
       <span class="koboSpan" id="kobo.118.1">
        (
       </span>
       <span class="koboSpan" id="kobo.119.1">
        <img alt="&lt;mml:math  &gt;&lt;mml:mo&gt;∙&lt;/mml:mo&gt;&lt;/mml:math&gt;" src="image/134.png" style="vertical-align:-0.000em;height:0.289em;width:0.210em"/>
       </span>
       <span class="koboSpan" id="kobo.120.1">
        ) is a neural network layer that takes the aggregated message and the current node representation as input and produces the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.121.1">
         updated representation:
        </span>
       </span>
      </li>
     </ol>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.122.1">
     <img alt="&lt;mml:math xmlns:mml=&quot;http://www.w3.org/1998/Math/MathML&quot; xmlns:m=&quot;http://schemas.openxmlformats.org/officeDocument/2006/math&quot;&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;'&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;/mml:math&gt;" src="image/135.png" style="vertical-align:-0.340em;height:1.051em;width:0.850em"/>
    </span>
    <span class="koboSpan" id="kobo.123.1">
     =
    </span>
    <span class="koboSpan" id="kobo.124.1">
     <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/136.png" style="vertical-align:-0.390em;height:1.151em;width:5.925em"/>
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.125.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.126.1">
      UPDATE
     </span>
    </strong>
    <span class="koboSpan" id="kobo.127.1">
     function typically involves a neural network layer with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.128.1">
      learnable parameters.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.129.1">
     These steps are iteratively applied for
    </span>
    <a id="_idIndexMarker275">
    </a>
    <span class="koboSpan" id="kobo.130.1">
     a fixed number of times or until convergence to refine the node representations.
    </span>
    <span class="koboSpan" id="kobo.130.2">
     The overall process can be expressed in a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.131.1">
      few equations:
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.132.1">
     <img alt="&lt;mml:math   display=&quot;block&quot;&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;m&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;g&lt;/mml:mi&gt;&lt;mml:mi&gt;g&lt;/mml:mi&gt;&lt;mml:mi&gt;r&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt;g&lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;t&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mo&gt;:&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;∈&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/137.png" style="vertical-align:-0.390em;height:1.151em;width:11.774em"/>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.133.1">
     <img alt="&lt;mml:math xmlns:mml=&quot;http://www.w3.org/1998/Math/MathML&quot; xmlns:m=&quot;http://schemas.openxmlformats.org/officeDocument/2006/math&quot; display=&quot;block&quot;&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;'&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;mml:mi&gt;p&lt;/mml:mi&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;t&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;mml:mo&gt;,&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;m&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/138.png" style="vertical-align:-0.452em;height:1.213em;width:7.623em"/>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.134.1">
     These equations capture the essence of the message-passing mechanism in a GNN.
    </span>
    <span class="koboSpan" id="kobo.134.2">
     The specific choices for the aggregation function,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.135.1">
      UPDATE
     </span>
    </strong>
    <span class="koboSpan" id="kobo.136.1">
     function, and the number of iterations depend on the architecture
    </span>
    <a id="_idIndexMarker276">
    </a>
    <span class="koboSpan" id="kobo.137.1">
     of the GNN (e.g., GraphSAGE, GCN,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.138.1">
      gated graph neural networks
     </span>
    </strong>
    <span class="koboSpan" id="kobo.139.1">
     (
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.140.1">
       GGNNs
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.141.1">
      ), etc.).
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.142.1">
     For instance, in a simple
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.143.1">
      GraphSAGE
     </span>
    </strong>
    <span class="koboSpan" id="kobo.144.1">
     formulation, the aggregation function might be a mean operation, and the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.145.1">
      UPDATE
     </span>
    </strong>
    <span class="koboSpan" id="kobo.146.1">
     function might be a simple neural
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.147.1">
      network layer:
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.148.1">
     <img alt="&lt;mml:math   display=&quot;block&quot;&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;m&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mfrac&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced open=&quot;|&quot; close=&quot;|&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfrac&gt;&lt;mml:mrow&gt;&lt;mml:munder&gt;&lt;mml:mo stretchy=&quot;false&quot;&gt;∑&lt;/mml:mo&gt;&lt;mml:mrow&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;ϵ&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;/mml:mrow&gt;&lt;/mml:munder&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:mrow&gt;&lt;/mml:math&gt;" src="image/139.png" style="vertical-align:-0.653em;height:1.644em;width:6.480em"/>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.149.1">
     <img alt="&lt;mml:math xmlns:mml=&quot;http://www.w3.org/1998/Math/MathML&quot; xmlns:m=&quot;http://schemas.openxmlformats.org/officeDocument/2006/math&quot; display=&quot;block&quot;&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;'&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;σ&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;W&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;⋅&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;c&lt;/mml:mi&gt;&lt;mml:mi&gt;o&lt;/mml:mi&gt;&lt;mml:mi&gt;n&lt;/mml:mi&gt;&lt;mml:mi&gt;c&lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;t&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;,&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;m&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/140.png" style="vertical-align:-0.440em;height:1.251em;width:11.311em"/>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.150.1">
     Here,
    </span>
    <span class="koboSpan" id="kobo.151.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;σ&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/141.png" style="vertical-align:-0.012em;height:0.473em;width:0.479em"/>
    </span>
    <span class="koboSpan" id="kobo.152.1">
     is an activation
    </span>
    <a id="_idIndexMarker277">
    </a>
    <span class="koboSpan" id="kobo.153.1">
     function,
    </span>
    <span class="koboSpan" id="kobo.154.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;W&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/142.png" style="vertical-align:-0.010em;height:0.658em;width:0.953em"/>
    </span>
    <span class="koboSpan" id="kobo.155.1">
     is a learnable weight matrix, and
    </span>
    <span class="koboSpan" id="kobo.156.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;c&lt;/mml:mi&gt;&lt;mml:mi&gt;o&lt;/mml:mi&gt;&lt;mml:mi&gt;n&lt;/mml:mi&gt;&lt;mml:mi&gt;c&lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;t&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mo&gt;⋅&lt;/mml:mo&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/143.png" style="vertical-align:-0.099em;height:0.702em;width:3.508em"/>
    </span>
    <span class="koboSpan" id="kobo.157.1">
     is the concatenation
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.158.1">
      operation.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer195">
     <span class="koboSpan" id="kobo.159.1">
      <img alt="Figure 4.1 – Message passing in graphs" src="image/B22118_04_1.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.160.1">
     Figure 4.1 – Message passing in graphs
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.161.1">
     Through these iterative steps, message passing enables nodes to learn representations that capture not only their own intrinsic features but also the information from their connected neighbors and the
    </span>
    <a id="_idIndexMarker278">
    </a>
    <span class="koboSpan" id="kobo.162.1">
     overall structure of the graph.
    </span>
    <span class="koboSpan" id="kobo.162.2">
     This allows GNNs to effectively model complex relationships and dependencies within
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.163.1">
      graph-structured data.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.164.1">
     Now, let’s try to understand how to formally define
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.165.1">
      a GNN.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-79">
    <a id="_idTextAnchor082">
    </a>
    <span class="koboSpan" id="kobo.166.1">
     Decoding GNNs
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.167.1">
     A
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.168.1">
      GNN
     </span>
    </strong>
    <span class="koboSpan" id="kobo.169.1">
     is a neural network
    </span>
    <a id="_idIndexMarker279">
    </a>
    <span class="koboSpan" id="kobo.170.1">
     architecture designed to operate on graph-structured data.
    </span>
    <span class="koboSpan" id="kobo.170.2">
     It learns a function that maps a graph and its associated features to a set of node-level, edge-level, or graph-level outputs.
    </span>
    <span class="koboSpan" id="kobo.170.3">
     The following is a formal mathematical definition of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.171.1">
      a GNN.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.172.1">
     Given a graph
    </span>
    <span class="koboSpan" id="kobo.173.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;mml:mo&gt;,&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;E&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/144.png" style="vertical-align:-0.167em;height:0.864em;width:4.143em"/>
    </span>
    <span class="koboSpan" id="kobo.174.1">
     , where
    </span>
    <span class="koboSpan" id="kobo.175.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/1.png" style="vertical-align:-0.010em;height:0.658em;width:0.683em"/>
    </span>
    <span class="koboSpan" id="kobo.176.1">
     is the set of nodes and
    </span>
    <span class="koboSpan" id="kobo.177.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;E&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/146.png" style="vertical-align:-0.000em;height:0.648em;width:0.566em"/>
    </span>
    <span class="koboSpan" id="kobo.178.1">
     is the set of edges, let
    </span>
    <span class="koboSpan" id="kobo.179.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;X&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;∈&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced open=&quot;|&quot; close=&quot;|&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;mml:mo&gt;×&lt;/mml:mo&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:math&gt;" src="image/147.png" style="vertical-align:-0.027em;height:0.775em;width:3.965em"/>
    </span>
    <span class="koboSpan" id="kobo.180.1">
     be the node feature matrix, where each row
    </span>
    <span class="koboSpan" id="kobo.181.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;x&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mo&gt;∈&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:math&gt;" src="image/148.png" style="vertical-align:-0.340em;height:1.088em;width:3.196em"/>
    </span>
    <span class="koboSpan" id="kobo.182.1">
     represents the features of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.183.1">
      node
     </span>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.184.1">
      <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/149.png" style="vertical-align:-0.027em;height:0.675em;width:2.489em"/>
     </span>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.185.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.186.1">
     A GNN is a function
    </span>
    <span class="koboSpan" id="kobo.187.1">
     <img alt="&lt;mml:math xmlns:mml=&quot;http://www.w3.org/1998/Math/MathML&quot; xmlns:m=&quot;http://schemas.openxmlformats.org/officeDocument/2006/math&quot;&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;f&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;θ&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;:&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;mml:mo&gt;×&lt;/mml:mo&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced open=&quot;|&quot; close=&quot;|&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;mml:mo&gt;×&lt;/mml:mo&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mo&gt;→&lt;/mml:mo&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced open=&quot;|&quot; close=&quot;|&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;mml:mo&gt;×&lt;/mml:mo&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;'&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:math&gt;" src="image/150.png" style="vertical-align:-0.340em;height:1.088em;width:9.051em"/>
    </span>
    <span class="koboSpan" id="kobo.188.1">
     parameterized by learnable weights
    </span>
    <span class="koboSpan" id="kobo.189.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;θ&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/151.png" style="vertical-align:-0.012em;height:0.723em;width:0.481em"/>
    </span>
    <span class="koboSpan" id="kobo.190.1">
     , which maps the graph
    </span>
    <span class="koboSpan" id="kobo.191.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/152.png" style="vertical-align:-0.015em;height:0.679em;width:0.714em"/>
    </span>
    <span class="koboSpan" id="kobo.192.1">
     and its node features
    </span>
    <span class="koboSpan" id="kobo.193.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;X&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/153.png" style="vertical-align:-0.000em;height:0.648em;width:0.675em"/>
    </span>
    <span class="koboSpan" id="kobo.194.1">
     to a new set of node representations
    </span>
    <span class="koboSpan" id="kobo.195.1">
     <img alt="&lt;mml:math xmlns:mml=&quot;http://www.w3.org/1998/Math/MathML&quot; xmlns:m=&quot;http://schemas.openxmlformats.org/officeDocument/2006/math&quot;&gt;&lt;mml:mi&gt;H&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;∈&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced open=&quot;|&quot; close=&quot;|&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;mml:mo&gt;×&lt;/mml:mo&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;'&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:math&gt;" src="image/154.png" style="vertical-align:-0.027em;height:0.775em;width:4.384em"/>
    </span>
    <span class="koboSpan" id="kobo.196.1">
     , where
    </span>
    <span class="koboSpan" id="kobo.197.1">
     <img alt="&lt;mml:math xmlns:mml=&quot;http://www.w3.org/1998/Math/MathML&quot; xmlns:m=&quot;http://schemas.openxmlformats.org/officeDocument/2006/math&quot;&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;'&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:math&gt;" src="image/155.png" style="vertical-align:-0.012em;height:0.723em;width:0.780em"/>
    </span>
    <span class="koboSpan" id="kobo.198.1">
     is the dimensionality of the output
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.199.1">
      node representations.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.200.1">
     The function
    </span>
    <span class="koboSpan" id="kobo.201.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;f&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;θ&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/156.png" style="vertical-align:-0.340em;height:1.051em;width:0.569em"/>
    </span>
    <span class="koboSpan" id="kobo.202.1">
     is computed through a series of message passing and aggregation steps, typically organized into
    </span>
    <span class="koboSpan" id="kobo.203.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;L&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/115.png" style="vertical-align:-0.000em;height:0.648em;width:0.531em"/>
    </span>
    <span class="koboSpan" id="kobo.204.1">
     layers.
    </span>
    <span class="koboSpan" id="kobo.204.2">
     At each layer
    </span>
    <span class="koboSpan" id="kobo.205.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;∈&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mfenced open=&quot;{&quot; close=&quot;}&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;mml:mo&gt;,&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;…&lt;/mml:mo&gt;&lt;mml:mo&gt;,&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;L&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/158.png" style="vertical-align:-0.167em;height:0.878em;width:5.019em"/>
    </span>
    <span class="koboSpan" id="kobo.206.1">
     , the node representations are updated
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.207.1">
      as follows:
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.208.1">
     <img alt="&lt;mml:math   display=&quot;block&quot;&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;U&lt;/mml:mi&gt;&lt;mml:mi&gt;P&lt;/mml:mi&gt;&lt;mml:mi&gt;D&lt;/mml:mi&gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;mml:mi&gt;T&lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;E&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mo&gt;-&lt;/mml:mo&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mo&gt;,&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mfenced open=&quot;{&quot; close=&quot;}&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mo&gt;-&lt;/mml:mo&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mo&gt;:&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;∈&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/159.png" style="vertical-align:-0.490em;height:1.388em;width:19.285em"/>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.209.1">
     Let’s break
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.210.1">
      this down:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.211.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mi&gt;ϵ&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:math&gt;" src="image/160.png" style="vertical-align:-0.340em;height:1.116em;width:2.924em"/>
     </span>
     <span class="koboSpan" id="kobo.212.1">
      is the representation of node
     </span>
     <span class="koboSpan" id="kobo.213.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/95.png" style="vertical-align:-0.012em;height:0.460em;width:0.434em"/>
     </span>
     <span class="koboSpan" id="kobo.214.1">
      at layer
     </span>
     <span class="koboSpan" id="kobo.215.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mo&gt;,&lt;/mml:mo&gt;&lt;/mml:math&gt;" src="image/162.png" style="vertical-align:-0.117em;height:0.828em;width:0.679em"/>
     </span>
     <span class="koboSpan" id="kobo.216.1">
      with
     </span>
     <span class="koboSpan" id="kobo.217.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;0&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;x&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/163.png" style="vertical-align:-0.340em;height:1.051em;width:2.494em"/>
     </span>
     <span class="koboSpan" id="kobo.218.1">
      .
     </span>
     <span class="koboSpan" id="kobo.218.2">
      Here,
     </span>
     <span class="koboSpan" id="kobo.219.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:math&gt;" src="image/164.png" style="vertical-align:-0.000em;height:0.777em;width:1.839em"/>
     </span>
     <span class="koboSpan" id="kobo.220.1">
      represents a real-valued vector space of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.221.1">
       dimension
      </span>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.222.1">
       <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/165.png" style="vertical-align:-0.340em;height:1.051em;width:0.614em"/>
      </span>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.223.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.224.1">
      The
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.225.1">
       UPDATE function
      </span>
     </strong>
     <span class="koboSpan" id="kobo.226.1">
      <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfenced&gt;&lt;/msup&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;Χ&lt;/mi&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;/mfenced&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;→&lt;/mo&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;/mfenced&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/166.png" style="vertical-align:-0.028em;height:0.805em;width:13.292em"/>
     </span>
     <span class="koboSpan" id="kobo.227.1">
      is a learnable function that updates the node
     </span>
     <a id="_idIndexMarker280">
     </a>
     <span class="koboSpan" id="kobo.228.1">
      representation based on its previous representation and the aggregated messages from
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.229.1">
       its neighbors.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.230.1">
      The
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.231.1">
       aggregation (AGG) function
      </span>
     </strong>
     <span class="koboSpan" id="kobo.232.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mo&gt;:&lt;/mml:mo&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mo&gt;-&lt;/mml:mo&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mi&gt;*&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mo&gt;→&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:math&gt;" src="image/167.png" style="vertical-align:-0.028em;height:0.804em;width:7.340em"/>
     </span>
     <span class="koboSpan" id="kobo.233.1">
      is a permutation-invariant aggregation function that
     </span>
     <a id="_idIndexMarker281">
     </a>
     <span class="koboSpan" id="kobo.234.1">
      combines the representations of the neighboring nodes.
     </span>
     <span class="koboSpan" id="kobo.234.2">
      Common choices include sum, mean,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.235.1">
       and max.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.236.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/125.png" style="vertical-align:-0.134em;height:0.782em;width:1.843em"/>
     </span>
     <span class="koboSpan" id="kobo.237.1">
      denotes the set of neighbors of node
     </span>
     <span class="koboSpan" id="kobo.238.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/89.png" style="vertical-align:-0.012em;height:0.460em;width:0.446em"/>
     </span>
     <span class="koboSpan" id="kobo.239.1">
      in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.240.1">
       graph
      </span>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.241.1">
       <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/170.png" style="vertical-align:-0.015em;height:0.679em;width:0.907em"/>
      </span>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.242.1">
       .
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.243.1">
     After
    </span>
    <span class="koboSpan" id="kobo.244.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;L&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/171.png" style="vertical-align:-0.000em;height:0.648em;width:0.829em"/>
    </span>
    <span class="koboSpan" id="kobo.245.1">
     layers of message passing
    </span>
    <a id="_idIndexMarker282">
    </a>
    <span class="koboSpan" id="kobo.246.1">
     and aggregation, the final node representations are given by
    </span>
    <span class="koboSpan" id="kobo.247.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;H&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;L&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;/mml:math&gt;" src="image/172.png" style="vertical-align:-0.340em;height:1.051em;width:2.649em"/>
    </span>
    <span class="koboSpan" id="kobo.248.1">
     for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.249.1">
      all
     </span>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.250.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;∈&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/173.png" style="vertical-align:-0.027em;height:0.675em;width:2.262em"/>
     </span>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.251.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.252.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.253.1">
      UPDATE
     </span>
    </strong>
    <span class="koboSpan" id="kobo.254.1">
     function is typically implemented as
    </span>
    <a id="_idIndexMarker283">
    </a>
    <span class="koboSpan" id="kobo.255.1">
     neural networks, such as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.256.1">
      multi-layer perceptrons
     </span>
    </strong>
    <span class="koboSpan" id="kobo.257.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.258.1">
      MLPs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.259.1">
     ) or attention mechanisms, with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.260.1">
      learnable parameters.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.261.1">
     For graph-level tasks, a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.262.1">
      READOUT function
     </span>
    </strong>
    <span class="koboSpan" id="kobo.263.1">
     is applied to the final node representations to obtain a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.264.1">
      graph-level
     </span>
    </span>
    <span class="No-Break">
     <a id="_idIndexMarker284">
     </a>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.265.1">
      representation:
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.266.1">
     <img alt="&lt;mml:math   display=&quot;block&quot;&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;R&lt;/mml:mi&gt;&lt;mml:mi&gt;E&lt;/mml:mi&gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;mml:mi&gt;D&lt;/mml:mi&gt;&lt;mml:mi&gt;O&lt;/mml:mi&gt;&lt;mml:mi&gt;U&lt;/mml:mi&gt;&lt;mml:mi&gt;T&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mfenced open=&quot;{&quot; close=&quot;}&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;L&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mo&gt;:&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;∈&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/174.png" style="vertical-align:-0.440em;height:1.251em;width:12.403em"/>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.267.1">
     Here,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.268.1">
      READOUT
     </span>
    </strong>
    <span class="koboSpan" id="kobo.269.1">
     is a permutation-invariant function that aggregates the node representations into a single vector, such as sum, mean, or a more complex
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.270.1">
      pooling operation.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.271.1">
     The graph-level representation
    </span>
    <span class="koboSpan" id="kobo.272.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/175.png" style="vertical-align:-0.342em;height:1.053em;width:1.077em"/>
    </span>
    <span class="koboSpan" id="kobo.273.1">
     can then be used for downstream tasks, such as graph classification
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.274.1">
      or regression.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.275.1">
     This is a general formulation of GNNs, and there are many specific architectures that fall under this framework, such as GCNs, GraphSAGE, GATs, and MPNNs, each with their own variations of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.276.1">
      UPDATE
     </span>
    </strong>
    <span class="koboSpan" id="kobo.277.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.278.1">
      AGG
     </span>
    </strong>
    <span class="koboSpan" id="kobo.279.1">
     , and
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.280.1">
       READOUT
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.281.1">
      functions.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.282.1">
     Let’s understand how graph learning borrows the concept of convolution networks and leverages it to extract learnings from
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.283.1">
      a graph.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-80">
    <a id="_idTextAnchor083">
    </a>
    <span class="koboSpan" id="kobo.284.1">
     GCNs
    </span>
   </h1>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.285.1">
      GCNs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.286.1">
     are a specific
    </span>
    <a id="_idIndexMarker285">
    </a>
    <span class="koboSpan" id="kobo.287.1">
     type of GNN that extend the concept of convolution to graph-structured data.
    </span>
    <span class="koboSpan" id="kobo.287.2">
     GCNs learn node representations by aggregating information from neighboring nodes, allowing for the capture of both node features and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.288.1">
      graph structure.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.289.1">
     In a GCN, the graph convolution operation at layer
    </span>
    <span class="koboSpan" id="kobo.290.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/176.png" style="vertical-align:-0.012em;height:0.723em;width:0.248em"/>
    </span>
    <span class="koboSpan" id="kobo.291.1">
     is defined
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.292.1">
      as follows:
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.293.1">
     <img alt="&lt;mml:math   display=&quot;block&quot;&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;H&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mo&gt;+&lt;/mml:mo&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt;σ&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;D&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mo&gt;-&lt;/mml:mo&gt;&lt;mml:mfrac&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;2&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:mfrac&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;D&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfrac&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;2&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:mfrac&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;H&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;W&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/177.png" style="vertical-align:-0.061em;height:0.887em;width:11.287em"/>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.294.1">
     Let’s break
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.295.1">
      this down:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.296.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;H&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mo&gt;∈&lt;/mml:mo&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;R&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced open=&quot;|&quot; close=&quot;|&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;mml:mo&gt;×&lt;/mml:mo&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:math&gt;" src="image/178.png" style="vertical-align:-0.027em;height:0.803em;width:4.834em"/>
     </span>
     <span class="koboSpan" id="kobo.297.1">
      is the matrix of node representations at layer
     </span>
     <span class="koboSpan" id="kobo.298.1">
      <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/179.png" style="vertical-align:-0.012em;height:0.723em;width:0.443em"/>
     </span>
     <span class="koboSpan" id="kobo.299.1">
      , with
     </span>
     <span class="koboSpan" id="kobo.300.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;H&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;0&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;X&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/180.png" style="vertical-align:-0.062em;height:0.746em;width:3.451em"/>
     </span>
     <span class="koboSpan" id="kobo.301.1">
      (input
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.302.1">
       node features).
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.303.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mover accent=&quot;true&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mo&gt;^&lt;/mml:mo&gt;&lt;/mml:mover&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;mml:mo&gt;+&lt;/mml:mo&gt;&lt;mml:mi&gt;I&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/181.png" style="vertical-align:-0.000em;height:0.926em;width:4.383em"/>
     </span>
     <span class="koboSpan" id="kobo.304.1">
      is the adjacency matrix
     </span>
     <span class="koboSpan" id="kobo.305.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/43.png" style="vertical-align:-0.000em;height:0.663em;width:0.663em"/>
     </span>
     <span class="koboSpan" id="kobo.306.1">
      with added self-loops, where
     </span>
     <span class="koboSpan" id="kobo.307.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;I&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/183.png" style="vertical-align:-0.000em;height:0.648em;width:0.334em"/>
     </span>
     <span class="koboSpan" id="kobo.308.1">
      is the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.309.1">
       identity matrix.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.310.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mover accent=&quot;true&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;D&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mo&gt;^&lt;/mml:mo&gt;&lt;/mml:mover&gt;&lt;/mml:math&gt;" src="image/184.png" style="vertical-align:-0.000em;height:0.911em;width:0.806em"/>
     </span>
     <span class="koboSpan" id="kobo.311.1">
      is the diagonal degree matrix of
     </span>
     <span class="koboSpan" id="kobo.312.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mover accent=&quot;true&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mo&gt;^&lt;/mml:mo&gt;&lt;/mml:mover&gt;&lt;/mml:math&gt;" src="image/185.png" style="vertical-align:-0.000em;height:0.926em;width:0.764em"/>
     </span>
     <span class="koboSpan" id="kobo.313.1">
      ,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.314.1">
       with
      </span>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.315.1">
       <img alt="&lt;mml:math  &gt;&lt;mml:mover accent=&quot;true&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;D&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;mml:mo&gt;^&lt;/mml:mo&gt;&lt;/mml:mover&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mrow&gt;&lt;mml:msubsup&gt;&lt;mml:mo stretchy=&quot;false&quot;&gt;∑&lt;/mml:mo&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;j&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mo&gt;̂&lt;/mml:mo&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;mml:mi&gt;j&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:mrow&gt;&lt;/mml:math&gt;" src="image/186.png" style="vertical-align:-0.486em;height:1.397em;width:4.625em"/>
      </span>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.316.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.317.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;W&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;∈&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;R&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;x&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mo&gt;+&lt;/mml:mo&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mi&gt;​&lt;/mml:mi&gt;&lt;mml:mi&gt;​&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/187.png" style="vertical-align:-0.027em;height:0.803em;width:4.988em"/>
     </span>
     <span class="koboSpan" id="kobo.318.1">
      is a learnable weight matrix for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.319.1">
       layer
      </span>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.320.1">
       <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/176.png" style="vertical-align:-0.012em;height:0.723em;width:0.248em"/>
      </span>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.321.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.322.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;σ&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mo&gt;⋅&lt;/mml:mo&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/189.png" style="vertical-align:-0.099em;height:0.702em;width:1.470em"/>
     </span>
     <span class="koboSpan" id="kobo.323.1">
      is a non-linear activation
     </span>
     <a id="_idIndexMarker286">
     </a>
     <span class="koboSpan" id="kobo.324.1">
      function, such as the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.325.1">
       rectified linear unit
      </span>
     </strong>
     <span class="koboSpan" id="kobo.326.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.327.1">
       ReLU
      </span>
     </strong>
     <span class="koboSpan" id="kobo.328.1">
      ) function or
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.329.1">
       sigmoid function.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.330.1">
     The term
    </span>
    <span class="koboSpan" id="kobo.331.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;D&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mo&gt;-&lt;/mml:mo&gt;&lt;mml:mfrac&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;2&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:mfrac&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;D&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfrac&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;2&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:mfrac&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;/mml:math&gt;" src="image/190.png" style="vertical-align:-0.000em;height:0.738em;width:3.218em"/>
    </span>
    <span class="koboSpan" id="kobo.332.1">
     is the
    </span>
    <a id="_idIndexMarker287">
    </a>
    <span class="koboSpan" id="kobo.333.1">
     symmetrically normalized adjacency matrix, which ensures that the scale of the node representations remains consistent
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.334.1">
      across layers.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.335.1">
     Imagine a citation network, where each node stands for a scientific paper and each edge represents a citation connecting two papers.
    </span>
    <span class="koboSpan" id="kobo.335.2">
     Each paper has a feature vector representing its content (e.g., bag-of-words).
    </span>
    <span class="koboSpan" id="kobo.335.3">
     A GCN can be used to classify the papers into different categories (e.g., computer science, physics, biology) by learning node representations that capture both the content and the citation structure of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.336.1">
      the network.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.337.1">
     Building on our mathematical understanding of the GCN, let’s look at a piece of sample code
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.338.1">
      leveraging PyG:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.339.1">
import torch
import torch.nn.functional as F
from torch_geometric.datasets import Planetoid
from torch_geometric.nn import GCNConv
</span><strong class="bold"><span class="koboSpan" id="kobo.340.1"># Load the Cora dataset</span></strong><span class="koboSpan" id="kobo.341.1">
dataset = Planetoid(root='data/Cora', name='Cora')</span></pre>
   <p>
    <span class="koboSpan" id="kobo.342.1">
     For this example, we import the necessary libraries and load the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.343.1">
      Cora dataset
     </span>
    </strong>
    <span class="koboSpan" id="kobo.344.1">
     using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.345.1">
      Planetoid
     </span>
    </strong>
    <span class="koboSpan" id="kobo.346.1">
     class from PyG.
    </span>
    <span class="koboSpan" id="kobo.346.2">
     The Cora
    </span>
    <a id="_idIndexMarker288">
    </a>
    <span class="koboSpan" id="kobo.347.1">
     dataset is a citation network dataset, where
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.348.1">
      nodes
     </span>
    </em>
    <span class="koboSpan" id="kobo.349.1">
     represent scientific papers and
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.350.1">
      edges
     </span>
    </em>
    <span class="koboSpan" id="kobo.351.1">
     represent citations between papers.
    </span>
    <span class="koboSpan" id="kobo.351.2">
     The dataset contains 2,708 nodes, 10,556 edges, and 7 classes representing different
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.352.1">
      research areas:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.353.1">
# Get the graph data
data = dataset[0]
# Print some statistics about the graph
print(f'Number of nodes: {data.num_nodes}')
print(f'Number of edges: {data.num_edges}')
print(f'Number of features: {data.num_features}')
print(f'Number of classes: {dataset.num_classes}')</span></pre>
   <p>
    <span class="koboSpan" id="kobo.354.1">
     Here, we access the
    </span>
    <a id="_idIndexMarker289">
    </a>
    <span class="koboSpan" id="kobo.355.1">
     graph data using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.356.1">
      dataset[0]
     </span>
    </strong>
    <span class="koboSpan" id="kobo.357.1">
     .
    </span>
    <span class="koboSpan" id="kobo.357.2">
     We then print some statistics about the graph, including the number of nodes, edges, features,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.358.1">
      and classes:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.359.1">
Number of nodes: 2708
Number of edges: 10556
Number of features: 1433
Number of classes: 7</span></pre>
   <p>
    <span class="koboSpan" id="kobo.360.1">
     Now that we understand what the data looks like, let’s put down the building blocks of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.361.1">
      the model:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.362.1">
# Define the GCN model
class GCN(torch.nn.Module):
    def __init__(self, in_channels, hidden_channels, out_channels):
        super(GCN, self).__init__()
        self.conv1 = GCNConv(in_channels, hidden_channels)
        self.conv2 = GCNConv(hidden_channels, out_channels)
    def forward(self, x, edge_index):
        x = self.conv1(x, edge_index)
        x = F.relu(x)
        x = F.dropout(x, training=self.training)
        x = self.conv2(x, edge_index)
        return F.log_softmax(x, dim=1)</span></pre>
   <p>
    <span class="koboSpan" id="kobo.363.1">
     Next, we define the GCN model.
    </span>
    <span class="koboSpan" id="kobo.363.2">
     The model consists of two GCN layers (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.364.1">
      GCNConv
     </span>
    </strong>
    <span class="koboSpan" id="kobo.365.1">
     ) with a hidden layer in between.
    </span>
    <span class="koboSpan" id="kobo.365.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.366.1">
      __init__
     </span>
    </strong>
    <span class="koboSpan" id="kobo.367.1">
     method initializes the layers with the specified input, hidden, and output dimensions.
    </span>
    <span class="koboSpan" id="kobo.367.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.368.1">
      forward
     </span>
    </strong>
    <span class="koboSpan" id="kobo.369.1">
     method defines the forward pass of the model, where
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.370.1">
      x
     </span>
    </strong>
    <span class="koboSpan" id="kobo.371.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.372.1">
      edge_index
     </span>
    </strong>
    <span class="koboSpan" id="kobo.373.1">
     are passed through the GCN layers.
    </span>
    <span class="koboSpan" id="kobo.373.2">
     ReLU activation
    </span>
    <a id="_idIndexMarker290">
    </a>
    <span class="koboSpan" id="kobo.374.1">
     and dropout are applied after the first layer, and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.375.1">
      log-softmax
     </span>
    </strong>
    <span class="koboSpan" id="kobo.376.1">
     is applied to the output of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.377.1">
      second layer:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.378.1">
# Set the model parameters
in_channels = dataset.num_node_features
hidden_channels = 16
out_channels = dataset.num_classes
# Create an instance of the GCN model
model = GCN(in_channels, hidden_channels, out_channels)</span></pre>
   <p>
    <span class="koboSpan" id="kobo.379.1">
     Here, we set the model parameters based on the dataset.
    </span>
    <span class="koboSpan" id="kobo.379.2">
     The input dimension (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.380.1">
      in_channels
     </span>
    </strong>
    <span class="koboSpan" id="kobo.381.1">
     ) is set to the number of node features in the dataset, the hidden dimension (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.382.1">
      hidden_channels
     </span>
    </strong>
    <span class="koboSpan" id="kobo.383.1">
     ) is set to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.384.1">
      16
     </span>
    </strong>
    <span class="koboSpan" id="kobo.385.1">
     , and the output dimension (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.386.1">
      out_channels
     </span>
    </strong>
    <span class="koboSpan" id="kobo.387.1">
     ) is set to the number of classes in the dataset.
    </span>
    <span class="koboSpan" id="kobo.387.2">
     We then create an instance of the GCN model with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.388.1">
      these parameters:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.389.1">
# Define the optimizer and loss function
optimizer = torch.optim.Adam(
    model.parameters(), lr=0.01, weight_decay=5e-4)
criterion = torch.nn.NLLLoss()
# Train the model
model.train()
for epoch in range(200):
    optimizer.zero_grad()
    out = model(data.x, data.edge_index)
    loss = criterion(out[data.train_mask],
                     data.y[data.train_mask])
    loss.backward()
    optimizer.step()</span></pre>
   <p>
    <span class="koboSpan" id="kobo.390.1">
     In this part, we define the
    </span>
    <a id="_idIndexMarker291">
    </a>
    <span class="koboSpan" id="kobo.391.1">
     optimizer (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.392.1">
      Adam
     </span>
    </strong>
    <span class="koboSpan" id="kobo.393.1">
     ) and the loss function (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.394.1">
      negative log-likelihood loss (NLLLoss)
     </span>
    </strong>
    <span class="koboSpan" id="kobo.395.1">
     ) for training the
    </span>
    <a id="_idIndexMarker292">
    </a>
    <span class="koboSpan" id="kobo.396.1">
     model.
    </span>
    <span class="koboSpan" id="kobo.396.2">
     We set the learning rate to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.397.1">
      0.01
     </span>
    </strong>
    <span class="koboSpan" id="kobo.398.1">
     and the weight decay
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.399.1">
      to
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.400.1">
       5e-4
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.401.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.402.1">
     We then train the
    </span>
    <a id="_idIndexMarker293">
    </a>
    <span class="koboSpan" id="kobo.403.1">
     model for 200 epochs.
    </span>
    <span class="koboSpan" id="kobo.403.2">
     In each epoch, we do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.404.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.405.1">
      Zero the gradients of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.406.1">
       the optimizer.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.407.1">
      Perform a forward pass of the model on the node features and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.408.1">
       edge index.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.409.1">
      Compute the loss using the model’s output and the ground truth labels for the training nodes (specified
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.410.1">
       by
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.411.1">
        data.train_mask
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.412.1">
       ).
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.413.1">
      Perform a backward pass to compute
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.414.1">
       the gradients.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.415.1">
      Update the model parameters using
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.416.1">
       the optimizer:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.417.1">
# Evaluate the model
model.eval()
_, pred = model(data.x, data.edge_index).max(dim=1)
correct = float(pred[data.test_mask].eq(
    data.y[data.test_mask]).sum().item())
accuracy = correct / data.test_mask.sum().item()
print(f'Accuracy: {accuracy:.4f}')
Accuracy: 0.8000</span></pre>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.418.1">
     Finally, we evaluate the trained model on the test set.
    </span>
    <span class="koboSpan" id="kobo.418.2">
     We set the model to evaluation mode using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.419.1">
      model.eval()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.420.1">
     .
    </span>
    <span class="koboSpan" id="kobo.420.2">
     We perform a forward pass on the entire graph and obtain the predicted class labels using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.421.1">
      max(dim=1)
     </span>
    </strong>
    <span class="koboSpan" id="kobo.422.1">
     .
    </span>
    <span class="koboSpan" id="kobo.422.2">
     We then compute the accuracy by comparing the predicted
    </span>
    <a id="_idIndexMarker294">
    </a>
    <span class="koboSpan" id="kobo.423.1">
     labels with the ground truth labels for the test nodes (specified
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.424.1">
      by
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.425.1">
       data.test_mask
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.426.1">
      ).
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.427.1">
     This code provides a basic implementation of GCN using PyG on the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.428.1">
      Cora dataset.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.429.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.430.1">
     Make sure you have PyG installed before running this code.
    </span>
    <span class="koboSpan" id="kobo.430.2">
     You can install it using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.431.1">
      pip
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.432.1">
       install torch-geometric
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.433.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.434.1">
     Overall, this code creates an instance of the GCN model, trains it on the Cora dataset using the specified hyperparameters (hidden units, learning rate, epochs), and evaluates the trained model on the test set to measure its performance in terms
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.435.1">
      of accuracy.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-81">
    <a id="_idTextAnchor084">
    </a>
    <span class="koboSpan" id="kobo.436.1">
     Using GCNs for different graph tasks
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.437.1">
     GCNs can be utilized to
    </span>
    <a id="_idIndexMarker295">
    </a>
    <span class="koboSpan" id="kobo.438.1">
     learn and perform tasks at different levels in a graph.
    </span>
    <span class="koboSpan" id="kobo.438.2">
     The following can be performed
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.439.1">
      with GCNs:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.440.1">
       Node-level tasks
      </span>
     </strong>
     <span class="koboSpan" id="kobo.441.1">
      : GCNs can
     </span>
     <a id="_idIndexMarker296">
     </a>
     <span class="koboSpan" id="kobo.442.1">
      be used for
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.443.1">
       node classification
      </span>
     </strong>
     <span class="koboSpan" id="kobo.444.1">
      , where the goal is to predict the label of each node in the graph.
     </span>
     <span class="koboSpan" id="kobo.444.2">
      This is demonstrated in the previous example, where the GCN is used to classify nodes in the Cora
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.445.1">
       citation network.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.446.1">
       Edge-level tasks
      </span>
     </strong>
     <span class="koboSpan" id="kobo.447.1">
      : GCNs can be adapted for
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.448.1">
       edge prediction
      </span>
     </strong>
     <span class="koboSpan" id="kobo.449.1">
      or
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.450.1">
       link
      </span>
     </strong>
     <strong class="bold">
      <span class="koboSpan" id="kobo.451.1">
       prediction
      </span>
     </strong>
     <span class="koboSpan" id="kobo.452.1">
      tasks, where the goal is to
     </span>
     <a id="_idIndexMarker297">
     </a>
     <span class="koboSpan" id="kobo.453.1">
      predict the existence or attributes of edges in the graph.
     </span>
     <span class="koboSpan" id="kobo.453.2">
      To
     </span>
     <a id="_idIndexMarker298">
     </a>
     <span class="koboSpan" id="kobo.454.1">
      do this, the
     </span>
     <a id="_idIndexMarker299">
     </a>
     <span class="koboSpan" id="kobo.455.1">
      node representations learned by the GCN can be used to compute edge scores
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.456.1">
       or probabilities.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.457.1">
       Graph-level tasks
      </span>
     </strong>
     <span class="koboSpan" id="kobo.458.1">
      : GCNs can be used for
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.459.1">
       graph classification
      </span>
     </strong>
     <span class="koboSpan" id="kobo.460.1">
      or
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.461.1">
       regression
      </span>
     </strong>
     <span class="koboSpan" id="kobo.462.1">
      tasks, where the goal is to
     </span>
     <a id="_idIndexMarker300">
     </a>
     <span class="koboSpan" id="kobo.463.1">
      predict a label or a continuous value for an entire graph.
     </span>
     <span class="koboSpan" id="kobo.463.2">
      To achieve
     </span>
     <a id="_idIndexMarker301">
     </a>
     <span class="koboSpan" id="kobo.464.1">
      this, a pooling operation (e.g., global mean pooling or global max pooling) is applied to the
     </span>
     <a id="_idIndexMarker302">
     </a>
     <span class="koboSpan" id="kobo.465.1">
      node representations learned by the GCN to obtain a graph-level representation, which is then fed into a classifier
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.466.1">
       or regressor.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.467.1">
     GCNs are a powerful and widely used type of GNN that can effectively learn node representations by incorporating both node features and graph structure.
    </span>
    <span class="koboSpan" id="kobo.467.2">
     They have shown strong performance on various graph-based tasks and can be adapted for node-level, edge-level, and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.468.1">
      graph-level problems.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.469.1">
     Over time, many optimizations over vanilla GCNs have been proposed and utilized in the industry.
    </span>
    <span class="koboSpan" id="kobo.469.2">
     One such optimization, especially for scaling the graph learning process,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.470.1">
      is GraphSAGE.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-82">
    <a id="_idTextAnchor085">
    </a>
    <span class="koboSpan" id="kobo.471.1">
     GraphSAGE
    </span>
   </h1>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.472.1">
      GraphSAGE
     </span>
    </strong>
    <span class="koboSpan" id="kobo.473.1">
     introduces a scalable and adaptive approach to graph representation learning, addressing some limitations of
    </span>
    <a id="_idIndexMarker303">
    </a>
    <span class="koboSpan" id="kobo.474.1">
     GCN and enhancing scalability.
    </span>
    <span class="koboSpan" id="kobo.474.2">
     At its core, GraphSAGE employs a neighborhood sampling and aggregation strategy, diverging from the fixed-weight aggregation mechanism
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.475.1">
      of GCN.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.476.1">
     In GraphSAGE, the process of learning node representations involves iteratively sampling and aggregating information from local neighborhoods.
    </span>
    <span class="koboSpan" id="kobo.476.2">
     Let
    </span>
    <span class="koboSpan" id="kobo.477.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;mml:mo&gt;,&lt;/mml:mo&gt;&lt;mml:mi&gt;E&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/191.png" style="vertical-align:-0.167em;height:0.864em;width:3.935em"/>
    </span>
    <span class="koboSpan" id="kobo.478.1">
     be a graph with nodes
    </span>
    <span class="koboSpan" id="kobo.479.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;V&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/1.png" style="vertical-align:-0.010em;height:0.658em;width:0.666em"/>
    </span>
    <span class="koboSpan" id="kobo.480.1">
     and edges
    </span>
    <span class="koboSpan" id="kobo.481.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;E&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/2.png" style="vertical-align:-0.000em;height:0.648em;width:0.557em"/>
    </span>
    <span class="koboSpan" id="kobo.482.1">
     , and
    </span>
    <span class="koboSpan" id="kobo.483.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;f&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;/mml:math&gt;" src="image/194.png" style="vertical-align:-0.340em;height:1.088em;width:0.467em"/>
    </span>
    <span class="koboSpan" id="kobo.484.1">
     denote the embedding of node
    </span>
    <span class="koboSpan" id="kobo.485.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/195.png" style="vertical-align:-0.012em;height:0.652em;width:0.272em"/>
    </span>
    <span class="koboSpan" id="kobo.486.1">
     at layer
    </span>
    <span class="koboSpan" id="kobo.487.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/176.png" style="vertical-align:-0.012em;height:0.723em;width:0.241em"/>
    </span>
    <span class="koboSpan" id="kobo.488.1">
     .
    </span>
    <span class="koboSpan" id="kobo.488.2">
     The update rule for GraphSAGE can be expressed
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.489.1">
      as follows:
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.490.1">
     <img alt="&lt;mml:math   display=&quot;block&quot;&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;f&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mo&gt;+&lt;/mml:mo&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;​&lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;mml:mi&gt;g&lt;/mml:mi&gt;&lt;mml:mi&gt;g&lt;/mml:mi&gt;&lt;mml:mi&gt;r&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt;g&lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;t&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mfenced open=&quot;{&quot; close=&quot;}&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;f&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;j&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;​&lt;/mml:mi&gt;&lt;mml:mo&gt;,&lt;/mml:mo&gt;&lt;mml:mo&gt;∀&lt;/mml:mo&gt;&lt;mml:mi&gt;j&lt;/mml:mi&gt;&lt;mml:mo&gt;∈&lt;/mml:mo&gt;&lt;mml:mi&gt;S&lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;m&lt;/mml:mi&gt;&lt;mml:mi&gt;p&lt;/mml:mi&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;mml:mi&gt;g&lt;/mml:mi&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;mml:mi&gt;b&lt;/mml:mi&gt;&lt;mml:mi&gt;o&lt;/mml:mi&gt;&lt;mml:mi&gt;r&lt;/mml:mi&gt;&lt;mml:mi&gt;s&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/197.png" style="vertical-align:-0.583em;height:1.430em;width:18.769em"/>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.491.1">
     Here,
    </span>
    <span class="koboSpan" id="kobo.492.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;S&lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;m&lt;/mml:mi&gt;&lt;mml:mi&gt;p&lt;/mml:mi&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;mml:mi&gt;g&lt;/mml:mi&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;mml:mi&gt;b&lt;/mml:mi&gt;&lt;mml:mi&gt;o&lt;/mml:mi&gt;&lt;mml:mi&gt;r&lt;/mml:mi&gt;&lt;mml:mi&gt;s&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/198.png" style="vertical-align:-0.257em;height:0.968em;width:7.828em"/>
    </span>
    <span class="koboSpan" id="kobo.493.1">
     represents a dynamically sampled subset of neighbors for node
    </span>
    <span class="koboSpan" id="kobo.494.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/199.png" style="vertical-align:-0.012em;height:0.652em;width:0.282em"/>
    </span>
    <span class="koboSpan" id="kobo.495.1">
     at each iteration.
    </span>
    <span class="koboSpan" id="kobo.495.2">
     This adaptability allows GraphSAGE to scale more efficiently compared to GCN, especially in scenarios where the graph is large or when computational resources are limited,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.496.1">
      maintaining scalability.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.497.1">
     The structure for PyG code remains the same as for the GCN; we will just be using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.498.1">
      GraphSAGE
     </span>
    </strong>
    <span class="koboSpan" id="kobo.499.1">
     module
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.500.1">
      from
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.501.1">
       torch_geometric.nn
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.502.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.503.1">
     To modify the previous code to use GraphSAGE instead of GCN, you need to make a few changes.
    </span>
    <span class="koboSpan" id="kobo.503.2">
     Here are the lines you need
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.504.1">
      to update:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.505.1">
      Replace the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.506.1">
       import
      </span>
     </strong>
     <a id="_idIndexMarker304">
     </a>
     <span class="koboSpan" id="kobo.507.1">
      statement for
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.508.1">
       GCNConv
      </span>
     </strong>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.509.1">
       with
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.510.1">
        SAGEConv
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.511.1">
       :
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.512.1">
from torch_geometric.nn import SAGEConv</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.513.1">
      Update the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.514.1">
       GCN
      </span>
     </strong>
     <span class="koboSpan" id="kobo.515.1">
      model class to use
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.516.1">
       SAGEConv
      </span>
     </strong>
     <span class="koboSpan" id="kobo.517.1">
      layers instead
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.518.1">
       of
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.519.1">
        GCNConv
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.520.1">
       :
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.521.1">
# Define the GraphSAGE model
class GraphSAGE(torch.nn.Module):
    def __init__(self, in_channels, hidden_channels,
                 out_channels):
        super(GraphSAGE, self).__init__()
        self.conv1 = SAGEConv(in_channels, hidden_channels)
        self.conv2 = SAGEConv(hidden_channels, out_channels)
    def forward(self, x, edge_index):
        x = self.conv1(x, edge_index)
        x = F.relu(x)
        x = F.dropout(x, training=self.training)
        x = self.conv2(x, edge_index)
        return F.log_softmax(x, dim=1)</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.522.1">
      Update the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.523.1">
       model
      </span>
     </strong>
     <span class="koboSpan" id="kobo.524.1">
      creation line to use the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.525.1">
       GraphSAGE
      </span>
     </strong>
     <span class="koboSpan" id="kobo.526.1">
      model instead
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.527.1">
       of
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.528.1">
        GCN
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.529.1">
       :
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.530.1">
# Create an instance of the GraphSAGE model
model = GraphSAGE(in_channels, hidden_channels, out_channels)</span></pre>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.531.1">
     With these changes, the code will now use the GraphSAGE model instead of GCN.
    </span>
    <span class="koboSpan" id="kobo.531.2">
     The rest of the code, including loading
    </span>
    <a id="_idIndexMarker305">
    </a>
    <span class="koboSpan" id="kobo.532.1">
     the dataset, training, and evaluation, remains
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.533.1">
      the same.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer252">
     <span class="koboSpan" id="kobo.534.1">
      <img alt="Figure 4.2 – GraphSAGE network leveraging neighborhood sampling" src="image/B22118_04_2.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.535.1">
     Figure 4.2 – GraphSAGE network leveraging neighborhood sampling
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.536.1">
     At times, it is a good idea to assign different weights to neighbors based on their relevance to a particular node.
    </span>
    <span class="koboSpan" id="kobo.536.2">
     We will now look at GATs, which borrow the concept of attention from
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.537.1">
      language models.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-83">
    <a id="_idTextAnchor086">
    </a>
    <span class="koboSpan" id="kobo.538.1">
     GATs
    </span>
   </h1>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.539.1">
      GATs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.540.1">
     are an extension
    </span>
    <a id="_idIndexMarker306">
    </a>
    <span class="koboSpan" id="kobo.541.1">
     of GCNs that incorporate an attention mechanism to assign different weights to neighboring nodes based on their relevance.
    </span>
    <span class="koboSpan" id="kobo.541.2">
     While GCNs apply a fixed aggregation function to combine the features of neighboring nodes, GATs allow for a more flexible and adaptive approach by learning the importance of each neighbor during the aggregation process.
    </span>
    <span class="koboSpan" id="kobo.541.3">
     The core of GATs is the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.542.1">
      attention network.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-84">
    <a id="_idTextAnchor087">
    </a>
    <span class="koboSpan" id="kobo.543.1">
     Attention networks
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.544.1">
     An
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.545.1">
      attention network
     </span>
    </strong>
    <span class="koboSpan" id="kobo.546.1">
     , often
    </span>
    <a id="_idIndexMarker307">
    </a>
    <span class="koboSpan" id="kobo.547.1">
     referred
    </span>
    <a id="_idIndexMarker308">
    </a>
    <span class="koboSpan" id="kobo.548.1">
     to as an
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.549.1">
      attention mechanism
     </span>
    </strong>
    <span class="koboSpan" id="kobo.550.1">
     or
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.551.1">
      attention model
     </span>
    </strong>
    <span class="koboSpan" id="kobo.552.1">
     , is a powerful
    </span>
    <a id="_idIndexMarker309">
    </a>
    <span class="koboSpan" id="kobo.553.1">
     concept in machine learning and artificial
    </span>
    <a id="_idIndexMarker310">
    </a>
    <span class="koboSpan" id="kobo.554.1">
     intelligence, particularly in the field of neural networks.
    </span>
    <span class="koboSpan" id="kobo.554.2">
     It’s inspired by how human attention works – focusing on specific parts of input data while
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.555.1">
      processing information.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.556.1">
     An attention mechanism allows the model to dynamically focus on different parts of the input data, assigning varying degrees of importance or attention to each part.
    </span>
    <span class="koboSpan" id="kobo.556.2">
     This enables the model to weigh
    </span>
    <a id="_idIndexMarker311">
    </a>
    <span class="koboSpan" id="kobo.557.1">
     the relevance of different inputs when making predictions
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.558.1">
      or decisions.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.559.1">
     Attention networks are commonly used in tasks involving sequential data, such as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.560.1">
      natural language processing
     </span>
    </strong>
    <span class="koboSpan" id="kobo.561.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.562.1">
      NLP
     </span>
    </strong>
    <span class="koboSpan" id="kobo.563.1">
     ) tasks such as
    </span>
    <a id="_idIndexMarker312">
    </a>
    <span class="koboSpan" id="kobo.564.1">
     machine translation, text summarization, and sentiment analysis.
    </span>
    <span class="koboSpan" id="kobo.564.2">
     In these tasks, the model needs to process sequences of words or tokens and understand the contextual relationships between them.
    </span>
    <span class="koboSpan" id="kobo.564.3">
     By using attention mechanisms, the model can effectively capture long-range dependencies and attend to relevant parts of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.565.1">
      input sequence.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.566.1">
     Here’s how an attention mechanism is leveraged in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.567.1">
      graph learning:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.568.1">
      In GATs, the attention mechanism is used to compute attention coefficients between a node and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.569.1">
       its neighbors.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.570.1">
      Attention coefficients represent the importance of each neighbor’s features to the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.571.1">
       target node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.572.1">
      The attention mechanism is typically implemented using an MLP or a single-layer
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.573.1">
       neural network.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.574.1">
      Attention coefficients are computed based on the learned weights of the attention mechanism and the features of the target node and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.575.1">
       its neighbors.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.576.1">
     Let’s look at how we can compute the attention coefficient in a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.577.1">
      graph setting.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-85">
    <a id="_idTextAnchor088">
    </a>
    <span class="koboSpan" id="kobo.578.1">
     Attention coefficients computation
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.579.1">
     For each node, the attention
    </span>
    <a id="_idIndexMarker313">
    </a>
    <span class="koboSpan" id="kobo.580.1">
     coefficients are computed for all its neighbors.
    </span>
    <span class="koboSpan" id="kobo.580.2">
     The attention coefficient between node
    </span>
    <span class="koboSpan" id="kobo.581.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/195.png" style="vertical-align:-0.012em;height:0.652em;width:0.272em"/>
    </span>
    <span class="koboSpan" id="kobo.582.1">
     and its neighbor
    </span>
    <span class="koboSpan" id="kobo.583.1">
     <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/201.png" style="vertical-align:-0.257em;height:0.904em;width:0.492em"/>
    </span>
    <span class="koboSpan" id="kobo.584.1">
     is calculated
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.585.1">
      as follows:
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.586.1">
     <img alt="&lt;math  display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;⋅&lt;/mo&gt;&lt;mfenced open=&quot;[&quot; close=&quot;]&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;∥&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;/mrow&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;⋅&lt;/mo&gt;&lt;mfenced open=&quot;[&quot; close=&quot;]&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/202.png" style="vertical-align:-1.164em;height:2.859em;width:15.664em"/>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.587.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mo&gt;∥&lt;/mml:mo&gt;&lt;/mml:math&gt;" src="image/203.png" style="vertical-align:-0.189em;height:0.878em;width:0.522em"/>
     </span>
     <span class="koboSpan" id="kobo.588.1">
      is the concatenation operation, and
     </span>
     <span class="koboSpan" id="kobo.589.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;L&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;mml:mi&gt;y&lt;/mml:mi&gt;&lt;mml:mi&gt;R&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt;L&lt;/mml:mi&gt;&lt;mml:mi&gt;U&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/204.png" style="vertical-align:-0.257em;height:0.968em;width:4.500em"/>
     </span>
     <span class="koboSpan" id="kobo.590.1">
      is the leaky ReLU
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.591.1">
       activation function.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.592.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/205.png" style="vertical-align:-0.340em;height:1.051em;width:0.625em"/>
     </span>
     <span class="koboSpan" id="kobo.593.1">
      and
     </span>
     <span class="koboSpan" id="kobo.594.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;j&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/206.png" style="vertical-align:-0.483em;height:1.194em;width:0.622em"/>
     </span>
     <span class="koboSpan" id="kobo.595.1">
      are the learned node embeddings for nodes
     </span>
     <span class="koboSpan" id="kobo.596.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/195.png" style="vertical-align:-0.012em;height:0.652em;width:0.272em"/>
     </span>
     <span class="koboSpan" id="kobo.597.1">
      and
     </span>
     <span class="koboSpan" id="kobo.598.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;j&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/208.png" style="vertical-align:-0.257em;height:0.904em;width:0.265em"/>
     </span>
     <span class="koboSpan" id="kobo.599.1">
      ,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.600.1">
       respectively.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.601.1">
      <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;W&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/142.png" style="vertical-align:-0.010em;height:0.658em;width:0.948em"/>
     </span>
     <span class="koboSpan" id="kobo.602.1">
      is a learnable attention weight vector that is shared across
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.603.1">
       all nodes.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.604.1">
     The attention coefficients
    </span>
    <a id="_idIndexMarker314">
    </a>
    <span class="koboSpan" id="kobo.605.1">
     are normalized using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.606.1">
      softmax
     </span>
    </strong>
    <span class="koboSpan" id="kobo.607.1">
     function to ensure they sum up to 1 for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.608.1">
      each node.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.609.1">
     Now that we understand how to compute attention coefficients, let’s see how these are utilized in the aggregation step of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.610.1">
      a GNN.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-86">
    <a id="_idTextAnchor089">
    </a>
    <span class="koboSpan" id="kobo.611.1">
     Aggregation of neighbor features
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.612.1">
     Once the attention coefficients
    </span>
    <a id="_idIndexMarker315">
    </a>
    <span class="koboSpan" id="kobo.613.1">
     are computed, the features of the neighboring nodes are aggregated using a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.614.1">
      weighted sum.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.615.1">
     The aggregated features for node
    </span>
    <span class="koboSpan" id="kobo.616.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/195.png" style="vertical-align:-0.012em;height:0.652em;width:0.272em"/>
    </span>
    <span class="koboSpan" id="kobo.617.1">
     are calculated
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.618.1">
      as follows:
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.619.1">
     <img alt="&lt;mml:math xmlns:mml=&quot;http://www.w3.org/1998/Math/MathML&quot; xmlns:m=&quot;http://schemas.openxmlformats.org/officeDocument/2006/math&quot; display=&quot;block&quot;&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;'&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt;σ&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:munderover&gt;&lt;mml:mo stretchy=&quot;false&quot;&gt;∑&lt;/mml:mo&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;j&lt;/mml:mi&gt;&lt;mml:mi&gt;ϵ&lt;/mml:mi&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:munderover&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;α&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;mml:mi&gt;j&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:mrow&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;*&lt;/mml:mi&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;j&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/211.png" style="vertical-align:-1.014em;height:2.055em;width:7.279em"/>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.620.1">
     Here,
    </span>
    <span class="koboSpan" id="kobo.621.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;σ&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/212.png" style="vertical-align:-0.012em;height:0.473em;width:0.720em"/>
    </span>
    <span class="koboSpan" id="kobo.622.1">
     is a non-linear activation function, such as ReLU.
    </span>
    <span class="koboSpan" id="kobo.622.2">
     The aggregated features
    </span>
    <span class="koboSpan" id="kobo.623.1">
     <img alt="&lt;mml:math xmlns:mml=&quot;http://www.w3.org/1998/Math/MathML&quot; xmlns:m=&quot;http://schemas.openxmlformats.org/officeDocument/2006/math&quot;&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;h&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;'&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;/mml:math&gt;" src="image/213.png" style="vertical-align:-0.340em;height:1.051em;width:0.883em"/>
    </span>
    <span class="koboSpan" id="kobo.624.1">
     represent the updated representation of node
    </span>
    <span class="koboSpan" id="kobo.625.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/214.png" style="vertical-align:-0.012em;height:0.652em;width:0.500em"/>
    </span>
    <span class="koboSpan" id="kobo.626.1">
     after considering the importance of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.627.1">
      its neighbors.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer268">
     <span class="koboSpan" id="kobo.628.1">
      <img alt="  Figure 4.3 – Multi-head attention (with K = 3 heads) by node 1 on its neighborhood" src="image/B22118_04_3.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.629.1">
     Figure 4.3 – Multi-head attention (with K = 3 heads) by node 1 on its neighborhood
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.630.1">
     To capture multiple aspects
    </span>
    <a id="_idIndexMarker316">
    </a>
    <span class="koboSpan" id="kobo.631.1">
     of the relationships between two nodes, we can leverage the concept of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.632.1">
      multi-head attention.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-87">
    <a id="_idTextAnchor090">
    </a>
    <span class="koboSpan" id="kobo.633.1">
     Multi-head attention
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.634.1">
     In GNNs,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.635.1">
      multi-head attention
     </span>
    </strong>
    <span class="koboSpan" id="kobo.636.1">
     can be applied to
    </span>
    <a id="_idIndexMarker317">
    </a>
    <span class="koboSpan" id="kobo.637.1">
     learn representations of nodes as an extension of vanilla attention.
    </span>
    <span class="koboSpan" id="kobo.637.2">
     Each “head” can be seen as a different perspective or attention mechanism applied to a
    </span>
    <a id="_idIndexMarker318">
    </a>
    <span class="koboSpan" id="kobo.638.1">
     node’s neighborhood.
    </span>
    <span class="koboSpan" id="kobo.638.2">
     By running multiple heads in parallel, the GNN can capture diverse aspects of the node’s local graph structure and feature space.
    </span>
    <span class="koboSpan" id="kobo.638.3">
     This allows the model to aggregate information from neighboring nodes in multiple ways, enhancing its ability to learn informative node representations that incorporate various patterns and relationships within
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.639.1">
      the graph.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.640.1">
     There are several notable aspects to keep in mind for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.641.1">
      multi-head attention:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.642.1">
      GATs can employ multi-head attention to capture different aspects of the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.643.1">
       node relationships.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.644.1">
      In multi-head attention, multiple attention mechanisms are used in parallel, each with its own set of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.645.1">
       learnable parameters.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.646.1">
      The output features from each attention head are concatenated or averaged to obtain the final
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.647.1">
       node representations.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.648.1">
      Multi-head attention allows the model to learn diverse patterns and capture different types of dependencies
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.649.1">
       between nodes.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.650.1">
     At times, a single attention layer
    </span>
    <a id="_idIndexMarker319">
    </a>
    <span class="koboSpan" id="kobo.651.1">
     might be unable to capture complex relationships in a graph.
    </span>
    <span class="koboSpan" id="kobo.651.2">
     Stacking multiple layers can help improve the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.652.1">
      learning space.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-88">
    <a id="_idTextAnchor091">
    </a>
    <span class="koboSpan" id="kobo.653.1">
     Stacking GAT layers
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.654.1">
     We can also use
    </span>
    <a id="_idIndexMarker320">
    </a>
    <span class="koboSpan" id="kobo.655.1">
     multiple GAT layers, similar
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.656.1">
      to GCNs:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.657.1">
      Like GCNs, GAT layers can be stacked to capture higher-order dependencies and learn more abstract representations of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.658.1">
       the graph.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.659.1">
      In each layer, the updated node representations from the previous layer serve as input to the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.660.1">
       next layer.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.661.1">
      The final node representations obtained after multiple GAT layers can be used for downstream tasks such as node classification or
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.662.1">
       graph classification.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.663.1">
     GATs seamlessly combine the advantages
    </span>
    <a id="_idIndexMarker321">
    </a>
    <span class="koboSpan" id="kobo.664.1">
     of an
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.665.1">
      adaptive receptive field
     </span>
    </strong>
    <span class="koboSpan" id="kobo.666.1">
     and an
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.667.1">
      interpretable attention mechanism
     </span>
    </strong>
    <span class="koboSpan" id="kobo.668.1">
     , making them powerful tools for processing graph-structured data.
    </span>
    <span class="koboSpan" id="kobo.668.2">
     The adaptive receptive
    </span>
    <a id="_idIndexMarker322">
    </a>
    <span class="koboSpan" id="kobo.669.1">
     field of GATs allows nodes to dynamically adjust their focus on relevant neighbors during information aggregation.
    </span>
    <span class="koboSpan" id="kobo.669.2">
     Importantly, GATs provide interpretable attention coefficients, enabling a clear understanding of the model’s decision-making process.
    </span>
    <span class="koboSpan" id="kobo.669.3">
     The transparency in attention weights allows for intuitive insights into which neighbors contribute significantly to a node’s representation, fostering interpretability and facilitating
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.670.1">
      model debugging.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.671.1">
     This combination of adaptability and interpretability makes GATs effective in capturing fine-grained local information while maintaining a global perspective, contributing to their success in various
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.672.1">
      graph-based tasks.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.673.1">
     Let’s look at the model code
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.674.1">
      for GAT:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.675.1">
class GAT(torch.nn.Module):
    def __init__(self, in_channels, hidden_channels,
                 out_channels, heads=8, dropout=0.6):
        super(GAT, self).__init__()
        self.conv1 = GATConv(
            in_channels, hidden_channels,
            heads=heads, dropout=dropout)
        self.conv2 = GATConv(
            hidden_channels * heads, out_channels,
            heads=1, dropout=dropout)
    def forward(self, x, edge_index):
        x = self.conv1(x, edge_index)
        x = F.elu(x)
        x = F.dropout(x, training=self.training)
        x = self.conv2(x, edge_index)
        return F.log_softmax(x, dim=1)</span></pre>
   <p>
    <span class="koboSpan" id="kobo.676.1">
     In this code, the GAT model class is defined using two
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.677.1">
      GATConv
     </span>
    </strong>
    <span class="koboSpan" id="kobo.678.1">
     layers.
    </span>
    <span class="koboSpan" id="kobo.678.2">
     The first layer has multiple attention heads
    </span>
    <a id="_idIndexMarker323">
    </a>
    <span class="koboSpan" id="kobo.679.1">
     specified by the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.680.1">
      heads
     </span>
    </strong>
    <span class="koboSpan" id="kobo.681.1">
     parameter, while the second layer has a single attention head.
    </span>
    <span class="koboSpan" id="kobo.681.2">
     The activation function used is the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.682.1">
      exponential linear unit
     </span>
    </strong>
    <span class="koboSpan" id="kobo.683.1">
     (
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.684.1">
       ELU
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.685.1">
      ) function.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.686.1">
     Note that in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.687.1">
      __init__
     </span>
    </strong>
    <span class="koboSpan" id="kobo.688.1">
     method of the
    </span>
    <a id="_idIndexMarker324">
    </a>
    <span class="koboSpan" id="kobo.689.1">
     GAT class, we multiply
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.690.1">
      hidden_channels
     </span>
    </strong>
    <span class="koboSpan" id="kobo.691.1">
     by
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.692.1">
      heads
     </span>
    </strong>
    <span class="koboSpan" id="kobo.693.1">
     when specifying the input channels for the second
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.694.1">
      GATConv
     </span>
    </strong>
    <span class="koboSpan" id="kobo.695.1">
     layer.
    </span>
    <span class="koboSpan" id="kobo.695.2">
     This is because the output of the first layer has
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.696.1">
      hidden_channels * heads dimensions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.697.1">
     due to the multiple
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.698.1">
      attention heads.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-89">
    <a id="_idTextAnchor092">
    </a>
    <span class="koboSpan" id="kobo.699.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.700.1">
     In this chapter, we provided a comprehensive overview of graph-based deep learning models, starting with the fundamental concept of message passing and then delving into specific GNN architectures such as GCNs, GraphSAGE,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.701.1">
      and GATs.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.702.1">
     Graph-based models rely on message passing, a key operation where nodes exchange information with neighbors to update their representations.
    </span>
    <span class="koboSpan" id="kobo.702.2">
     GCNs perform convolutions on graphs, aggregating neighboring node information to learn node representations.
    </span>
    <span class="koboSpan" id="kobo.702.3">
     GraphSAGE efficiently generates embeddings for large-scale graphs through neighborhood sampling.
    </span>
    <span class="koboSpan" id="kobo.702.4">
     GATs integrate attention mechanisms, enabling nodes to assign varying importance weights to neighbors during message passing.
    </span>
    <span class="koboSpan" id="kobo.702.5">
     These techniques enhance the capacity of graph-based models to capture complex relationships and patterns within
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.703.1">
      data structures.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.704.1">
     Building upon the foundational understanding of prevalent graph learning algorithms, we’ll explore the contemporary challenges confronting GNNs in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.705.1">
      upcoming chapter.
     </span>
    </span>
   </p>
  </div>
 </body></html>