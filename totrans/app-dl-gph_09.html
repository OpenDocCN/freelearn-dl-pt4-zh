<html><head></head><body>
  <div id="_idContainer335">
   <h1 class="chapter-number" id="_idParaDest-153">
    <a id="_idTextAnchor156">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     9
    </span>
   </h1>
   <h1 id="_idParaDest-154">
    <a id="_idTextAnchor157">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Building Recommendation Systems Using Graph Deep Learning
    </span>
   </h1>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.3.1">
      Recommendation systems
     </span>
    </strong>
    <span class="koboSpan" id="kobo.4.1">
     have
    </span>
    <a id="_idIndexMarker573">
    </a>
    <span class="koboSpan" id="kobo.5.1">
     become an integral part of our digital landscape, profoundly shaping how we interact with content, products, and services across various industries.
    </span>
    <span class="koboSpan" id="kobo.5.2">
     From e-commerce giants such as Amazon to streaming platforms such as Netflix, and social media networks such as Facebook, these systems play a crucial role in enhancing user experience, driving engagement, and boosting business outcomes.
    </span>
    <span class="koboSpan" id="kobo.5.3">
     As we delve into the world of building recommendation systems using graph deep learning, it’s essential to understand the evolution of these systems and the transformative potential of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.6.1">
      graph-based approaches.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.7.1">
     Traditionally, recommendation systems have relied on techniques such as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.8.1">
      collaborative filtering
     </span>
    </strong>
    <span class="koboSpan" id="kobo.9.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.10.1">
      CF
     </span>
    </strong>
    <span class="koboSpan" id="kobo.11.1">
     ), content-based
    </span>
    <a id="_idIndexMarker574">
    </a>
    <span class="koboSpan" id="kobo.12.1">
     filtering, and hybrid approaches.
    </span>
    <span class="koboSpan" id="kobo.12.2">
     While these methods have been successful to a certain extent, they often fall short in capturing the complex, interconnected nature of user-item interactions and the rich contextual information surrounding these interactions.
    </span>
    <span class="koboSpan" id="kobo.12.3">
     This is where graph deep learning enters the picture, offering a paradigm shift in how we approach
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.13.1">
      recommendation tasks.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.14.1">
     Graph-based methods in recommendation systems offer numerous advantages, including providing a rich multi-modal representation of diverse information types, the ability to capture higher-order relationships beyond direct user-item interactions, handle data sparsity effectively through information propagation, inductive learning capabilities for addressing cold start problems, enhanced interpretability through graph structure analysis, and flexibility in incorporating various types of side information and heterogeneous data.
    </span>
    <span class="koboSpan" id="kobo.14.2">
     Collectively, these features enable graph-based approaches to provide more comprehensive, accurate, and adaptable recommendations by leveraging the complex relationships and structures inherent in user-item interaction data and associated
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.15.1">
      contextual information.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.16.1">
     As we progress through this chapter, we’ll explore the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.17.1">
      following topics:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.18.1">
      Fundamentals of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.19.1">
       recommendation systems
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.20.1">
      Graph structures in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.21.1">
       recommendation systems
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.22.1">
      Graph-based
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.23.1">
       recommendation models
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.24.1">
      Training graph deep
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.25.1">
       learning models
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.26.1">
      Explainability in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.27.1">
       graph-based recommendations
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.28.1">
      The
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.29.1">
       cold
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.30.1">
        start problem
       </span>
      </strong>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-155">
    <a id="_idTextAnchor158">
    </a>
    <span class="koboSpan" id="kobo.31.1">
     Fundamentals of recommendation systems
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.32.1">
     Recommendation
    </span>
    <a id="_idIndexMarker575">
    </a>
    <span class="koboSpan" id="kobo.33.1">
     systems, also known as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.34.1">
      recommender systems
     </span>
    </strong>
    <span class="koboSpan" id="kobo.35.1">
     , are intelligent algorithms that are designed to predict and suggest items or content that users might find interesting or relevant.
    </span>
    <span class="koboSpan" id="kobo.35.2">
     These systems analyze patterns in user behavior, preferences, and item characteristics to generate personalized recommendations.
    </span>
    <span class="koboSpan" id="kobo.35.3">
     The primary purpose of recommendation systems is to enhance the user experience by providing relevant content, increasing user engagement and retention, driving sales and conversions in e-commerce platforms, facilitating content discovery in large item catalogs, and personalizing services across various domains.
    </span>
    <span class="koboSpan" id="kobo.35.4">
     Recommendation systems play a crucial role in addressing the information overload problem by filtering and prioritizing content based on user preferences
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.36.1">
      and behavior.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.37.1">
     Recommendation systems have become an integral part of our digital experiences, influencing our choices in various domains, such as e-commerce, entertainment, social media, and more.
    </span>
    <span class="koboSpan" id="kobo.37.2">
     This section delves into the core concepts, types, and evaluation metrics of recommendation systems, providing a solid foundation for understanding their role in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.38.1">
      modern applications.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.39.1">
     Let’s consider a streaming service that’s trying to build a recommendation system for its users.
    </span>
    <span class="koboSpan" id="kobo.39.2">
     The company has user-movie interaction data as well as metadata for every single movie available.
    </span>
    <span class="koboSpan" id="kobo.39.3">
     We’ll look at how we can leverage this data to provide better recommendations and increase the net promoter scores and watch times of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.40.1">
      users effectively.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-156">
    <a id="_idTextAnchor159">
    </a>
    <span class="koboSpan" id="kobo.41.1">
     Types of recommendation systems
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.42.1">
     There are three
    </span>
    <a id="_idIndexMarker576">
    </a>
    <span class="koboSpan" id="kobo.43.1">
     main types of recommendation systems, each with its unique approach to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.44.1">
      generating recommendations:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.45.1">
       CF
      </span>
     </strong>
     <span class="koboSpan" id="kobo.46.1">
      is based on the
     </span>
     <a id="_idIndexMarker577">
     </a>
     <span class="koboSpan" id="kobo.47.1">
      premise that users with similar preferences in the past will have similar preferences in the future.
     </span>
     <span class="koboSpan" id="kobo.47.2">
      It utilizes user-item interaction data to identify patterns and make predictions.
     </span>
     <span class="koboSpan" id="kobo.47.3">
      There are two main approaches: user-based CF, which recommends items liked by similar users, and item-based CF, which recommends items similar to those the user has liked in the past.
     </span>
     <span class="koboSpan" id="kobo.47.4">
      CF has the advantage of capturing complex user preferences and working well with sparse data.
     </span>
     <span class="koboSpan" id="kobo.47.5">
      However, it faces challenges such as the cold start problem for new users or items and scalability issues with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.48.1">
       large datasets.
      </span>
     </span>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.49.1">
       In our movie recommendation system, let’s consider a user, Alice, who has rated several movies highly, including
      </span>
      <em class="italic">
       <span class="koboSpan" id="kobo.50.1">
        The Shawshank Redemption
       </span>
      </em>
      <span class="koboSpan" id="kobo.51.1">
       (5 stars),
      </span>
      <em class="italic">
       <span class="koboSpan" id="kobo.52.1">
        Pulp Fiction
       </span>
      </em>
      <span class="koboSpan" id="kobo.53.1">
       (4 stars), and
      </span>
      <em class="italic">
       <span class="koboSpan" id="kobo.54.1">
        The Godfather
       </span>
      </em>
      <span class="koboSpan" id="kobo.55.1">
       (5 stars).
      </span>
      <span class="koboSpan" id="kobo.55.2">
       User-based CF would find users with similar rating patterns to Alice, such as Bob, who has rated these same movies similarly and gave a high rating to
      </span>
      <em class="italic">
       <span class="koboSpan" id="kobo.56.1">
        Inception
       </span>
      </em>
      <span class="koboSpan" id="kobo.57.1">
       .
      </span>
      <span class="koboSpan" id="kobo.57.2">
       So, the system might recommend
      </span>
      <em class="italic">
       <span class="koboSpan" id="kobo.58.1">
        Inception
       </span>
      </em>
      <span class="koboSpan" id="kobo.59.1">
       to Alice based on Bob’s high rating.
      </span>
      <span class="koboSpan" id="kobo.59.2">
       Item-based CF, on the other hand, would find movies similar to those Alice rated highly.
      </span>
      <span class="koboSpan" id="kobo.59.3">
       It might determine that users who liked
      </span>
      <em class="italic">
       <span class="koboSpan" id="kobo.60.1">
        The Shawshank Redemption
       </span>
      </em>
      <span class="koboSpan" id="kobo.61.1">
       also enjoyed
      </span>
      <em class="italic">
       <span class="koboSpan" id="kobo.62.1">
        The Green Mile
       </span>
      </em>
      <span class="koboSpan" id="kobo.63.1">
       , leading to a recommendation
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.64.1">
        for Alice.
       </span>
      </span>
     </p>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.65.1">
       Content-based filtering
      </span>
     </strong>
     <span class="koboSpan" id="kobo.66.1">
      recommends
     </span>
     <a id="_idIndexMarker578">
     </a>
     <span class="koboSpan" id="kobo.67.1">
      items based on their features and the user’s past preferences.
     </span>
     <span class="koboSpan" id="kobo.67.2">
      It builds a profile for each user and item based on their characteristics and uses similarity measures between user profiles and item features to generate recommendations.
     </span>
     <span class="koboSpan" id="kobo.67.3">
      This approach has the advantage of providing explanations for recommendations and working well for niche items.
     </span>
     <span class="koboSpan" id="kobo.67.4">
      However, it has limitations in expanding a user’s interests and requires rich item metadata.
     </span>
     <span class="koboSpan" id="kobo.67.5">
      In our movie example, we’d analyze the features of movies Alice likes, such as
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.68.1">
       The Shawshank Redemption
      </span>
     </em>
     <span class="koboSpan" id="kobo.69.1">
      (drama, directed by Frank Darabont, starring Tim Robbins and Morgan Freeman, released in 1994) and
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.70.1">
       The Godfather
      </span>
     </em>
     <span class="koboSpan" id="kobo.71.1">
      (crime/drama, directed by Francis Ford Coppola, starring Marlon Brando and Al Pacino, released in 1972).
     </span>
     <span class="koboSpan" id="kobo.71.2">
      In this case, the system might recommend other drama movies from the 1970s or 1990s, or
     </span>
     <a id="_idIndexMarker579">
     </a>
     <span class="koboSpan" id="kobo.72.1">
      films featuring Morgan Freeman or
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.73.1">
       Al Pacino.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.74.1">
       Hybrid systems
      </span>
     </strong>
     <span class="koboSpan" id="kobo.75.1">
      combine
     </span>
     <a id="_idIndexMarker580">
     </a>
     <span class="koboSpan" id="kobo.76.1">
      multiple recommendation approaches to leverage their strengths and mitigate weaknesses.
     </span>
     <span class="koboSpan" id="kobo.76.2">
      Common hybrid strategies include weighted approaches that combine scores from different recommenders, switching methods that choose between different recommenders based on the context, and feature combination techniques that use features from different sources as input to a single recommender.
     </span>
     <span class="koboSpan" id="kobo.76.3">
      Hybrid systems often provide better performance but come with increased complexity in terms of their design and implementation.
     </span>
     <span class="koboSpan" id="kobo.76.4">
      In our example, a hybrid approach might combine CF and content-based filtering.
     </span>
     <span class="koboSpan" id="kobo.76.5">
      It could use CF to find similar users to Alice and then filter those recommendations based on content features she prefers, such as favoring dramas or movies from
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.77.1">
       certain decades.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <em class="italic">
     <span class="koboSpan" id="kobo.78.1">
      Table 9.1
     </span>
    </em>
    <span class="koboSpan" id="kobo.79.1">
     provides a
    </span>
    <a id="_idIndexMarker581">
    </a>
    <span class="koboSpan" id="kobo.80.1">
     comparison of the different types, highlighting their key characteristics, advantages,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.81.1">
      and limitations:
     </span>
    </span>
   </p>
   <table class="No-Table-Style _idGenTablePara-1" id="table001-3">
    <colgroup>
     <col/>
     <col/>
     <col/>
     <col/>
    </colgroup>
    <thead>
     <tr class="No-Table-Style">
      <td class="No-Table-Style">
       <p>
        <span class="No-Break">
         <strong class="bold">
          <span class="koboSpan" id="kobo.82.1">
           Feature
          </span>
         </strong>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="No-Break">
         <strong class="bold">
          <span class="koboSpan" id="kobo.83.1">
           CF
          </span>
         </strong>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="No-Break">
         <strong class="bold">
          <span class="koboSpan" id="kobo.84.1">
           Content-based filtering
          </span>
         </strong>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="No-Break">
         <strong class="bold">
          <span class="koboSpan" id="kobo.85.1">
           Hybrid systems
          </span>
         </strong>
        </span>
       </p>
      </td>
     </tr>
    </thead>
    <tbody>
     <tr class="No-Table-Style">
      <td class="No-Table-Style">
       <p>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.86.1">
          Data required
         </span>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.87.1">
          User-item interactions
         </span>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="koboSpan" id="kobo.88.1">
         Item features and
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.89.1">
          user preferences
         </span>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="koboSpan" id="kobo.90.1">
         Both types
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.91.1">
          of data
         </span>
        </span>
       </p>
      </td>
     </tr>
     <tr class="No-Table-Style">
      <td class="No-Table-Style">
       <p>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.92.1">
          Strengths
         </span>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="koboSpan" id="kobo.93.1">
         - Captures user
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.94.1">
          preferences well
         </span>
        </span>
       </p>
       <p>
        <span class="koboSpan" id="kobo.95.1">
         - Discovers
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.96.1">
          new interests
         </span>
        </span>
       </p>
       <p>
        <span class="koboSpan" id="kobo.97.1">
         - Works with minimal
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.98.1">
          item information
         </span>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="koboSpan" id="kobo.99.1">
         - No cold start problem
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.100.1">
          for items
         </span>
        </span>
       </p>
       <p>
        <span class="koboSpan" id="kobo.101.1">
         - Can explain
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.102.1">
          recommendations
         </span>
        </span>
       </p>
       <p>
        <span class="koboSpan" id="kobo.103.1">
         - Good for
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.104.1">
          niche items
         </span>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="koboSpan" id="kobo.105.1">
         -
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.106.1">
          Better accuracy
         </span>
        </span>
       </p>
       <p>
        <span class="koboSpan" id="kobo.107.1">
         - Overcomes limitations of
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.108.1">
          individual methods
         </span>
        </span>
       </p>
       <p>
        <span class="koboSpan" id="kobo.109.1">
         -
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.110.1">
          More robust
         </span>
        </span>
       </p>
      </td>
     </tr>
     <tr class="No-Table-Style">
      <td class="No-Table-Style">
       <p>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.111.1">
          Weaknesses
         </span>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="koboSpan" id="kobo.112.1">
         - Cold
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.113.1">
          start problem
         </span>
        </span>
       </p>
       <p>
        <span class="koboSpan" id="kobo.114.1">
         -
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.115.1">
          Sparsity issues
         </span>
        </span>
       </p>
       <p>
        <span class="koboSpan" id="kobo.116.1">
         - Limited for
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.117.1">
          new items
         </span>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="koboSpan" id="kobo.118.1">
         -
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.119.1">
          Limited serendipity
         </span>
        </span>
       </p>
       <p>
        <span class="koboSpan" id="kobo.120.1">
         - Requires detailed
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.121.1">
          item features
         </span>
        </span>
       </p>
       <p>
        <span class="koboSpan" id="kobo.122.1">
         -
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.123.1">
          Over-specialization
         </span>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="koboSpan" id="kobo.124.1">
         -
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.125.1">
          Complex implementation
         </span>
        </span>
       </p>
       <p>
        <span class="koboSpan" id="kobo.126.1">
         -
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.127.1">
          Computationally expensive
         </span>
        </span>
       </p>
       <p>
        <span class="koboSpan" id="kobo.128.1">
         - Requires
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.129.1">
          more data
         </span>
        </span>
       </p>
      </td>
     </tr>
     <tr class="No-Table-Style">
      <td class="No-Table-Style">
       <p>
        <span class="koboSpan" id="kobo.130.1">
         Best
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.131.1">
          use cases
         </span>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="koboSpan" id="kobo.132.1">
         E-commerce,
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.133.1">
          social media
         </span>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="koboSpan" id="kobo.134.1">
         News articles,
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.135.1">
          specialized content
         </span>
        </span>
       </p>
      </td>
      <td class="No-Table-Style">
       <p>
        <span class="koboSpan" id="kobo.136.1">
         Large-scale platforms,
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.137.1">
          streaming services
         </span>
        </span>
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.138.1">
     Table 9.1 – Comparing different recommendation system types
    </span>
   </p>
   <h2 id="_idParaDest-157">
    <a id="_idTextAnchor160">
    </a>
    <span class="koboSpan" id="kobo.139.1">
     Key metrics and evaluation
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.140.1">
     Evaluating the
    </span>
    <a id="_idIndexMarker582">
    </a>
    <span class="koboSpan" id="kobo.141.1">
     performance of recommendation systems is crucial for understanding their effectiveness and guiding improvements.
    </span>
    <span class="koboSpan" id="kobo.141.2">
     Several metrics and evaluation techniques are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.142.1">
      commonly used.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.143.1">
     Accuracy metrics
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.144.1">
     This is how we define
    </span>
    <a id="_idIndexMarker583">
    </a>
    <span class="koboSpan" id="kobo.145.1">
     these commonly
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.146.1">
      used metrics:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.147.1">
       Precision
      </span>
     </strong>
     <span class="koboSpan" id="kobo.148.1">
      measures the proportion of relevant items among the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.149.1">
       recommended items:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.150.1">
        Precision = (Number of relevant recommendations) / (Total number
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.151.1">
         of recommendations)
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.152.1">
       Recall
      </span>
     </strong>
     <span class="koboSpan" id="kobo.153.1">
      measures the proportion of relevant items that were
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.154.1">
       successfully recommended:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.155.1">
        Recall = (Number of relevant recommendations) / (Total number of
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.156.1">
         relevant items)
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.157.1">
       F1 score
      </span>
     </strong>
     <span class="koboSpan" id="kobo.158.1">
      is the harmonic mean of precision and recall, providing a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.159.1">
       balanced measure:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.160.1">
        F1 = 2 × (Precision × Recall) / (Precision +
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.161.1">
         Recall)
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.162.1">
      The
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.163.1">
       mean average precision
      </span>
     </strong>
     <span class="koboSpan" id="kobo.164.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.165.1">
       MAP
      </span>
     </strong>
     <span class="koboSpan" id="kobo.166.1">
      ) calculates
     </span>
     <a id="_idIndexMarker584">
     </a>
     <span class="koboSpan" id="kobo.167.1">
      the mean of the average precision scores for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.168.1">
       each user:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.169.1">
        <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;M&lt;/mml:mi&gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;mml:mi&gt;P&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mfrac&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced open=&quot;|&quot; close=&quot;|&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;U&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfrac&gt;&lt;mml:mo&gt;⋅&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;Σ&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;mml:mi&gt;P&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/217.png" style="vertical-align:-0.291em;height:1.054em;width:8.787em"/>
       </span>
       <span class="koboSpan" id="kobo.170.1">
        , where we have
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.171.1">
         the following:
        </span>
       </span>
       <ul>
        <li>
         <span class="koboSpan" id="kobo.172.1">
          <img alt="&lt;mml:math  &gt;&lt;mml:mfenced open=&quot;|&quot; close=&quot;|&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;U&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/218.png" style="vertical-align:-0.065em;height:0.763em;width:1.460em"/>
         </span>
         <span class="koboSpan" id="kobo.173.1">
          is the number
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.174.1">
           of users.
          </span>
         </span>
        </li>
        <li>
         <span class="koboSpan" id="kobo.175.1">
          <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;mml:mi&gt;P&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/219.png" style="vertical-align:-0.133em;height:0.796em;width:2.442em"/>
         </span>
         <span class="koboSpan" id="kobo.176.1">
          is the average precision of the
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.177.1">
           user,
          </span>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.178.1">
           <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/220.png" style="vertical-align:-0.012em;height:0.460em;width:0.532em"/>
          </span>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.179.1">
           .
          </span>
         </span>
        </li>
        <li>
         <span class="koboSpan" id="kobo.180.1">
          <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;A&lt;/mml:mi&gt;&lt;mml:mi&gt;P&lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;Σ&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;P&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;mml:mo&gt;×&lt;/mml:mo&gt;&lt;mml:mi&gt;r&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/221.png" style="vertical-align:-0.112em;height:0.923em;width:8.985em"/>
         </span>
         <span class="koboSpan" id="kobo.181.1">
          / number of
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.182.1">
           relevant items
          </span>
         </span>
        </li>
        <li>
         <span class="koboSpan" id="kobo.183.1">
          <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;P&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/222.png" style="vertical-align:-0.062em;height:0.823em;width:1.715em"/>
         </span>
         <span class="koboSpan" id="kobo.184.1">
          is the precision at the
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.185.1">
           cutoff,
          </span>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.186.1">
           <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/223.png" style="vertical-align:-0.012em;height:0.723em;width:0.469em"/>
          </span>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.187.1">
           .
          </span>
         </span>
        </li>
        <li>
         <span class="koboSpan" id="kobo.188.1">
          <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;r&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/224.png" style="vertical-align:-0.062em;height:0.823em;width:2.141em"/>
         </span>
         <span class="koboSpan" id="kobo.189.1">
          is the indicator function (1 if item
         </span>
         <span class="koboSpan" id="kobo.190.1">
          <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/225.png" style="vertical-align:-0.012em;height:0.723em;width:0.696em"/>
         </span>
         <span class="koboSpan" id="kobo.191.1">
          is relevant,
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.192.1">
           0 otherwise).
          </span>
         </span>
        </li>
       </ul>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.193.1">
      The
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.194.1">
       normalized discounted cumulative gain
      </span>
     </strong>
     <span class="koboSpan" id="kobo.195.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.196.1">
       NDCG
      </span>
     </strong>
     <span class="koboSpan" id="kobo.197.1">
      ) measures
     </span>
     <a id="_idIndexMarker585">
     </a>
     <span class="koboSpan" id="kobo.198.1">
      the quality of ranking
     </span>
     <a id="_idIndexMarker586">
     </a>
     <span class="koboSpan" id="kobo.199.1">
      while taking into account the position of relevant items in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.200.1">
       recommendation list:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.201.1">
        <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/226.png" style="vertical-align:-0.044em;height:0.708em;width:9.743em"/>
       </span>
       <span class="koboSpan" id="kobo.202.1">
        , where we have
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.203.1">
         the following:
        </span>
       </span>
       <ul>
        <li>
         <span class="koboSpan" id="kobo.204.1">
          <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;D&lt;/mml:mi&gt;&lt;mml:mi&gt;C&lt;/mml:mi&gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;D&lt;/mml:mi&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;mml:mi&gt;s&lt;/mml:mi&gt;&lt;mml:mi&gt;c&lt;/mml:mi&gt;&lt;mml:mi&gt;o&lt;/mml:mi&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;mml:mi&gt;n&lt;/mml:mi&gt;&lt;mml:mi&gt;t&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi&gt;d&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;C&lt;/mml:mi&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;mml:mi&gt;m&lt;/mml:mi&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;t&lt;/mml:mi&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;mml:mi&gt;v&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;mml:mi&gt;a&lt;/mml:mi&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;mml:mi&gt;n&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;Σ&lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;r&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mo&gt;/&lt;/mml:mo&gt;&lt;mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;log&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;2&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;mml:mo&gt;⁡&lt;/mml:mo&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;mml:mo&gt;+&lt;/mml:mo&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:mrow&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/227.png" style="vertical-align:-0.390em;height:1.151em;width:22.902em"/>
         </span>
        </li>
        <li>
         <span class="koboSpan" id="kobo.205.1">
          <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/228.png" style="vertical-align:-0.015em;height:0.679em;width:2.611em"/>
         </span>
         <span class="koboSpan" id="kobo.206.1">
          is the ideal
         </span>
         <span class="koboSpan" id="kobo.207.1">
          <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/229.png" style="vertical-align:-0.015em;height:0.679em;width:2.276em"/>
         </span>
         <span class="koboSpan" id="kobo.208.1">
          (max
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.209.1">
           possible
          </span>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.210.1">
           <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;D&lt;/mml:mi&gt;&lt;mml:mi&gt;C&lt;/mml:mi&gt;&lt;mml:mi&gt;G&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/230.png" style="vertical-align:-0.015em;height:0.679em;width:2.049em"/>
          </span>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.211.1">
           ).
          </span>
         </span>
        </li>
        <li>
         <span class="koboSpan" id="kobo.212.1">
          <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;r&lt;/mml:mi&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;l&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/231.png" style="vertical-align:-0.340em;height:1.051em;width:1.235em"/>
         </span>
         <span class="koboSpan" id="kobo.213.1">
          is the relevance score of the item at
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.214.1">
           position
          </span>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.215.1">
           <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;mml:mo&gt;.&lt;/mml:mo&gt;&lt;/mml:math&gt;" src="image/232.png" style="vertical-align:-0.012em;height:0.652em;width:0.500em"/>
          </span>
         </span>
        </li>
        <li>
         <span class="koboSpan" id="kobo.216.1">
          <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/195.png" style="vertical-align:-0.012em;height:0.652em;width:0.272em"/>
         </span>
         <span class="koboSpan" id="kobo.217.1">
          is the position in the
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.218.1">
           ranked list.
          </span>
         </span>
        </li>
       </ul>
      </li>
     </ul>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.219.1">
     Assuming we recommend five movies to Alice, and she ends up liking three of them, the precision would be 3/5 = 0.6 or 60%.
    </span>
    <span class="koboSpan" id="kobo.219.2">
     If there were 10 movies in total that Alice would have liked, the recall would be 3/10 = 0.3 or 30%.
    </span>
    <span class="koboSpan" id="kobo.219.3">
     The F1 score, which provides a balanced measure, would be approximately 0.4 or 40% in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.220.1">
      this case.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.221.1">
     Error metrics
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.222.1">
     Error metrics often
    </span>
    <a id="_idIndexMarker587">
    </a>
    <span class="koboSpan" id="kobo.223.1">
     measure the average difference between predicted and actual ratings, such as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.224.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.225.1">
      The
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.226.1">
       mean absolute error
      </span>
     </strong>
     <span class="koboSpan" id="kobo.227.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.228.1">
       MAE
      </span>
     </strong>
     <span class="koboSpan" id="kobo.229.1">
      ) measures
     </span>
     <a id="_idIndexMarker588">
     </a>
     <span class="koboSpan" id="kobo.230.1">
      the average absolute difference between predicted and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.231.1">
       actual ratings:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.232.1">
        <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;Σ&lt;/mi&gt;&lt;mfenced open=&quot;|&quot; close=&quot;|&quot;&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;u&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/234.png" style="vertical-align:-0.290em;height:1.051em;width:12.735em"/>
       </span>
       <span class="koboSpan" id="kobo.233.1">
        , where
       </span>
       <span class="koboSpan" id="kobo.234.1">
        <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;n&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/216.png" style="vertical-align:-0.012em;height:0.460em;width:0.531em"/>
       </span>
       <span class="koboSpan" id="kobo.235.1">
        is the number
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.236.1">
         of predictions
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.237.1">
      The
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.238.1">
       root mean squared error
      </span>
     </strong>
     <span class="koboSpan" id="kobo.239.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.240.1">
       RMSE
      </span>
     </strong>
     <span class="koboSpan" id="kobo.241.1">
      ) is similar
     </span>
     <a id="_idIndexMarker589">
     </a>
     <span class="koboSpan" id="kobo.242.1">
      to MAE but penalizes large errors
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.243.1">
       more heavily:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.244.1">
        <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;R&lt;/mml:mi&gt;&lt;mml:mi&gt;M&lt;/mml:mi&gt;&lt;mml:mi&gt;S&lt;/mml:mi&gt;&lt;mml:mi&gt;E&lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mo&gt;√&lt;/mml:mo&gt;&lt;mml:mo&gt;(&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;Σ&lt;/mml:mi&gt;&lt;mml:mo&gt;(&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;a&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;c&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;t&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;u&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;a&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;l&lt;/mml:mi&gt;&lt;mml:mo&gt;-&lt;/mml:mo&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;p&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;r&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;e&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;d&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;i&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;c&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;t&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;e&lt;/mml:mi&gt;&lt;mml:mi mathvariant=&quot;normal&quot;&gt;d&lt;/mml:mi&gt;&lt;mml:msup&gt;&lt;mml:mrow&gt;&lt;mml:mo&gt;)&lt;/mml:mo&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;2&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:msup&gt;&lt;mml:mo&gt;/&lt;/mml:mo&gt;&lt;mml:mi&gt;n&lt;/mml:mi&gt;&lt;mml:mo&gt;)&lt;/mml:mo&gt;&lt;/mml:math&gt;" src="image/236.png" style="vertical-align:-0.503em;height:1.477em;width:15.731em"/>
       </span>
      </li>
     </ul>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.245.1">
     For example, if we predicted ratings for five movies and the average difference between our predictions and Alice’s actual ratings was 0.42 stars, this would be our MAE.
    </span>
    <span class="koboSpan" id="kobo.245.2">
     This suggests that, on
    </span>
    <a id="_idIndexMarker590">
    </a>
    <span class="koboSpan" id="kobo.246.1">
     average, our predictions are off by about
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.247.1">
      0.42 stars.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.248.1">
     Coverage, diversity, and serendipity
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.249.1">
     Coverage metrics
    </span>
    <a id="_idIndexMarker591">
    </a>
    <span class="koboSpan" id="kobo.250.1">
     assess
    </span>
    <a id="_idIndexMarker592">
    </a>
    <span class="koboSpan" id="kobo.251.1">
     the system’s
    </span>
    <a id="_idIndexMarker593">
    </a>
    <span class="koboSpan" id="kobo.252.1">
     ability to recommend a wide range of items.
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.253.1">
      Item coverage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.254.1">
     measures the percentage
    </span>
    <a id="_idIndexMarker594">
    </a>
    <span class="koboSpan" id="kobo.255.1">
     of items in the catalog that the system can recommend, while
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.256.1">
      user coverage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.257.1">
     indicates
    </span>
    <a id="_idIndexMarker595">
    </a>
    <span class="koboSpan" id="kobo.258.1">
     the percentage of users for whom the system can generate recommendations.
    </span>
    <span class="koboSpan" id="kobo.258.2">
     In our movie system, we might measure what percentage of the 3,000 movies in our catalog we’re able to recommend (item coverage) and what percentage of our 1,000 users receive recommendations (
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.259.1">
      user coverage).
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.260.1">
     Meanwhile, diversity metrics evaluate the variety (or dissimilarity) among recommended items, ensuring users receive a range of suggestions rather than similar ones.
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.261.1">
      Serendipity
     </span>
    </strong>
    <span class="koboSpan" id="kobo.262.1">
     , on the
    </span>
    <a id="_idIndexMarker596">
    </a>
    <span class="koboSpan" id="kobo.263.1">
     other hand, assesses the system’s ability to provide unexpected yet relevant recommendations, creating pleasant surprises for users.
    </span>
    <span class="koboSpan" id="kobo.263.2">
     It combines elements of unexpectedness and relevance, often measured through unexpectedness scores and relevance evaluations.
    </span>
    <span class="koboSpan" id="kobo.263.3">
     While related, diversity and serendipity are distinct: diverse recommendations may not always be serendipitous, and serendipitous recommendations often contribute to diversity but not
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.264.1">
      vice versa.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.265.1">
     These metrics are essential for creating a balanced recommendation system that offers varied, interesting, and delightfully unexpected suggestions to users (for more on this topic,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.266.1">
      see
     </span>
    </span>
    <a href="https://doi.org/10.1145/2926720">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.267.1">
       https://doi.org/10.1145/2926720
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.268.1">
      ).
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.269.1">
     A/B testing and user feedback
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.270.1">
     While offline
    </span>
    <a id="_idIndexMarker597">
    </a>
    <span class="koboSpan" id="kobo.271.1">
     metrics
    </span>
    <a id="_idIndexMarker598">
    </a>
    <span class="koboSpan" id="kobo.272.1">
     provide valuable insights, real-world performance is best evaluated through
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.273.1">
      A/B testing
     </span>
    </strong>
    <span class="koboSpan" id="kobo.274.1">
     and
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.275.1">
      user feedback
     </span>
    </strong>
    <span class="koboSpan" id="kobo.276.1">
     .
    </span>
    <span class="koboSpan" id="kobo.276.2">
     A/B testing involves comparing two versions
    </span>
    <a id="_idIndexMarker599">
    </a>
    <span class="koboSpan" id="kobo.277.1">
     of the
    </span>
    <a id="_idIndexMarker600">
    </a>
    <span class="koboSpan" id="kobo.278.1">
     recommendation system with real users and measuring key performance indicators such as click-through rate, conversion rate, or user engagement.
    </span>
    <span class="koboSpan" id="kobo.278.2">
     User feedback, both explicit (through ratings or surveys) and implicit (through clicks or purchase behavior), is crucial for continuously improving and validating the recommendation system.
    </span>
    <span class="koboSpan" id="kobo.278.3">
     Long-term user satisfaction, which is measured through user retention and engagement metrics, is also essential for assessing the impact of recommendations on user trust and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.279.1">
      platform loyalty.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.280.1">
     Evaluating recommendation systems requires a holistic approach that considers both offline metrics and real-world performance.
    </span>
    <span class="koboSpan" id="kobo.280.2">
     As recommendation systems become more sophisticated, especially with the integration of graph deep learning techniques, evaluation
    </span>
    <a id="_idIndexMarker601">
    </a>
    <span class="koboSpan" id="kobo.281.1">
     methods
    </span>
    <a id="_idIndexMarker602">
    </a>
    <span class="koboSpan" id="kobo.282.1">
     continue to evolve to capture the nuanced aspects of recommendation quality and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.283.1">
      user satisfaction.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-158">
    <a id="_idTextAnchor161">
    </a>
    <span class="koboSpan" id="kobo.284.1">
     Graph structures in recommendation systems
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.285.1">
     Graph structures
    </span>
    <a id="_idIndexMarker603">
    </a>
    <span class="koboSpan" id="kobo.286.1">
     have emerged as a powerful paradigm
    </span>
    <a id="_idIndexMarker604">
    </a>
    <span class="koboSpan" id="kobo.287.1">
     for modeling complex relationships in recommendation systems.
    </span>
    <span class="koboSpan" id="kobo.287.2">
     By representing users, items, and their interactions as nodes and edges in a graph, we can capture rich, multi-dimensional information that traditional matrix-based approaches
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.288.1">
      often miss.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-159">
    <a id="_idTextAnchor162">
    </a>
    <span class="koboSpan" id="kobo.289.1">
     User-item interaction graphs
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.290.1">
     The foundation of
    </span>
    <a id="_idIndexMarker605">
    </a>
    <span class="koboSpan" id="kobo.291.1">
     graph-based recommendation systems is the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.292.1">
      user-item interaction graph
     </span>
    </strong>
    <span class="koboSpan" id="kobo.293.1">
     .
    </span>
    <span class="koboSpan" id="kobo.293.2">
     In this
    </span>
    <a id="_idIndexMarker606">
    </a>
    <span class="koboSpan" id="kobo.294.1">
     structure, users and items are represented as
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.295.1">
      nodes
     </span>
    </em>
    <span class="koboSpan" id="kobo.296.1">
     , while interactions (such as ratings, views, or purchases) form
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.297.1">
      edges
     </span>
    </em>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.298.1">
      between them.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.299.1">
     For a movie recommendation system, the graph might look
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.300.1">
      like this:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.301.1">
       Nodes
      </span>
     </strong>
     <span class="koboSpan" id="kobo.302.1">
      : Users (U1, U2, U3…) and movies (M1,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.303.1">
       M2, M3…)
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.304.1">
       Edges
      </span>
     </strong>
     <span class="koboSpan" id="kobo.305.1">
      : Ratings or views (for example, U1 -&gt; M1 with a weight of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.306.1">
       4 stars)
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.307.1">
     This simple structure already allows for a more nuanced analysis than a traditional user-item matrix.
    </span>
    <span class="koboSpan" id="kobo.307.2">
     For example, we can easily identify
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.308.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.309.1">
      Popular movies (nodes with many
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.310.1">
       incoming edges)
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.311.1">
      Active users (nodes with many
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.312.1">
       outgoing edges)
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.313.1">
      Similar users or movies (nodes with similar
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.314.1">
       edge patterns)
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.315.1">
     Consider user U1 who has watched and rated movies M1 (4 stars), M2 (3 stars), and M3 (5 stars).
    </span>
    <span class="koboSpan" id="kobo.315.2">
     To recommend a new movie to U1, we can traverse the graph to find users with similar rating
    </span>
    <a id="_idIndexMarker607">
    </a>
    <span class="koboSpan" id="kobo.316.1">
     patterns
    </span>
    <a id="_idIndexMarker608">
    </a>
    <span class="koboSpan" id="kobo.317.1">
     and suggest movies they’ve enjoyed that U1 hasn’t
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.318.1">
      seen yet.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-160">
    <a id="_idTextAnchor163">
    </a>
    <span class="koboSpan" id="kobo.319.1">
     Incorporating side information
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.320.1">
     Real-world
    </span>
    <a id="_idIndexMarker609">
    </a>
    <span class="koboSpan" id="kobo.321.1">
     recommendation
    </span>
    <a id="_idIndexMarker610">
    </a>
    <span class="koboSpan" id="kobo.322.1">
     systems often have access to additional information beyond just user-item interactions.
    </span>
    <span class="koboSpan" id="kobo.322.2">
     Graph structures excel at incorporating this side information seamlessly.
    </span>
    <span class="koboSpan" id="kobo.322.3">
     For movie recommendations, we might enhance our graph with the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.323.1">
      following aspects:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.324.1">
        Movie attributes
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.325.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.326.1">
        Genres (action, comedy, drama, and
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.327.1">
         so on)
        </span>
       </span>
      </li>
      <li>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.328.1">
         Directors
        </span>
       </span>
      </li>
      <li>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.329.1">
         Actors
        </span>
       </span>
      </li>
      <li>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.330.1">
         Release year
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.331.1">
        User attributes
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.332.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.333.1">
         Age
        </span>
       </span>
      </li>
      <li>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.334.1">
         Gender
        </span>
       </span>
      </li>
      <li>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.335.1">
         Location
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.336.1">
        Social connections
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.337.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.338.1">
        Friend relationships
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.339.1">
         between users
        </span>
       </span>
      </li>
     </ul>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.340.1">
     These additional nodes and edges create a heterogeneous graph, where different types of nodes and relationships coexist.
    </span>
    <span class="koboSpan" id="kobo.340.2">
     This rich structure allows for more sophisticated recommendation algorithms.
    </span>
    <span class="koboSpan" id="kobo.340.3">
     Let’s expand on our previous example.
    </span>
    <span class="koboSpan" id="kobo.340.4">
     Now, movie M1 has
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.341.1">
      additional connections:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.342.1">
        Genre
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.343.1">
       : Action
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.344.1">
        Director
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.345.1">
       : D1
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.346.1">
       Actors
      </span>
     </strong>
     <span class="koboSpan" id="kobo.347.1">
      :
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.348.1">
       A1, A2
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.349.1">
     User U1 is connected to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.350.1">
      following aspects:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.351.1">
       Age
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.352.1">
        group
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.353.1">
       : 25-34
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.354.1">
       Location
      </span>
     </strong>
     <span class="koboSpan" id="kobo.355.1">
      :
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.356.1">
       New York
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.357.1">
     By traversing this enhanced graph, we can make more nuanced recommendations.
    </span>
    <span class="koboSpan" id="kobo.357.2">
     For instance, we might
    </span>
    <a id="_idIndexMarker611">
    </a>
    <span class="koboSpan" id="kobo.358.1">
     suggest
    </span>
    <a id="_idIndexMarker612">
    </a>
    <span class="koboSpan" id="kobo.359.1">
     an action movie directed by D1 that’s popular among U1’s age group in New York, even if it doesn’t have a direct connection to U1’s previously
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.360.1">
      watched movies.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-161">
    <a id="_idTextAnchor164">
    </a>
    <span class="koboSpan" id="kobo.361.1">
     Temporal graphs
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.362.1">
     Time is a crucial factor
    </span>
    <a id="_idIndexMarker613">
    </a>
    <span class="koboSpan" id="kobo.363.1">
     in recommendation systems, especially for domains such as movies, where preferences can change rapidly.
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.364.1">
      Temporal graphs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.365.1">
     incorporate
    </span>
    <a id="_idIndexMarker614">
    </a>
    <span class="koboSpan" id="kobo.366.1">
     time information into the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.367.1">
      graph structure.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.368.1">
     There are several ways to represent time in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.369.1">
      a graph:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.370.1">
       Time-stamped edges
      </span>
     </strong>
     <span class="koboSpan" id="kobo.371.1">
      : Each interaction edge includes
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.372.1">
       a timestamp
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.373.1">
       Time-based node splitting
      </span>
     </strong>
     <span class="koboSpan" id="kobo.374.1">
      : Create multiple nodes for the same user or item at different
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.375.1">
       time points
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.376.1">
       Dynamic graphs
      </span>
     </strong>
     <span class="koboSpan" id="kobo.377.1">
      : The graph structure itself evolves, with nodes and edges appearing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.378.1">
       or disappearing
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.379.1">
     For movie recommendations, a temporal graph can capture
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.380.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.381.1">
      Changes in user preferences
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.382.1">
       over time
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.383.1">
      The life cycle of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.384.1">
       movie popularity
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.385.1">
      Seasonal trends in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.386.1">
       viewing habits
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.387.1">
     Consider a user, U1, who watched mostly comedies in 2020 but shifted toward dramas in 2021.
    </span>
    <span class="koboSpan" id="kobo.387.2">
     A temporal graph would preserve this information, allowing the recommendation system to prioritize recent preferences while still considering
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.388.1">
      long-term patterns.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.389.1">
     We might represent this
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.390.1">
      as follows:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.391.1">
U1_2020 -&gt; M1 (Comedy, watched Jan 2020)
U1_2020 -&gt; M2 (Comedy, watched Jun 2020)
U1_2021 -&gt; M3 (Drama, watched Jan 2021)
U1_2021 -&gt; M4 (Drama, watched May 2021)</span></pre>
   <p>
    <span class="koboSpan" id="kobo.392.1">
     This structure
    </span>
    <a id="_idIndexMarker615">
    </a>
    <span class="koboSpan" id="kobo.393.1">
     enables sequential
    </span>
    <a id="_idIndexMarker616">
    </a>
    <span class="koboSpan" id="kobo.394.1">
     recommendation, where the system suggests the next movie based on the user’s recent viewing history and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.395.1">
      overall trends.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-162">
    <a id="_idTextAnchor165">
    </a>
    <span class="koboSpan" id="kobo.396.1">
     Multi-relational graphs
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.397.1">
     In complex
    </span>
    <a id="_idIndexMarker617">
    </a>
    <span class="koboSpan" id="kobo.398.1">
     domains such as movie
    </span>
    <a id="_idIndexMarker618">
    </a>
    <span class="koboSpan" id="kobo.399.1">
     recommendations, different types of relationships often coexist.
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.400.1">
      Multi-relational graphs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.401.1">
     allow us to represent these varied
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.402.1">
      connections explicitly.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.403.1">
     For movies, we might have
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.404.1">
      these relationships:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.405.1">
       User-movie
      </span>
     </strong>
     <span class="koboSpan" id="kobo.406.1">
      :
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.407.1">
       "rated"
      </span>
     </strong>
     <span class="koboSpan" id="kobo.408.1">
      ,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.409.1">
       "watched"
      </span>
     </strong>
     <span class="koboSpan" id="kobo.410.1">
      , and
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.411.1">
       "added
      </span>
     </strong>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.412.1">
        to wishlist"
       </span>
      </strong>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.413.1">
       User-user
      </span>
     </strong>
     <span class="koboSpan" id="kobo.414.1">
      :
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.415.1">
       "is friends with"
      </span>
     </strong>
     <span class="koboSpan" id="kobo.416.1">
      and
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.417.1">
       "has similar
      </span>
     </strong>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.418.1">
        taste to"
       </span>
      </strong>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.419.1">
       Movie-movie
      </span>
     </strong>
     <span class="koboSpan" id="kobo.420.1">
      :
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.421.1">
       "has same genre"
      </span>
     </strong>
     <span class="koboSpan" id="kobo.422.1">
      ,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.423.1">
       "has same director"
      </span>
     </strong>
     <span class="koboSpan" id="kobo.424.1">
      , and
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.425.1">
       "is
      </span>
     </strong>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.426.1">
        sequel to"
       </span>
      </strong>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.427.1">
     Each relationship can have its own semantics and importance in the recommendation process.
    </span>
    <span class="koboSpan" id="kobo.427.2">
     Here’s
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.428.1">
      an example:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.429.1">
U1 --("rated", 5)-&gt; M1
U1 --("is friends with")-&gt; U2
U2 --("rated", 4)-&gt; M2
M1 --("has same director")-&gt; M2</span></pre>
   <p>
    <span class="koboSpan" id="kobo.430.1">
     This multi-relational structure allows for sophisticated path-based recommendations.
    </span>
    <span class="koboSpan" id="kobo.430.2">
     For instance, we might recommend M2 to U1 because of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.431.1">
      following reasons:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.432.1">
      U1’s friend, U2, rated
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.433.1">
       it highly.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.434.1">
      It shares a director with M1, which
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.435.1">
       U1 loved.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.436.1">
     By leveraging these complex relationships, multi-relational graphs enable more contextual and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.437.1">
      explainable recommendations.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.438.1">
     Graph structures excel at capturing complex relationships, incorporating diverse information sources, and modeling temporal dynamics.
    </span>
    <span class="koboSpan" id="kobo.438.2">
     As we’ll see in subsequent sections, these rich
    </span>
    <a id="_idIndexMarker619">
    </a>
    <span class="koboSpan" id="kobo.439.1">
     graph structures
    </span>
    <a id="_idIndexMarker620">
    </a>
    <span class="koboSpan" id="kobo.440.1">
     form the foundation for sophisticated deep learning models that can generate highly personalized and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.441.1">
      accurate recommendations.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-163">
    <a id="_idTextAnchor166">
    </a>
    <span class="koboSpan" id="kobo.442.1">
     Graph-based recommendation models
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.443.1">
     Graph-based recommendation
    </span>
    <a id="_idIndexMarker621">
    </a>
    <span class="koboSpan" id="kobo.444.1">
     models have emerged as powerful tools for capturing complex relationships between users and items in recommendation systems.
    </span>
    <span class="koboSpan" id="kobo.444.2">
     These models leverage the rich structural information inherent in user-item interaction graphs to generate more accurate and personalized recommendations.
    </span>
    <span class="koboSpan" id="kobo.444.3">
     In this section, we’ll explore three major categories of graph-based recommendation models, starting with
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.445.1">
      matrix factorization
     </span>
    </strong>
    <span class="koboSpan" id="kobo.446.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.447.1">
      MF
     </span>
    </strong>
    <span class="koboSpan" id="kobo.448.1">
     ) with
    </span>
    <a id="_idIndexMarker622">
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.449.1">
      graph regularization.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-164">
    <a id="_idTextAnchor167">
    </a>
    <span class="koboSpan" id="kobo.450.1">
     MF with graph regularization
    </span>
   </h2>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.451.1">
      MF
     </span>
    </strong>
    <span class="koboSpan" id="kobo.452.1">
     is a fundamental
    </span>
    <a id="_idIndexMarker623">
    </a>
    <span class="koboSpan" id="kobo.453.1">
     technique
    </span>
    <a id="_idIndexMarker624">
    </a>
    <span class="koboSpan" id="kobo.454.1">
     in CF, and its
    </span>
    <a id="_idIndexMarker625">
    </a>
    <span class="koboSpan" id="kobo.455.1">
     integration with graph structures has led to significant improvements in recommendation quality.
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.456.1">
      Graph regularization
     </span>
    </strong>
    <span class="koboSpan" id="kobo.457.1">
     in MF models helps to incorporate the structural information of the user-item interaction graph into the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.458.1">
      learning process.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.459.1">
     The basic idea is to add a regularization term to the traditional MF objective function that encourages connected nodes in the graph to have similar latent representations.
    </span>
    <span class="koboSpan" id="kobo.459.2">
     This approach helps to capture the local structure of the user-item graph and can lead to more
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.460.1">
      accurate recommendations.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.461.1">
     For movie recommendations, consider a scenario where we have a user-item graph with users and movies as nodes, and ratings as edges.
    </span>
    <span class="koboSpan" id="kobo.461.2">
     The graph regularization term would encourage users who have rated similar movies to have similar latent factors, and movies that have been rated similarly to also have similar
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.462.1">
      latent factors.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.463.1">
     A typical objective function for MF with graph regularization might look
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.464.1">
      like this:
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.465.1">
     <img alt="&lt;math  display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;Σ&lt;/mi&gt;&lt;mrow&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;ϵ&lt;/mi&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;msubsup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;mrow&gt;&lt;mo&gt;∥&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;msubsup&gt;&lt;mo&gt;∥&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mo&gt;∥&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;msubsup&gt;&lt;mo&gt;∥&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;Σ&lt;/mi&gt;&lt;mrow&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;ϵ&lt;/mi&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;ℇ&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;∥&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo&gt;∥&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mi&gt;β&lt;/mi&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;Σ&lt;/mi&gt;&lt;mrow&gt;&lt;mfenced open=&quot;(&quot; close=&quot;)&quot;&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfenced&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;ϵ&lt;/mi&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;ℇ&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;mo&gt;∥&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mspace width=&quot;0.25em&quot; /&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo&gt;∥&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/237.png" style="vertical-align:-0.532em;height:1.307em;width:33.870em"/>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.466.1">
     Here,
    </span>
    <span class="koboSpan" id="kobo.467.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;p&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/238.png" style="vertical-align:-0.340em;height:0.858em;width:0.989em"/>
    </span>
    <span class="koboSpan" id="kobo.468.1">
     and
    </span>
    <span class="koboSpan" id="kobo.469.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;q&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/239.png" style="vertical-align:-0.340em;height:0.788em;width:0.861em"/>
    </span>
    <span class="koboSpan" id="kobo.470.1">
     are the latent factors for the user,
    </span>
    <span class="koboSpan" id="kobo.471.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/240.png" style="vertical-align:-0.012em;height:0.460em;width:0.759em"/>
    </span>
    <span class="koboSpan" id="kobo.472.1">
     , and the item,
    </span>
    <span class="koboSpan" id="kobo.473.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/241.png" style="vertical-align:-0.012em;height:0.652em;width:0.499em"/>
    </span>
    <span class="koboSpan" id="kobo.474.1">
     , respectively,
    </span>
    <span class="koboSpan" id="kobo.475.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;ℇ&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/242.png" style="vertical-align:-0.340em;height:1.015em;width:0.957em"/>
    </span>
    <span class="koboSpan" id="kobo.476.1">
     and
    </span>
    <span class="koboSpan" id="kobo.477.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;ℇ&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/243.png" style="vertical-align:-0.340em;height:1.015em;width:0.805em"/>
    </span>
    <span class="koboSpan" id="kobo.478.1">
     are the sets of edges in the user-user and item-item graphs, and
    </span>
    <span class="koboSpan" id="kobo.479.1">
     <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/244.png" style="vertical-align:-0.012em;height:0.460em;width:0.761em"/>
    </span>
    <span class="koboSpan" id="kobo.480.1">
     and
    </span>
    <span class="koboSpan" id="kobo.481.1">
     <img alt="&lt;math &gt;&lt;mrow&gt;&lt;mi&gt;β&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" src="image/245.png" style="vertical-align:-0.258em;height:0.969em;width:0.737em"/>
    </span>
    <span class="koboSpan" id="kobo.482.1">
     are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.483.1">
      regularization parameters.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.484.1">
     This approach has shown improved performance over traditional MF, especially in scenarios with
    </span>
    <a id="_idIndexMarker626">
    </a>
    <span class="koboSpan" id="kobo.485.1">
     sparse
    </span>
    <a id="_idIndexMarker627">
    </a>
    <span class="koboSpan" id="kobo.486.1">
     data, as it can leverage the
    </span>
    <a id="_idIndexMarker628">
    </a>
    <span class="koboSpan" id="kobo.487.1">
     graph structure to make better predictions for users or items with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.488.1">
      few interactions.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-165">
    <a id="_idTextAnchor168">
    </a>
    <span class="koboSpan" id="kobo.489.1">
     Graph neural network models
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.490.1">
     As we saw in
    </span>
    <a href="B22118_04.xhtml#_idTextAnchor078">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.491.1">
        Chapter 4
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.492.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.493.1">
      graph neural networks
     </span>
    </strong>
    <span class="koboSpan" id="kobo.494.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.495.1">
      GNNs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.496.1">
     ) have revolutionized the field of graph-based
    </span>
    <a id="_idIndexMarker629">
    </a>
    <span class="koboSpan" id="kobo.497.1">
     recommendations
    </span>
    <a id="_idIndexMarker630">
    </a>
    <span class="koboSpan" id="kobo.498.1">
     by enabling direct learning on graph-structured data.
    </span>
    <span class="koboSpan" id="kobo.498.2">
     The following models can capture high-order connectivity patterns and learn rich node representations that incorporate both node features and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.499.1">
      graph structure.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.500.1">
     PinSage
    </span>
   </h3>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.501.1">
      PinSage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.502.1">
     , developed
    </span>
    <a id="_idIndexMarker631">
    </a>
    <span class="koboSpan" id="kobo.503.1">
     by Pinterest, is a pioneering GNN
    </span>
    <a id="_idIndexMarker632">
    </a>
    <span class="koboSpan" id="kobo.504.1">
     model for large-scale recommendation systems.
    </span>
    <span class="koboSpan" id="kobo.504.2">
     It adapts the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.505.1">
      GraphSAGE
     </span>
    </strong>
    <span class="koboSpan" id="kobo.506.1">
     architecture to
    </span>
    <a id="_idIndexMarker633">
    </a>
    <span class="koboSpan" id="kobo.507.1">
     generate embeddings efficiently for nodes in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.508.1">
      web-scale graphs.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.509.1">
     In a movie recommendation context, PinSage could be used to generate embeddings for both users and movies.
    </span>
    <span class="koboSpan" id="kobo.509.2">
     The model would aggregate information from a node’s local neighborhood, capturing not just direct interactions but also higher-order relationships.
    </span>
    <span class="koboSpan" id="kobo.509.3">
     For example, it could identify that two users who haven’t watched the same movies might still have similar
    </span>
    <a id="_idIndexMarker634">
    </a>
    <span class="koboSpan" id="kobo.510.1">
     tastes if they’ve watched movies
    </span>
    <a id="_idIndexMarker635">
    </a>
    <span class="koboSpan" id="kobo.511.1">
     that are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.512.1">
      themselves similar.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.513.1">
     The key steps in PinSage are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.514.1">
      as follows:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.515.1">
       Neighborhood sampling
      </span>
     </strong>
     <span class="koboSpan" id="kobo.516.1">
      : For each node, sample a fixed number of neighbors to make computation feasible on
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.517.1">
       large graphs.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.518.1">
       Feature aggregation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.519.1">
      : Aggregate features from the sampled neighbors using learnable
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.520.1">
       aggregation functions.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.521.1">
       Embedding generation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.522.1">
      : Combine the aggregated neighborhood information with the node’s features to generate the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.523.1">
       final embedding.
      </span>
     </span>
    </li>
   </ol>
   <h3>
    <span class="koboSpan" id="kobo.524.1">
     Neural graph collaborative filtering
    </span>
   </h3>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.525.1">
      Neural graph collaborative filtering
     </span>
    </strong>
    <span class="koboSpan" id="kobo.526.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.527.1">
      NGCF
     </span>
    </strong>
    <span class="koboSpan" id="kobo.528.1">
     ) explicitly
    </span>
    <a id="_idIndexMarker636">
    </a>
    <span class="koboSpan" id="kobo.529.1">
     incorporates the user-item graph structure into the
    </span>
    <a id="_idIndexMarker637">
    </a>
    <span class="koboSpan" id="kobo.530.1">
     embedding learning process.
    </span>
    <span class="koboSpan" id="kobo.530.2">
     It propagates embeddings on the user-item interaction graph to capture
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.531.1">
      collaborative signals.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.532.1">
     For movie recommendations, NGCF would start with initial embeddings for users and movies and then update these embeddings iteratively by passing messages along the edges of the user-movie interaction graph.
    </span>
    <span class="koboSpan" id="kobo.532.2">
     This process allows the model to capture high-order connectivity between users
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.533.1">
      and movies.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.534.1">
     The embedding update process in NGCF can be described
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.535.1">
      as follows:
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.536.1">
     <img alt="&lt;mml:math   display=&quot;block&quot;&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;σ&lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;W&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;mml:mo&gt;-&lt;/mml:mo&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;+&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mrow&gt;&lt;mml:munderover&gt;&lt;mml:mo stretchy=&quot;false&quot;&gt;∑&lt;/mml:mo&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;mml:mi&gt;ϵ&lt;/mml:mi&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:munderover&gt;&lt;mml:mrow&gt;&lt;mml:mfrac&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:msqrt&gt;&lt;mml:mfenced open=&quot;|&quot; close=&quot;|&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;mml:mfenced open=&quot;|&quot; close=&quot;|&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:msqrt&gt;&lt;/mml:mrow&gt;&lt;/mml:mfrac&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;W&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;2&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;/mml:mrow&gt;&lt;/mml:mrow&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;mml:mo&gt;-&lt;/mml:mo&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:math&gt;" src="image/246.png" style="vertical-align:-1.014em;height:2.101em;width:16.722em"/>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.537.1">
     Here,
    </span>
    <span class="koboSpan" id="kobo.538.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;/mml:math&gt;" src="image/247.png" style="vertical-align:-0.340em;height:1.117em;width:1.153em"/>
    </span>
    <span class="koboSpan" id="kobo.539.1">
     is the embedding of the user,
    </span>
    <span class="koboSpan" id="kobo.540.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/248.png" style="vertical-align:-0.012em;height:0.460em;width:0.527em"/>
    </span>
    <span class="koboSpan" id="kobo.541.1">
     , at the
    </span>
    <span class="koboSpan" id="kobo.542.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/249.png" style="vertical-align:-0.012em;height:0.723em;width:0.465em"/>
    </span>
    <span class="koboSpan" id="kobo.543.1">
     th layer.
    </span>
    <span class="koboSpan" id="kobo.544.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:math&gt;" src="image/250.png" style="vertical-align:-0.340em;height:0.988em;width:0.952em"/>
    </span>
    <span class="koboSpan" id="kobo.545.1">
     is the set of items that are interacted with
    </span>
    <a id="_idIndexMarker638">
    </a>
    <span class="koboSpan" id="kobo.546.1">
     by the user,
    </span>
    <span class="koboSpan" id="kobo.547.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:math&gt;" src="image/220.png" style="vertical-align:-0.012em;height:0.460em;width:0.532em"/>
    </span>
    <span class="koboSpan" id="kobo.548.1">
     , and
    </span>
    <span class="koboSpan" id="kobo.549.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;W&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;K&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;/mml:math&gt;" src="image/252.png" style="vertical-align:-0.333em;height:1.073em;width:1.795em"/>
    </span>
    <span class="koboSpan" id="kobo.550.1">
     and
    </span>
    <span class="koboSpan" id="kobo.551.1">
     <img alt="&lt;mml:math  &gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;W&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;2&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;K&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;/mml:math&gt;" src="image/253.png" style="vertical-align:-0.333em;height:1.073em;width:1.795em"/>
    </span>
    <span class="koboSpan" id="kobo.552.1">
     are
    </span>
    <a id="_idIndexMarker639">
    </a>
    <span class="koboSpan" id="kobo.553.1">
     learnable
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.554.1">
      weight matrixes.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.555.1">
     LightGCN
    </span>
   </h3>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.556.1">
      LightGCN
     </span>
    </strong>
    <span class="koboSpan" id="kobo.557.1">
     simplifies the NGCF
    </span>
    <a id="_idIndexMarker640">
    </a>
    <span class="koboSpan" id="kobo.558.1">
     model by removing
    </span>
    <a id="_idIndexMarker641">
    </a>
    <span class="koboSpan" id="kobo.559.1">
     feature transformation and nonlinear activation, focusing solely on the most essential
    </span>
    <a id="_idIndexMarker642">
    </a>
    <span class="koboSpan" id="kobo.560.1">
     component of
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.561.1">
      graph convolutional networks
     </span>
    </strong>
    <span class="koboSpan" id="kobo.562.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.563.1">
      GCNs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.564.1">
     ) for CF:
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.565.1">
      neighborhood aggregation.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.566.1">
     In the context of movie recommendations, LightGCN would represent users and movies as nodes in a bipartite graph.
    </span>
    <span class="koboSpan" id="kobo.566.2">
     The model then performs multiple layers of neighborhood aggregation to capture high-order connectivity.
    </span>
    <span class="koboSpan" id="kobo.566.3">
     The final embeddings are a weighted sum of embeddings from
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.567.1">
      all layers.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.568.1">
     The embedding propagation rule in LightGCN is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.569.1">
      as follows:
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.570.1">
     <img alt="&lt;mml:math   display=&quot;block&quot;&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mo&gt;=&lt;/mml:mo&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mrow&gt;&lt;mml:munderover&gt;&lt;mml:mo stretchy=&quot;false&quot;&gt;∑&lt;/mml:mo&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;mml:mi&gt;ϵ&lt;/mml:mi&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt; &lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:munderover&gt;&lt;mml:mrow&gt;&lt;mml:mfrac&gt;&lt;mml:mrow&gt;&lt;mml:mn&gt;1&lt;/mml:mn&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:msqrt&gt;&lt;mml:mfenced open=&quot;|&quot; close=&quot;|&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;u&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;mml:mfenced open=&quot;|&quot; close=&quot;|&quot; separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:msub&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;N&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:msub&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:msqrt&gt;&lt;/mml:mrow&gt;&lt;/mml:mfrac&gt;&lt;mml:msubsup&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;e&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;i&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;mml:mrow&gt;&lt;mml:mfenced separators=&quot;|&quot;&gt;&lt;mml:mrow&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;/mml:mrow&gt;&lt;/mml:mfenced&gt;&lt;/mml:mrow&gt;&lt;/mml:msubsup&gt;&lt;/mml:mrow&gt;&lt;/mml:mrow&gt;&lt;/mml:math&gt;" src="image/254.png" style="vertical-align:-0.964em;height:2.005em;width:8.583em"/>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.571.1">
     The simplicity of LightGCN makes it computationally efficient while still achieving state-of-the-art performance on many
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.572.1">
      recommendation tasks.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-166">
    <a id="_idTextAnchor169">
    </a>
    <span class="koboSpan" id="kobo.573.1">
     Training graph deep learning models
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.574.1">
     Training graph
    </span>
    <a id="_idIndexMarker643">
    </a>
    <span class="koboSpan" id="kobo.575.1">
     deep learning models for recommendation systems is a complex process that requires various factors to be considered carefully.
    </span>
    <span class="koboSpan" id="kobo.575.2">
     In this section, we’ll provide a comprehensive guide to training
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.576.1">
      these models.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-167">
    <a id="_idTextAnchor170">
    </a>
    <span class="koboSpan" id="kobo.577.1">
     Data preprocessing
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.578.1">
     Effective data
    </span>
    <a id="_idIndexMarker644">
    </a>
    <span class="koboSpan" id="kobo.579.1">
     preprocessing is crucial for
    </span>
    <a id="_idIndexMarker645">
    </a>
    <span class="koboSpan" id="kobo.580.1">
     the success of graph-based recommendation models.
    </span>
    <span class="koboSpan" id="kobo.580.2">
     Let’s dive deeper into the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.581.1">
      steps involved.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.582.1">
     Building the interaction graph
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.583.1">
     Creating a high-quality
    </span>
    <a id="_idIndexMarker646">
    </a>
    <span class="koboSpan" id="kobo.584.1">
     interaction graph is the foundation of graph-based recommendation systems.
    </span>
    <span class="koboSpan" id="kobo.584.2">
     Let’s take
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.585.1">
      a look:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.586.1">
        Node creation
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.587.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.588.1">
        Assign unique identifiers to each user
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.589.1">
         and movie.
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.590.1">
        Create node attributes to store
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.591.1">
         relevant information.
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.592.1">
        Edge creation
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.593.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.594.1">
        Create edges based on
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.595.1">
         user-movie interactions.
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.596.1">
        Consider different types of interactions (for example, ratings, views,
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.597.1">
         and likes).
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.598.1">
        Edge weighting
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.599.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.600.1">
        Assign weights to edges based on
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.601.1">
         interaction strength.
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.602.1">
        Normalize weights to ensure consistency across different
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.603.1">
         interaction types.
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.604.1">
       Handling
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.605.1">
        temporal information
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.606.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.607.1">
        Incorporate the timestamps of interactions as
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.608.1">
         edge attributes.
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.609.1">
        Consider creating multiple edges for
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.610.1">
         repeated interactions.
        </span>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.611.1">
     Here’s some example pseudocode for building a more
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.612.1">
      detailed graph:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.613.1">
import networkx as nx
from datetime import datetime
def build_movie_graph(interactions):
    G = nx.Graph()
    for user_id, movie_id, rating, timestamp in interactions:
        # Add user node with type attribute
        user_node = f"user_{user_id}"
        G.add_node(user_node, type="user", 
                   last_active=timestamp)
        
        # Add movie node with type attribute
        movie_node = f"movie_{movie_id}"
        G.add_node(movie_node, type="movie")
        
        # Add or update edge
        if G.has_edge(user_node, movie_node):
            G[user_node][movie_node]['weight'] += 1
            G[user_node][movie_node]['last_interaction'] = timestamp
            G[user_node][movie_node]['ratings'].append(float(rating))
        else:
            G.add_edge(user_node, movie_node, 
                       weight=1, 
                       last_interaction=timestamp, 
                       ratings=[float(rating)])
    return G</span></pre>
   <p>
    <span class="koboSpan" id="kobo.614.1">
     The following function normalizes the edge weights in the graph to provide a relative measure of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.615.1">
      interaction
     </span>
    </span>
    <span class="No-Break">
     <a id="_idIndexMarker647">
     </a>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.616.1">
      strength:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.617.1">
def normalize_edge_weights(G):
    for edge in G.edges():
        ratings = G.edges[edge].get('ratings', [])
        if ratings:
            avg_rating = np.mean(ratings)
            # Store average rating:
            G.edges[edge]['rating'] = avg_rating
            # Normalize to [0,1]:
            G.edges[edge]['weight'] = avg_rating / 5.0  
        else:
            G.edges[edge]['rating'] = 0
            G.edges[edge]['weight'] = 0</span></pre>
   <h3>
    <span class="koboSpan" id="kobo.618.1">
     Feature engineering
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.619.1">
     You can enhance the graph
    </span>
    <a id="_idIndexMarker648">
    </a>
    <span class="koboSpan" id="kobo.620.1">
     with rich features to improve
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.621.1">
      model performance:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.622.1">
        User features
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.623.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.624.1">
        Demographic information, such as age, gender,
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.625.1">
         and location
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.626.1">
        Behavioral features, such as average rating, genre preferences, and
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.627.1">
         activity level
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.628.1">
        Derived features, such as user segments based on
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.629.1">
         viewing patterns
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.630.1">
        Movie features
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.631.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.632.1">
        Basic attributes, such as genre, release year,
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.633.1">
         and duration
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.634.1">
        Production details, such as director, actors, budget, and
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.635.1">
         production company
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.636.1">
        Performance metrics, such as box office revenue and
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.637.1">
         critic ratings
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.638.1">
        Derived features, such as popularity score and
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.639.1">
         genre embeddings
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.640.1">
        Temporal features
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.641.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.642.1">
        Time-based user features, such as viewing frequency and time since the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.643.1">
         last activity
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.644.1">
        Time-based movie features, such as the age of the movie and
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.645.1">
         seasonal popularity
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.646.1">
        Graph-based features
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.647.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.648.1">
        Node degree, such as the number of movies rated by a user or the number of ratings for
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.649.1">
         a movie
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.650.1">
        Centrality measures, such as PageRank and
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.651.1">
         betweenness centrality
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.652.1">
        Community detection – for example, assign community labels
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.653.1">
         to nodes
        </span>
       </span>
      </li>
     </ul>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.654.1">
     Here’s an example
    </span>
    <a id="_idIndexMarker649">
    </a>
    <span class="koboSpan" id="kobo.655.1">
     of advanced
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.656.1">
      feature engineering:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.657.1">
import numpy as np 
from sklearn.preprocessing import StandardScaler 
def engineer_user_features(G, user_data):
    user_features = {}
    for node, data in G.nodes(data=True):
        if data['type'] == 'user':
            user_id = node.split('_')[1]
            # Add check if user exists in user_data:
            if user_id in user_data:  
                user_info = user_data[user_id]
                # Basic features
                features = [
                    float(user_info['age']),  # Convert to float
                    float(user_info['gender_encoded']),
                    float(user_info['location_encoded']),
                ]
                
                # Behavioral features
                # Get ratings directly from edges
                ratings = [G[node][edge].get(
                    'rating', 0) for edge in G[node]]
                avg_rating = np.mean(ratings) if ratings else 0
                rating_count = G.degree(node)
                features.extend([avg_rating, float(rating_count)])
                
                # Add genre preferences
                genre_preferences = calculate_genre_preferences(
                    G, node)
                features.extend(genre_preferences)
                
                user_features[node] = np.array(
                    features, dtype=np.float32)
    
    return user_features</span></pre>
   <p>
    <span class="koboSpan" id="kobo.658.1">
     The following function calculates genre preferences for a given user.
    </span>
    <span class="koboSpan" id="kobo.658.2">
     This is used as part of the feature engineering
    </span>
    <a id="_idIndexMarker650">
    </a>
    <span class="koboSpan" id="kobo.659.1">
     process
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.660.1">
      outlined previously:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.661.1">
def calculate_genre_preferences(G, user_node):
    genre_counts = {genre: 0 for genre in GENRE_LIST}
    total_ratings = 0
    
    # Iterate through neighboring movie nodes
    for neighbor in G[user_node]:
        if neighbor.startswith('movie_'):
            movie_id = neighbor.split('_')[1]
            if movie_id in movie_data:
                genres = movie_data[movie_id]['genres']
                rating = G[user_node][neighbor]['rating']
                for genre in genres:
                    if genre in genre_counts:
                        genre_counts[genre] += rating
                total_ratings += 1
    
    # Normalize genre preferences
    genre_preferences = []
    for genre in GENRE_LIST:
        if total_ratings &gt; 0:
            genre_preferences.append(
                genre_counts[genre] / total_ratings)
        else:
            genre_preferences.append(0)
    
    return genre_preferences</span></pre>
   <h2 id="_idParaDest-168">
    <a id="_idTextAnchor171">
    </a>
    <span class="koboSpan" id="kobo.662.1">
     Model training techniques
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.663.1">
     Training graph deep
    </span>
    <a id="_idIndexMarker651">
    </a>
    <span class="koboSpan" id="kobo.664.1">
     learning models for recommendation systems involves several advanced techniques to improve performance
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.665.1">
      and efficiency.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.666.1">
     Loss functions
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.667.1">
     You can choose
    </span>
    <a id="_idIndexMarker652">
    </a>
    <span class="koboSpan" id="kobo.668.1">
     and combine
    </span>
    <a id="_idIndexMarker653">
    </a>
    <span class="koboSpan" id="kobo.669.1">
     appropriate
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.670.1">
      loss functions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.671.1">
     based on the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.672.1">
      recommendation task:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.673.1">
       Binary cross-entropy
      </span>
     </strong>
     <span class="koboSpan" id="kobo.674.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.675.1">
       BCE
      </span>
     </strong>
     <span class="koboSpan" id="kobo.676.1">
      ) can be
     </span>
     <a id="_idIndexMarker654">
     </a>
     <span class="koboSpan" id="kobo.677.1">
      used
     </span>
     <a id="_idIndexMarker655">
     </a>
     <span class="koboSpan" id="kobo.678.1">
      for
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.679.1">
        implicit
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.680.1">
       feedback:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.681.1">
def bce_loss(predictions, targets):
    return F.binary_cross_entropy_with_logits(
        predictions, targets)</span></pre>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.682.1">
       Mean squared error
      </span>
     </strong>
     <span class="koboSpan" id="kobo.683.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.684.1">
       MSE
      </span>
     </strong>
     <span class="koboSpan" id="kobo.685.1">
      ) can be
     </span>
     <a id="_idIndexMarker656">
     </a>
     <span class="koboSpan" id="kobo.686.1">
      employed for
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.687.1">
       explicit
      </span>
     </em>
     <span class="koboSpan" id="kobo.688.1">
      feedback (
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.689.1">
       rating prediction):
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.690.1">
def mse_loss(predictions, targets):
    return F.mse_loss(predictions, targets)</span></pre>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.691.1">
       Bayesian personalized ranking
      </span>
     </strong>
     <span class="koboSpan" id="kobo.692.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.693.1">
       BPR
      </span>
     </strong>
     <span class="koboSpan" id="kobo.694.1">
      )
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.695.1">
       loss
      </span>
     </strong>
     <span class="koboSpan" id="kobo.696.1">
      can be
     </span>
     <a id="_idIndexMarker657">
     </a>
     <span class="koboSpan" id="kobo.697.1">
      utilized for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.698.1">
       pairwise ranking:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.699.1">
def bpr_loss(pos_scores, neg_scores):
    return -F.logsigmoid(pos_scores - neg_scores).mean()</span></pre>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.700.1">
       Margin ranking loss
      </span>
     </strong>
     <span class="koboSpan" id="kobo.701.1">
      is another option for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.702.1">
       pairwise ranking:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.703.1">
def margin_ranking_loss(pos_scores, neg_scores, margin=0.5):
    return F.margin_ranking_loss(
        pos_scores, neg_scores,
        torch.ones_like(pos_scores), margin=margin)</span></pre>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.704.1">
       Combination of losses
      </span>
     </strong>
     <span class="koboSpan" id="kobo.705.1">
      can combine
     </span>
     <a id="_idIndexMarker658">
     </a>
     <span class="koboSpan" id="kobo.706.1">
      multiple loss functions for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.707.1">
       multi-task learning:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.708.1">
def combined_loss(pred_ratings, true_ratings, 
                  pos_scores, neg_scores, alpha=0.5):
# Convert inputs to floating point tensors if they aren't already
    pred_ratings = pred_ratings.float()
    true_ratings = true_ratings.float()
    pos_scores = pos_scores.float()
    neg_scores = neg_scores.float()
    
    rating_loss = mse_loss(pred_ratings, true_ratings)
    ranking_loss = bpr_loss(pos_scores, neg_scores)
    return alpha * rating_loss + (1 - alpha) * ranking_loss</span></pre>
    </li>
   </ul>
   <h3>
    <span class="koboSpan" id="kobo.709.1">
     Training loop
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.710.1">
     You can also implement an
    </span>
    <a id="_idIndexMarker659">
    </a>
    <span class="koboSpan" id="kobo.711.1">
     advanced
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.712.1">
      training loop
     </span>
    </strong>
    <span class="koboSpan" id="kobo.713.1">
     with various
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.714.1">
      optimization techniques:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.715.1">
       Gradient accumulation for larger effective batch sizes
      </span>
     </strong>
     <span class="koboSpan" id="kobo.716.1">
      : This technique allows for larger effective batch sizes by accumulating gradients over multiple batches before performing an
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.717.1">
       optimizer step:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.718.1">
# Inside the training loop
for batch_idx, batch in enumerate(generate_batches(train_graph)):
    # ... </span><span class="koboSpan" id="kobo.718.2">(model forward pass and loss calculation)
    # Gradient accumulation
    loss = loss / ACCUMULATION_STEPS
    loss.backward()
    if (batch_idx + 1) % ACCUMULATION_STEPS == 0:
        optimizer.step()
        optimizer.zero_grad()</span></pre>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.719.1">
       Learning rate scheduling
      </span>
     </strong>
     <span class="koboSpan" id="kobo.720.1">
      : The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.721.1">
       ReduceLROnPlateau
      </span>
     </strong>
     <span class="koboSpan" id="kobo.722.1">
      scheduler adjusts the learning rate based on the validation loss, reducing it when the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.723.1">
       loss plateaus:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.724.1">
scheduler = ReduceLROnPlateau(
    optimizer, mode='min', factor=0.5, patience=3
) 
# Inside the training loop 
scheduler.step(val_loss)</span></pre>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.725.1">
       Early stopping based on validation performance
      </span>
     </strong>
     <span class="koboSpan" id="kobo.726.1">
      : This technique stops training when
     </span>
     <a id="_idIndexMarker660">
     </a>
     <span class="koboSpan" id="kobo.727.1">
      the
     </span>
     <a id="_idIndexMarker661">
     </a>
     <span class="koboSpan" id="kobo.728.1">
      validation loss doesn’t improve for a specified number of epochs,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.729.1">
       preventing overfitting:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.730.1">
# Inside the training loop
if val_loss &lt; best_val_loss:
    best_val_loss = val_loss
    no_improve_count = 0
    torch.save(model.state_dict(), 'best_model.pth')
else:
    no_improve_count += 1
    if no_improve_count &gt;= patience:
        print(f"Early stopping after {epoch} epochs")
        break
# After training
model.load_state_dict(torch.load('best_model.pth'))</span></pre>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.731.1">
       Gradient clipping to prevent exploding gradients
      </span>
     </strong>
     <span class="koboSpan" id="kobo.732.1">
      : Gradient clipping prevents gradients
     </span>
     <a id="_idIndexMarker662">
     </a>
     <span class="koboSpan" id="kobo.733.1">
      from becoming too
     </span>
     <a id="_idIndexMarker663">
     </a>
     <span class="koboSpan" id="kobo.734.1">
      large, which can cause instability
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.735.1">
       during training:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.736.1">
# Inside the training loop, before optimizer step
torch.nn.utils.clip_grad_norm_(
    model.parameters(), max_norm=1.0)</span></pre>
    </li>
   </ul>
   <h1 id="_idParaDest-169">
    <a id="_idTextAnchor172">
    </a>
    <span class="koboSpan" id="kobo.737.1">
     Scalability and optimization
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.738.1">
     Handling large-scale
    </span>
    <a id="_idIndexMarker664">
    </a>
    <span class="koboSpan" id="kobo.739.1">
     graphs requires advanced
    </span>
    <a id="_idIndexMarker665">
    </a>
    <span class="koboSpan" id="kobo.740.1">
     techniques for
    </span>
    <a id="_idIndexMarker666">
    </a>
    <span class="koboSpan" id="kobo.741.1">
     efficient training and inference.
    </span>
    <span class="koboSpan" id="kobo.741.2">
     We covered the challenge of scalability in
    </span>
    <a href="B22118_05.xhtml#_idTextAnchor093">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.742.1">
        Chapter 5
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.743.1">
     ; here, we’ll look at practical examples of techniques that can help us address
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.744.1">
      this issue.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-170">
    <a id="_idTextAnchor173">
    </a>
    <span class="koboSpan" id="kobo.745.1">
     Mini-batch training with neighborhood sampling
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.746.1">
     Instead of
    </span>
    <a id="_idIndexMarker667">
    </a>
    <span class="koboSpan" id="kobo.747.1">
     processing
    </span>
    <a id="_idIndexMarker668">
    </a>
    <span class="koboSpan" id="kobo.748.1">
     the entire graph, we
    </span>
    <a id="_idIndexMarker669">
    </a>
    <span class="koboSpan" id="kobo.749.1">
     can
    </span>
    <a id="_idIndexMarker670">
    </a>
    <span class="koboSpan" id="kobo.750.1">
     use
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.751.1">
      mini-batch training
     </span>
    </strong>
    <span class="koboSpan" id="kobo.752.1">
     with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.753.1">
      neighborhood sampling:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.754.1">
      Sample a subset of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.755.1">
       user nodes:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.756.1">
def create_mini_batch(G, batch_size, n_pos=5, n_neg=5, 
                      n_neighbors=10, n_hops=2):
    # Get all user nodes
    all_user_nodes = [n for n in G.nodes() if 
                      n.startswith('user_')]
    if not all_user_nodes:
        raise ValueError("No user nodes found in graph")
    
    # Randomly select users
    user_nodes = random.sample(
        all_user_nodes, 
        min(batch_size, len(all_user_nodes))
    )
    # Create subgraph
    subgraph = G.subgraph(user_nodes).copy()</span></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.757.1">
       This step randomly selects a subset of user nodes to form
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.758.1">
        the mini-batch.
       </span>
      </span>
     </p>
    </li>
    <li>
     <span class="koboSpan" id="kobo.759.1">
      For each user, sample a fixed number of positive and negative movie interactions.
     </span>
     <span class="koboSpan" id="kobo.759.2">
      Here, we sample positive movie interactions from the user’s neighbors and negative interactions from movies the user hasn’t
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.760.1">
       interacted with:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.761.1">
    # Sample positive and negative movies
    pos_movies = []
    neg_movies = []
    all_movies = [n for n in G.nodes() if 
                  n.startswith('movie_')]
    
    for user in user_nodes:
        user_movies = [n for n in G[user] if 
                       n.startswith('movie_')]
        pos_sample = random.sample(
            user_movies, min(n_pos, len(user_movies))
        ) if user_movies else []
        available_neg = list(set(all_movies) - 
                             set(user_movies))
        neg_sample = random.sample(available_neg, min(
            n_neg, len(available_neg))
        ) if available_neg else []
        
        pos_movies.extend(pos_sample)
        neg_movies.extend(neg_sample)
    
    return subgraph, user_nodes, pos_movies, neg_movies</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.762.1">
      Perform
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.763.1">
       multi-hop neighborhood sampling
      </span>
     </strong>
     <span class="koboSpan" id="kobo.764.1">
      to create a subgraph containing the relevant nodes
     </span>
     <a id="_idIndexMarker671">
     </a>
     <span class="koboSpan" id="kobo.765.1">
      and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.766.1">
       their
      </span>
     </span>
     <span class="No-Break">
      <a id="_idIndexMarker672">
      </a>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.767.1">
       neighbors:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.768.1">
def sample_neighbors(graph, nodes, n_neighbors, n_hops):
    sampled_nodes = set(nodes)
    for _ in range(n_hops):
        new_nodes = set()
        for node in sampled_nodes:
            neighbors = list(graph.neighbors(node))
            sampled = random.sample(
                neighbors, min(n_neighbors, len(neighbors))
            )
            new_nodes.update(sampled)
        sampled_nodes.update(new_nodes)
    return list(sampled_nodes)
    # Inside create_mini_batch function 
    all_nodes = user_nodes + pos_movies + neg_movies 
    sampled_nodes = sample_neighbors(
        graph, all_nodes, n_neighbors, n_hops)</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.769.1">
      Finally, we create the subgraph and conduct message passing within the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.770.1">
       sampled subgraph:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.771.1">
subgraph = graph.subgraph(sampled_nodes)
return subgraph, user_nodes, pos_movies, neg_movies</span></pre>
    </li>
   </ol>
   <h2 id="_idParaDest-171">
    <a id="_idTextAnchor174">
    </a>
    <span class="koboSpan" id="kobo.772.1">
     Distributed training
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.773.1">
     For extremely large
    </span>
    <a id="_idIndexMarker673">
    </a>
    <span class="koboSpan" id="kobo.774.1">
     graphs, you can
    </span>
    <a id="_idIndexMarker674">
    </a>
    <span class="koboSpan" id="kobo.775.1">
     implement
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.776.1">
       distributed training
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.777.1">
      :
     </span>
    </span>
   </p>
   <ol>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.778.1">
       Graph partitioning
      </span>
     </strong>
     <span class="koboSpan" id="kobo.779.1">
      : Divide the graph across multiple machines to enable
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.780.1">
       distributed processing:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.781.1">
def partition_graph(graph, rank, world_size):
    # Implement graph partitioning logic here
    # This is a placeholder function
    num_nodes = graph.number_of_nodes()
    nodes_per_partition = num_nodes // world_size
    start_node = rank * nodes_per_partition
    end_node = start_node + nodes_per_partition if rank &lt; \
        world_size - 1 else num_nodes
    local_nodes = list(graph.nodes())[start_node:end_node]
    return graph.subgraph(local_nodes)
# Usage in distributed_train function
local_graph = partition_graph(graph, rank, world_size)</span></pre>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.782.1">
       Distributed message passing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.783.1">
      : Implement efficient communication protocols for distributed message passing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.784.1">
       across machines:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.785.1">
import torch.distributed as dist
def distributed_message_passing(local_graph, node_features):
    # Perform local message passing
    local_output = local_message_passing(
        local_graph, node_features)
    # Gather results from all processes
    gathered_outputs = [torch.zeros_like(local_output) for _ in
                        range(dist.get_world_size())]
    dist.all_gather(gathered_outputs, local_output)
    # Combine gathered results
    global_output = torch.cat(gathered_outputs, dim=0)
    return global_output
# Usage in model forward pass
def forward(self, graph, node_features):
    # ... </span><span class="koboSpan" id="kobo.785.2">other layers
    node_features = distributed_message_passing(
        graph, node_features)
    # ... </span><span class="koboSpan" id="kobo.785.3">remaining layers</span></pre>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.786.1">
       Parameter server architecture
      </span>
     </strong>
     <span class="koboSpan" id="kobo.787.1">
      : Use
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.788.1">
       DistributedDataParallel
      </span>
     </strong>
     <span class="koboSpan" id="kobo.789.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.790.1">
       DDP
      </span>
     </strong>
     <span class="koboSpan" id="kobo.791.1">
      ) to centralize
     </span>
     <a id="_idIndexMarker675">
     </a>
     <span class="koboSpan" id="kobo.792.1">
      model
     </span>
     <a id="_idIndexMarker676">
     </a>
     <span class="koboSpan" id="kobo.793.1">
      parameter
     </span>
     <a id="_idIndexMarker677">
     </a>
     <span class="koboSpan" id="kobo.794.1">
      updates across
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.795.1">
       all processes:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.796.1">
from torch.nn.parallel import DistributedDataParallel as DDP
def distributed_train(rank, world_size, graph):
    setup(rank, world_size)
    # Create model and move it to GPU with id rank
    model = GraphRecommender(...).to(rank)
    model = DDP(model, device_ids=[rank])
    optimizer = optim.Adam(model.parameters(), lr=0.001)
    # ... </span><span class="koboSpan" id="kobo.796.2">training loop
    cleanup()</span></pre>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.797.1">
     By implementing all the strategies outlined in this section, such as efficient graph construction, comprehensive feature engineering, sophisticated loss functions, and scalable training
    </span>
    <a id="_idIndexMarker678">
    </a>
    <span class="koboSpan" id="kobo.798.1">
     methods, you can develop powerful and effective graph-based
    </span>
    <a id="_idIndexMarker679">
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.799.1">
      recommendation systems.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-172">
    <a id="_idTextAnchor175">
    </a>
    <span class="koboSpan" id="kobo.800.1">
     Explainability in graph-based recommendations
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.801.1">
     As recommendation systems
    </span>
    <a id="_idIndexMarker680">
    </a>
    <span class="koboSpan" id="kobo.802.1">
     become more sophisticated, the need for
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.803.1">
      explainable AI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.804.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.805.1">
      XAI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.806.1">
     ) in these
    </span>
    <a id="_idIndexMarker681">
    </a>
    <span class="koboSpan" id="kobo.807.1">
     systems grows.
    </span>
    <span class="koboSpan" id="kobo.807.2">
     Graph-based models offer unique opportunities for enhancing the explainability
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.808.1">
      of recommendations.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-173">
    <a id="_idTextAnchor176">
    </a>
    <span class="koboSpan" id="kobo.809.1">
     Attention mechanisms for interpretability
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.810.1">
     As we saw in
    </span>
    <a href="B22118_04.xhtml#_idTextAnchor078">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.811.1">
        Chapter 4
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.812.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.813.1">
      graph attention networks
     </span>
    </strong>
    <span class="koboSpan" id="kobo.814.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.815.1">
      GATs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.816.1">
     ) can be
    </span>
    <a id="_idIndexMarker682">
    </a>
    <span class="koboSpan" id="kobo.817.1">
     leveraged
    </span>
    <a id="_idIndexMarker683">
    </a>
    <span class="koboSpan" id="kobo.818.1">
     to provide insights into which nodes or features contribute most to a recommendation.
    </span>
    <span class="koboSpan" id="kobo.818.2">
     For movie recommendations, this could reveal which actors, directors, or genres have the most significant influence on a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.819.1">
      user’s preferences.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.820.1">
     Consider a user who frequently watches action movies starring Tom Cruise.
    </span>
    <span class="koboSpan" id="kobo.820.2">
     The attention mechanism might highlight that the presence of Tom Cruise in a movie’s cast graph node has a higher
    </span>
    <a id="_idIndexMarker684">
    </a>
    <span class="koboSpan" id="kobo.821.1">
     weight in the recommendation process for this user compared to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.822.1">
      other factors.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-174">
    <a id="_idTextAnchor177">
    </a>
    <span class="koboSpan" id="kobo.823.1">
     Path-based explanations
    </span>
   </h2>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.824.1">
      Metapath-based models
     </span>
    </strong>
    <span class="koboSpan" id="kobo.825.1">
     can offer
    </span>
    <a id="_idIndexMarker685">
    </a>
    <span class="koboSpan" id="kobo.826.1">
     intuitive
    </span>
    <a id="_idIndexMarker686">
    </a>
    <span class="koboSpan" id="kobo.827.1">
     explanations
    </span>
    <a id="_idIndexMarker687">
    </a>
    <span class="koboSpan" id="kobo.828.1">
     by showing the reasoning path that led to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.829.1">
      a recommendation.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.830.1">
     For example, a movie recommendation might be explained as follows:
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.831.1">
      We recommended “Inception” because you enjoyed “The Dark Knight” (same director: Christopher Nolan) and “Interstellar” (similar genre:
     </span>
    </em>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.832.1">
       sci-fi thriller).
      </span>
     </em>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.833.1">
     One of the major challenges that businesses face is a lack of data.
    </span>
    <span class="koboSpan" id="kobo.833.2">
     A new product might not have enough customer data to build these sophisticated recommendation models.
    </span>
    <span class="koboSpan" id="kobo.833.3">
     This challenge is called the cold start problem, and we’re going to look into how we can leverage graph algorithms to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.834.1">
      solve it.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-175">
    <a id="_idTextAnchor178">
    </a>
    <span class="koboSpan" id="kobo.835.1">
     The cold start problem
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.836.1">
     The cold start problem in
    </span>
    <a id="_idIndexMarker688">
    </a>
    <span class="koboSpan" id="kobo.837.1">
     recommendation systems refers to the challenge of making accurate recommendations for new users or new items that have little to no interaction data.
    </span>
    <span class="koboSpan" id="kobo.837.2">
     In movie recommendation systems, this occurs when a new user joins the platform and has no viewing history or when a new movie is released and has no user ratings
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.838.1">
      or interactions.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.839.1">
     The cold start problem is particularly challenging in movie recommendation systems, especially for new users or newly
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.840.1">
      released movies.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-176">
    <a id="_idTextAnchor179">
    </a>
    <span class="koboSpan" id="kobo.841.1">
     Graph embedding transfer
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.842.1">
     One solution
    </span>
    <a id="_idIndexMarker689">
    </a>
    <span class="koboSpan" id="kobo.843.1">
     to the
    </span>
    <a id="_idIndexMarker690">
    </a>
    <span class="koboSpan" id="kobo.844.1">
     cold start problem is
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.845.1">
      graph embedding transfer
     </span>
    </strong>
    <span class="koboSpan" id="kobo.846.1">
     , a technique that’s used to initialize representations for new nodes (movies or users) in a recommendation graph when there’s no interaction data available.
    </span>
    <span class="koboSpan" id="kobo.846.2">
     Here’s a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.847.1">
      general description:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.848.1">
      For new items (for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.849.1">
       example, movies):
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.850.1">
        Identify similar existing items based on metadata or
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.851.1">
         content features.
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.852.1">
        Use the embeddings of these similar items to initialize the embedding of the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.853.1">
         new item.
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.854.1">
        This gives the new item a starting point in the embedding space that reflects its
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.855.1">
         likely characteristics.
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.856.1">
      For
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.857.1">
       new users:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.858.1">
        Use available demographic or preference information to find similar
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.859.1">
         existing users.
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.860.1">
        Initialize the new user’s embedding based on these similar
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.861.1">
         users’ embeddings.
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.862.1">
        As the new user interacts with the system, their embedding can
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.863.1">
         be fine-tuned.
        </span>
       </span>
      </li>
     </ul>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.864.1">
     For example, when
    </span>
    <a id="_idIndexMarker691">
    </a>
    <span class="koboSpan" id="kobo.865.1">
     a new superhero movie is
    </span>
    <a id="_idIndexMarker692">
    </a>
    <span class="koboSpan" id="kobo.866.1">
     released, we can initialize its embedding by averaging the embeddings of other superhero movies in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.867.1">
      the graph:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.868.1">
def initialize_new_movie(movie_id, similar_movies, movie_embeddings):
    if not similar_movies:
        return np.zeros(next(iter(movie_embeddings.values())).shape)
    
    similar_embeddings = [
        movie_embeddings[m] for m in similar_movies if 
        m in movie_embeddings
    ]
    if not similar_embeddings:
        return np.zeros(next(iter(movie_embeddings.values())).shape)
    
    return np.mean(similar_embeddings, axis=0)</span></pre>
   <h2 id="_idParaDest-177">
    <a id="_idTextAnchor180">
    </a>
    <span class="koboSpan" id="kobo.869.1">
     Content-based feature integration
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.870.1">
     Another effective
    </span>
    <a id="_idIndexMarker693">
    </a>
    <span class="koboSpan" id="kobo.871.1">
     approach to mitigate cold start
    </span>
    <a id="_idIndexMarker694">
    </a>
    <span class="koboSpan" id="kobo.872.1">
     issues is to leverage content-based features from available metadata or item descriptions.
    </span>
    <span class="koboSpan" id="kobo.872.2">
     By integrating multiple content-based features such as text attributes, categorical information, and any available numerical data, a system can generate initial recommendations even for new items or users with no interaction history.
    </span>
    <span class="koboSpan" id="kobo.872.3">
     This integrated feature representation can be used to compute item similarities or train machine learning models that predict user preferences based on
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.873.1">
      item characteristics.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.874.1">
     For instance, when a new user signs up, we can create edges to movies based on their stated preferences (genres, actors, and directors), even before they’ve
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.875.1">
      watched anything:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.876.1">
def create_initial_edges(user_id, preferences, movie_graph):
    for pref in preferences:
        similar_movies = [
            m for m in movie_graph.nodes if 
            pref in movie_graph.nodes[m]['attributes']]
        for movie in similar_movies:
            movie_graph.add_edge(
                user_id, movie, weight=0.5 # Initial weak connection
            )
    return movie_graph
    # Usage
    updated_graph = create_initial_edges(
        'new_user_123', ['Sci-Fi', 'Tom Hanks'], movie_graph)</span></pre>
   <p>
    <span class="koboSpan" id="kobo.877.1">
     These are just a couple of ways we can approach a cold start problem in a recommendation system that
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.878.1">
      leverages graphs.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-178">
    <a id="_idTextAnchor181">
    </a>
    <span class="koboSpan" id="kobo.879.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.880.1">
     In this chapter, we introduced graph deep learning as an advanced approach to recommendation systems.
    </span>
    <span class="koboSpan" id="kobo.880.2">
     You learned about the fundamental concepts of recommendation systems, including the different types and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.881.1">
      evaluation metrics.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.882.1">
     Then, we delved into graph structures for representing user-item interactions, incorporating side information, and capturing temporal dynamics.
    </span>
    <span class="koboSpan" id="kobo.882.2">
     Various graph-based recommendation models were explored, from MF with graph regularization to advanced GNN models.
    </span>
    <span class="koboSpan" id="kobo.882.3">
     You also became familiar with a variety of training techniques, scalability challenges, and advanced topics such as explainability and the cold start problem in graph-based
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.883.1">
      recommendation systems.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.884.1">
     In the next chapter, we’re going to investigate the applications of graph learning in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.885.1">
      computer vision.
     </span>
    </span>
   </p>
  </div>
 </body></html>